{
  "name": "Radio 5.0",
  "description": "Click to connect.",
  "thumbnail": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABAAAAAQACAYAAAB/HSuDAAAAAXNSR0IArs4c6QAAIABJREFUeF7s2EENADAMA7GWP+hNGoydyyBOX9mZOeMIECBAgAABAgQIECBAgACBrwXWAPB1v8IRIECAAAECBAgQIECAAIEnYADwCAQIECBAgAABAgQIECBAICBgAAiULCIBAgQIECBAgAABAgQIEDAA+AECBAgQIECAAAECBAgQIBAQMAAEShaRAAECBAgQIECAAAECBAgYAPwAAQIECBAgQIAAAQIECBAICBgAAiWLSIAAAQIECBAgQIAAAQIEDAB+gAABAgQIECBAgAABAgQIBAQMAIGSRSRAgAABAgQIECBAgAABAgYAP0CAAAECBAgQIECAAAECBAICBoBAySISIECAAAECBAgQIECAAAEDgB8gQIAAAQIECBAgQIAAAQIBAQNAoGQRCRAgQIAAAQIECBAgQICAAcAPECBAgAABAgQIECBAgACBgIABIFCyiAQIECBAgAABAgQIECBAwADgBwgQIECAAAECBAgQIECAQEDAABAoWUQCBAgQIECAAAECBAgQIGAA8AMECBAgQIAAAQIECBAgQCAgYAAIlCwiAQIECBAgQIAAAQIECBAwAPgBAgQIECBAgAABAgQIECAQEDAABEoWkQABAgQIECBAgAABAgQIGAD8AAECBAgQIECAAAECBAgQCAgYAAIli0iAAAECBAgQIECAAAECBAwAfoAAAQIECBAgQIAAAQIECAQEDACBkkUkQIAAAQIECBAgQIAAAQIGAD9AgAABAgQIECBAgAABAgQCAgaAQMkiEiBAgAABAgQIECBAgAABA4AfIECAAAECBAgQIECAAAECAQEDQKBkEQkQIECAAAECBAgQIECAgAHADxAgQIAAAQIECBAgQIAAgYCAASBQsogECBAgQIAAAQIECBAgQMAA4AcIECBAgAABAgQIECBAgEBAwAAQKFlEAgQIECBAgAABAgQIECBgAPADBAgQIECAAAECBAgQIEAgIGAACJQsIgECBAgQIECAAAECBAgQMAD4AQIECBAgQIAAAQIECBAgEBAwAARKFpEAAQIECBAgQIAAAQIECBgA/AABAgQIECBAgAABAgQIEAgIGAACJYtIgAABAgQIECBAgAABAgQMAH6AAAECBAgQIECAAAECBAgEBAwAgZJFJECAAAECBAgQIECAAAECBgA/QIAAAQIECBAgQIAAAQIEAgIGgEDJIhIgQIAAAQIECBAgQIAAAQOAHyBAgAABAgQIECBAgAABAgEBA0CgZBEJECBAgAABAgQIECBAgIABwA8QIECAAAECBAgQIECAAIGAgAEgULKIBAgQIECAAAECBAgQIEDAAOAHCBAgQIAAAQIECBAgQIBAQMAAEChZRAIECBAgQIAAAQIECBAgYADwAwQIECBAgAABAgQIECBAICBgAAiULCIBAgQIECBAgAABAgQIEDAA+AECBAgQIECAAAECBAgQIBAQMAAEShaRAAECBAgQIECAAAECBAgYAPwAAQIECBAgQIAAAQIECBAICBgAAiWLSIAAAQIECBAgQIAAAQIEDAB+gAABAgQIECBAgAABAgQIBAQMAIGSRSRAgAABAgQIECBAgAABAgYAP0CAAAECBAgQIECAAAECBAICBoBAySISIECAAAECBAgQIECAAAEDgB8gQIAAAQIECBAgQIAAAQIBAQNAoGQRCRAgQIAAAQIECBAgQICAAcAPECBAgAABAgQIECBAgACBgIABIFCyiAQIECBAgAABAgQIECBAwADgBwgQIECAAAECBAgQIECAQEDAABAoWUQCBAgQIECAAAECBAgQIGAA8AMECBAgQIAAAQIECBAgQCAgYAAIlCwiAQIECBAgQIAAAQIECBAwAPgBAgQIECBAgAABAgQIECAQEDAABEoWkQABAgQIECBAgAABAgQIGAD8AAECBAgQIECAAAECBAgQCAgYAAIli0iAAAECBAgQIECAAAECBAwAfoAAAQIECBAgQIAAAQIECAQEDACBkkUkQIAAAQIECBAgQIAAAQIGAD9AgAABAgQIECBAgAABAgQCAgaAQMkiEiBAgAABAgQIECBAgAABA4AfIECAAAECBAgQIECAAAECAQEDQKBkEQkQIECAAAECBAgQIECAgAHADxAgQIAAAQIECBAgQIAAgYCAASBQsogECBAgQIAAAQIECBAgQMAA4AcIECBAgAABAgQIECBAgEBAwAAQKFlEAgQIECBAgAABAgQIECBgAPADBAgQIECAAAECBAgQIEAgIGAACJQsIgECBAgQIECAAAECBAgQMAD4AQIECBAgQIAAAQIECBAgEBAwAARKFpEAAQIECBAgQIAAAQIECBgA/AABAgQIECBAgAABAgQIEAgIGAACJYtIgAABAgQIECBAgAABAgQMAH6AAAECBAgQIECAAAECBAgEBAwAgZJFJECAAAECBAgQIECAAAECBgA/QIAAAQIECBAgQIAAAQIEAgIGgEDJIhIgQIAAAQIECBAgQIAAAQOAHyBAgAABAgQIECBAgAABAgEBA0CgZBEJECBAgAABAgQIECBAgIABwA8QIECAAAECBAgQIECAAIGAgAEgULKIBAgQIECAAAECBAgQIEDAAOAHCBAgQIAAAQIECBAgQIBAQMAAEChZRAIECBAgQIAAAQIECBAgYADwAwQIECBAgAABAgQIECBAICBgAAiULCIBAgQIECBAgAABAgQIEDAA+AECBAgQIECAAAECBAgQIBAQMAAEShaRAAECBAgQIECAAAECBAgYAPwAAQIECBAgQIAAAQIECBAICBgAAiWLSIAAAQIECBAgQIAAAQIEDAB+gAABAgQIECBAgAABAgQIBAQMAIGSRSRAgAABAgQIECBAgAABAgYAP0CAAAECBAgQIECAAAECBAICBoBAySISIECAAAECBAgQIECAAAEDgB8gQIAAAQIECBAgQIAAAQIBAQNAoGQRCRAgQIAAAQIECBAgQICAAcAPECBAgAABAgQIECBAgACBgIABIFCyiAQIECBAgAABAgQIECBAwADgBwgQIECAAAECBAgQIECAQEDAABAoWUQCBAgQIECAAAECBAgQIGAA8AMECBAgQIAAAQIECBAgQCAgYAAIlCwiAQIECBAgQIAAAQIECBAwAPgBAgQIECBAgAABAgQIECAQEDAABEoWkQABAgQIECBAgAABAgQIGAD8AAECBAgQIECAAAECBAgQCAgYAAIli0iAAAECBAgQIECAAAECBAwAfoAAAQIECBAgQIAAAQIECAQEDACBkkUkQIAAAQIECBAgQIAAAQIGAD9AgAABAgQIECBAgAABAgQCAgaAQMkiEiBAgAABAgQIECBAgAABA4AfIECAAAECBAgQIECAAAECAQEDQKBkEQkQIECAAAECBAgQIECAgAHADxAgQIAAAQIECBAgQIAAgYCAASBQsogECBAgQIAAAQIECBAgQMAA4AcIECBAgAABAgQIECBAgEBAwAAQKFlEAgQIECBAgAABAgQIECBgAPADBAgQIECAAAECBAgQIEAgIGAACJQsIgECBAgQIECAAAECBAgQMAD4AQIECBAgQIAAAQIECBAgEBAwAARKFpEAAQIECBAgQIAAAQIECBgA/AABAgQIECBAgAABAgQIEAgIGAACJYtIgAABAgQIECBAgAABAgQMAH6AAAECBAgQIECAAAECBAgEBAwAgZJFJECAAAECBAgQIECAAAECBgA/QIAAAQIECBAgQIAAAQIEAgIGgEDJIhIgQIAAAQIECBAgQIAAAQOAHyBAgAABAgQIECBAgAABAgEBA0CgZBEJECBAgAABAgQIECBAgIABwA8QIECAAAECBAgQIECAAIGAgAEgULKIBAgQIECAAAECBAgQIEDAAOAHCBAgQIAAAQIECBAgQIBAQMAAEChZRAIECBAgQIAAAQIECBAgYADwAwQIECBAgAABAgQIECBAICBgAAiULCIBAgQIECBAgAABAgQIEDAA+AECBAgQIECAAAECBAgQIBAQMAAEShaRAAECBAgQIECAAAECBAgYAPwAAQIECBAgQIAAAQIECBAICBgAAiWLSIAAAQIECBAgQIAAAQIEDAB+gAABAgQIECBAgAABAgQIBAQMAIGSRSRAgAABAgQIECBAgAABAgYAP0CAAAECBAgQIECAAAECBAICBoBAySISIECAAAECBAgQIECAAAEDgB8gQIAAAQIECBAgQIAAAQIBAQNAoGQRCRAgQIAAAQIECBAgQICAAcAPECBAgAABAgQIECBAgACBgIABIFCyiAQIECBAgAABAgQIECBAwADgBwgQIECAAAECBAgQIECAQEDAABAoWUQCBAgQIECAAAECBAgQIGAA8AMECBAgQIAAAQIECBAgQCAgYAAIlCwiAQIECBAgQIAAAQIECBAwAPgBAgQIECBAgAABAgQIECAQEDAABEoWkQABAgQIECBAgAABAgQIGAD8AAECBAgQIECAAAECBAgQCAgYAAIli0iAAAECBAgQIECAAAECBAwAfoAAAQIECBAgQIAAAQIECAQEDACBkkUkQIAAAQIECBAgQIAAAQIGAD9AgAABAgQIECBAgAABAgQCAgaAQMkiEiBAgAABAgQIECBAgAABA4AfIECAAAECBAgQIECAAAECAQEDQKBkEQkQIECAAAECBAgQIECAgAHADxAgQIAAAQIECBAgQIAAgYCAASBQsogECBAgQIAAAQIECBAgQMAA4AcIECBAgAABAgQIECBAgEBAwAAQKFlEAgQIECBAgAABAgQIECBgAPADBAgQIECAAAECBAgQIEAgIGAACJQsIgECBAgQIECAAAECBAgQMAD4AQIECBAgQIAAAQIECBAgEBAwAARKFpEAAQIECBAgQIAAAQIECBgA/AABAgQIECBAgAABAgQIEAgIGAACJYtIgAABAgQIECBAgAABAgQMAH6AAAECBAgQIECAAAECBAgEBAwAgZJFJECAAAECBAgQIECAAAECBgA/QIAAAQIECBAgQIAAAQIEAgIGgEDJIhIgQIAAAQIECBAgQIAAAQOAHyBAgAABAgQIECBAgAABAgEBA0CgZBEJECBAgAABAgQIECBAgIABwA8QIECAAAECBAgQIECAAIGAgAEgULKIBAgQIECAAAECBAgQIEDAAOAHCBAgQIAAAQIECBAgQIBAQMAAEChZRAIECBAgQIAAAQIECBAgYADwAwQIECBAgAABAgQIECBAICBgAAiULCIBAgQIECBAgAABAgQIEDAA+AECBAgQIECAAAECBAgQIBAQMAAEShaRAAECBAgQIECAAAECBAgYAPwAAQIECBAgQIAAAQIECBAICBgAAiWLSIAAAQIECBAgQIAAAQIEDAB+gAABAgQIECBAgAABAgQIBAQMAIGSRSRAgAABAgQIECBAgAABAgYAP0CAAAECBAgQIECAAAECBAICBoBAySISIECAAAECBAgQIECAAAEDgB8gQIAAAQIECBAgQIAAAQIBAQNAoGQRCRAgQIAAAQIECBAgQICAAcAPECBAgAABAgQIECBAgACBgIABIFCyiAQIECBAgAABAgQIECBAwADgBwgQIECAAAECBAgQIECAQEDAABAoWUQCBAgQIECAAAECBAgQIGAA8AMECBAgQIAAAQIECBAgQCAgYAAIlCwiAQIECBAgQIAAAQIECBAwAPgBAgQIECBAgAABAgQIECAQEDAABEoWkQABAgQIECBAgAABAgQIGAD8AAECBAgQIECAAAECBAgQCAgYAAIli0iAAAECBAgQIECAAAECBAwAfoAAAQIECBAgQIAAAQIECAQEDACBkkUkQIAAAQIECBAgQIAAAQIGAD9AgAABAgQIECBAgAABAgQCAgaAQMkiEiBAgAABAgQIECBAgAABA4AfIECAAAECBAgQIECAAAECAQEDQKBkEQkQIECAAAECBAgQIECAgAHADxAgQIAAAQIECBAgQIAAgYCAASBQsogECBAgQIAAAQIECBAgQMAA4AcIECBAgAABAgQIECBAgEBAwAAQKFlEAgQIECBAgAABAgQIECBgAPADBAgQIECAAAECBAgQIEAgIGAACJQsIgECBAgQIECAAAECBAgQMAD4AQIECBAgQIAAAQIECBAgEBAwAARKFpEAAQIECBAgQIAAAQIECBgA/AABAgQIECBAgAABAgQIEAgIGAACJYtIgAABAgQIECBAgAABAgQMAH6AAAECBAgQIECAAAECBAgEBAwAgZJFJECAAAECBAgQIECAAAECBgA/QIAAAQIECBAgQIAAAQIEAgIGgEDJIhIgQIAAAQIECBAgQIAAAQOAHyBAgAABAgQIECBAgAABAgEBA0CgZBEJECBAgAABAgQIECBAgIABwA8QIECAAAECBAgQIECAAIGAgAEgULKIBAgQIECAAAECBAgQIEDAAOAHCBAgQIAAAQIECBAgQIBAQMAAEChZRAIECBAgQIAAAQIECBAgYADwAwQIECBAgAABAgQIECBAICBgAAiULCIBAgQIECBAgAABAgQIEDAA+AECBAgQIECAAAECBAgQIBAQMAAEShaRAAECBAgQIECAAAECBAgYAPwAAQIECBAgQIAAAQIECBAICBgAAiWLSIAAAQIECBAgQIAAAQIEDAB+gAABAgQIECBAgAABAgQIBAQMAIGSRSRAgAABAgQIECBAgAABAgYAP0CAAAECBAgQIECAAAECBAICBoBAySISIECAAAECBAgQIECAAAEDgB8gQIAAAQIECBAgQIAAAQIBAQNAoGQRCRAgQIAAAQIECBAgQICAAcAPECBAgAABAgQIECBAgACBgIABIFCyiAQIECBAgAABAgQIECBAwADgBwgQIECAAAECBAgQIECAQEDAABAoWUQCBAgQIECAAAECBAgQIGAA8AMECBAgQIAAAQIECBAgQCAgYAAIlCwiAQIECBAgQIAAAQIECBAwAPgBAgQIECBAgAABAgQIECAQEDAABEoWkQABAgQIECBAgAABAgQIGAD8AAECBAgQIECAAAECBAgQCAgYAAIli0iAAAECBAgQIECAAAECBAwAfoAAAQIECBAgQIAAAQIECAQEDACBkkUkQIAAAQIECBAgQIAAAQIGAD9AgAABAgQIECBAgAABAgQCAgaAQMkiEiBAgAABAgQIECBAgAABA4AfIECAAAECBAgQIECAAAECAQEDQKBkEQkQIECAAAECBAgQIECAgAHADxAgQIAAAQIECBAgQIAAgYCAASBQsogECBAgQIAAAQIECBAgQMAA4AcIECBAgAABAgQIECBAgEBAwAAQKFlEAgQIECBAgAABAgQIECBgAPADBAgQIECAAAECBAgQIEAgIGAACJQsIgECBAgQIECAAAECBAgQMAD4AQIECBAgQIAAAQIECBAgEBAwAARKFpEAAQIECBAgQIAAAQIECBgA/AABAgQIECBAgAABAgQIEAgIGAACJYtIgAABAgQIECBAgAABAgQMAH6AAAECBAgQIECAAAECBAgEBAwAgZJFJECAAAECBAgQIECAAAECBgA/QIAAAQIECBAgQIAAAQIEAgIGgEDJIhIgQIAAAQIECBAgQIAAAQOAHyBAgAABAgQIECBAgAABAgEBA0CgZBEJECBAgAABAgQIECBAgIABwA8QIECAAAECBAgQIECAAIGAgAEgULKIBAgQIECAAAECBAgQIEDAAOAHCBAgQIAAAQIECBAgQIBAQMAAEChZRAIECBAgQIAAAQIECBAgYADwAwQIECBAgAABAgQIECBAICBgAAiULCIBAgQIECBAgAABAgQIEDAA+AECBAgQIECAAAECBAgQIBAQMAAEShaRAAECBAgQIECAAAECBAgYAPwAAQIECBAgQIAAAQIECBAICBgAAiWLSIAAAQIECBAgQIAAAQIEDAB+gAABAgQIECBAgAABAgQIBAQMAIGSRSRAgAABAgQIECBAgAABAgYAP0CAAAECBAgQIECAAAECBAICBoBAySISIECAAAECBAgQIECAAAEDgB8gQIAAAQIECBAgQIAAAQIBAQNAoGQRCRAgQIAAAQIECBAgQICAAcAPECBAgAABAgQIECBAgACBgIABIFCyiAQIECBAgAABAgQIECBAwADgBwgQIECAAAECBAgQIECAQEDAABAoWUQCBAgQIECAAAECBAgQIGAA8AMECBAgQIAAAQIECBAgQCAgYAAIlCwiAQIECBAgQIAAAQIECBAwAPgBAgQIECBAgAABAgQIECAQEDAABEoWkQABAgQIECBAgAABAgQIGAD8AAECBAgQIECAAAECBAgQCAgYAAIli0iAAAECBAgQIECAAAECBAwAfoAAAQIECBAgQIAAAQIECAQEDACBkkUkQIAAAQIECBAgQIAAAQIGAD9AgAABAgQIECBAgAABAgQCAgaAQMkiEiBAgAABAgQIECBAgAABA4AfIECAAAECBAgQIECAAAECAQEDQKBkEQkQIECAAAECBAgQIECAgAHADxAgQIAAAQIECBAgQIAAgYCAASBQsogECBAgQIAAAQIECBAgQMAA4AcIECBAgAABAgQIECBAgEBAwAAQKFlEAgQIECBAgAABAgQIECBgAPADBAgQIECAAAECBAgQIEAgIGAACJQsIgECBAgQIECAAAECBAgQMAD4AQIECBAgQIAAAQIECBAgEBAwAARKFpEAAQIECBAgQIAAAQIECBgA/AABAgQIECBAgAABAgQIEAgIGAACJYtIgAABAgQIECBAgAABAgQMAH6AAAECBAgQIECAAAECBAgEBAwAgZJFJECAAAECBAgQIECAAAECBgA/QIAAAQIECBAgQIAAAQIEAgIGgEDJIhIgQIAAAQIECBAgQIAAAQOAHyBAgAABAgQIECBAgAABAgEBA0CgZBEJECBAgAABAgQIECBAgIABwA8QIECAAAECBAgQIECAAIGAgAEgULKIBAgQIECAAAECBAgQIEDAAOAHCBAgQIAAAQIECBAgQIBAQMAAEChZRAIECBAgQIAAAQIECBAgYADwAwQIECBAgAABAgQIECBAICBgAAiULCIBAgQIECBAgAABAgQIEDAA+AECBAgQIECAAAECBAgQIBAQMAAEShaRAAECBAgQIECAAAECBAgYAPwAAQIECBAgQIAAAQIECBAICBgAAiWLSIAAAQIECBAgQIAAAQIEDAB+gAABAgQIECBAgAABAgQIBAQMAIGSRSRAgAABAgQIECBAgAABAgYAP0CAAAECBAgQIECAAAECBAICBoBAySISIECAAAECBAgQIECAAAEDgB8gQIAAAQIECBAgQIAAAQIBAQNAoGQRCRAgQIAAAQIECBAgQICAAcAPECBAgAABAgQIECBAgACBgIABIFCyiAQIECBAgAABAgQIECBAwADgBwgQIECAAAECBAgQIECAQEDAABAoWUQCBAgQIECAAAECBAgQIGAA8AMECBAgQIAAAQIECBAgQCAgYAAIlCwiAQIECBAgQIAAAQIECBAwAPgBAgQIECBAgAABAgQIECAQEDAABEoWkQABAgQIECBAgAABAgQIGAD8AAECBAgQIECAAAECBAgQCAgYAAIli0iAAAECBAgQIECAAAECBAwAfoAAAQIECBAgQIAAAQIECAQEDACBkkUkQIAAAQIECBAgQIAAAQIGAD9AgAABAgQIECBAgAABAgQCAgaAQMkiEiBAgAABAgQIECBAgAABA4AfIECAAAECBAgQIECAAAECAQEDQKBkEQkQIECAAAECBAgQIECAgAHADxAgQIAAAQIECBAgQIAAgYCAASBQsogECBAgQIAAAQIECBAgQMAA4AcIECBAgAABAgQIECBAgEBAwAAQKFlEAgQIECBAgAABAgQIECBgAPADBAgQIECAAAECBAgQIEAgIGAACJQsIgECBAgQIECAAAECBAgQMAD4AQIECBAgQIAAAQIECBAgEBAwAARKFpEAAQIECBAgQIAAAQIECBgA/AABAgQIECBAgAABAgQIEAgIGAACJYtIgAABAgQIECBAgAABAgQMAH6AAAECBAgQIECAAAECBAgEBAwAgZJFJECAAAECBAgQIECAAAECBgA/QIAAAQIECBAgQIAAAQIEAgIGgEDJIhIgQIAAAQIECBAgQIAAAQOAHyBAgAABAgQIECBAgAABAgEBA0CgZBEJECBAgAABAgQIECBAgIABwA8QIECAAAECBAgQIECAAIGAgAEgULKIBAgQIECAAAECBAgQIEDAAOAHCBAgQIAAAQIECBAgQIBAQMAAEChZRAIECBAgQIAAAQIECBAgYADwAwQIECBAgAABAgQIECBAICBgAAiULCIBAgQIECBAgAABAgQIEDAA+AECBAgQIECAAAECBAgQIBAQMAAEShaRAAECBAgQIECAAAECBAgYAPwAAQIECBAgQIAAAQIECBAICBgAAiWLSIAAAQIECBAgQIAAAQIEDAB+gAABAgQIECBAgAABAgQIBAQMAIGSRSRAgAABAgQIECBAgAABAgYAP0CAAAECBAgQIECAAAECBAICBoBAySISIECAAAECBAgQIECAAAEDgB8gQIAAAQIECBAgQIAAAQIBAQNAoGQRCRAgQIAAAQIECBAgQICAAcAPECBAgAABAgQIECBAgACBgIABIFCyiAQIECBAgAABAgQIECBAwADgBwgQIECAAAECBAgQIECAQEDAABAoWUQCBAgQIECAAAECBAgQIGAA8AMECBAgQIAAAQIECBAgQCAgYAAIlCwiAQIECBAgQIAAAQIECBAwAPgBAgQIECBAgAABAgQIECAQEDAABEoWkQABAgQIECBAgAABAgQIGAD8AAECBAgQIECAAAECBAgQCAgYAAIli0iAAAECBAgQIECAAAECBAwAfoAAAQIECBAgQIAAAQIECAQEDACBkkUkQIAAAQKqk8O7AAAgAElEQVQECBAgQIAAAQIGAD9AgAABAgQIECBAgAABAgQCAgaAQMkiEiBAgAABAgQIECBAgAABA4AfIECAAAECBAgQIECAAAECAQEDQKBkEQkQIECAAAECBAgQIECAgAHADxAgQIAAAQIECBAgQIAAgYCAASBQsogECBAgQIAAAQIECBAgQMAA4AcIECBAgAABAgQIECBAgEBAwAAQKFlEAgQIECBAgAABAgQIECBgAPADBAgQIECAAAECBAgQIEAgIGAACJQsIgECBAgQIECAAAECBAgQMAD4AQIECBAgQIAAAQIECBAgEBAwAARKFpEAAQIECBAgQIAAAQIECBgA/AABAgQIECBAgAABAgQIEAgIGAACJYtIgAABAgQIECBAgAABAgQMAH6AAAECBAgQIECAAAECBAgEBAwAgZJFJECAAAECBAgQIECAAAECBgA/QIAAAQIECBAgQIAAAQIEAgIGgEDJIhIgQIAAAQIECBAgQIAAAQOAHyBAgAABAgQIECBAgAABAgEBA0CgZBEJECBAgAABAgQIECBAgIABwA8QIECAAAECBAgQIECAAIGAgAEgULKIBAgQIECAAAECBAgQIEDAAOAHCBAgQIAAAQIECBAgQIBAQMAAEChZRAIECBAgQIAAAQIECBAgYADwAwQIECBAgAABAgQIECBAICBgAAiULCIBAgQIECBAgAABAgQIEDAA+AECBAgQIECAAAECBAgQIBAQMAAEShaRAAECBAgQIECAAAECBAgYAPwAAQIECBAgQIAAAQIECBAICBgAAiWLSIAAAQIECBAgQIAAAQIEDAB+gAABAgQIECBAgAABAgQIBAQMAIGSRSRAgAABAgQIECBAgAABAgYAP0CAAAECBAgQIECAAAECBAICBoBAySISIECAAAECBAgQIECAAAEDgB8gQIAAAQIECBAgQIAAAQIBAQNAoGQRCRAgQIAAAQIECBAgQICAAcAPECBAgAABAgQIECBAgACBgIABIFCyiAQIECBAgAABAgQIECBAwADgBwgQIECAAAECBAgQIECAQEDAABAoWUQCBAgQIECAAAECBAgQIGAA8AMECBAgQIAAAQIECBAgQCAgYAAIlCwiAQIECBAgQIAAAQIECBAwAPgBAgQIECBAgAABAgQIECAQEDAABEoWkQABAgQIECBAgAABAgQIGAD8AAECBAgQIECAAAECBAgQCAgYAAIli0iAAAECBAgQIECAAAECBAwAfoAAAQIECBAgQIAAAQIECAQEDACBkkUkQIAAAQIECBAgQIAAAQIGAD9AgAABAgQIECBAgAABAgQCAgaAQMkiEiBAgAABAgQIECBAgAABA4AfIECAAAECBAgQIECAAAECAQEDQKBkEQkQIECAAAECBAgQIECAgAHADxAgQIAAAQIECBAgQIAAgYCAASBQsogECBAgQIAAAQIECBAgQMAA4AcIECBAgAABAgQIECBAgEBAwAAQKFlEAgQIECBAgAABAgQIECBgAPADBAgQIECAAAECBAgQIEAgIGAACJQsIgECBAgQIECAAAECBAgQMAD4AQIECBAgQIAAAQIECBAgEBAwAARKFpEAAQIECBAgQIAAAQIECBgA/AABAgQIECBAgAABAgQIEAgIGAACJYtIgAABAgQIECBAgAABAgQMAH6AAAECBAgQIECAAAECBAgEBAwAgZJFJECAAAECBAgQIECAAAECBgA/QIAAAQIECBAgQIAAAQIEAgIGgEDJIhIgQIAAAQIECBAgQIAAAQOAHyBAgAABAgQIECBAgAABAgEBA0CgZBEJECBAgAABAgQIECBAgIABwA8QIECAAAECBAgQIECAAIGAgAEgULKIBAgQIECAAAECBAgQIEDAAOAHCBAgQIAAAQIECBAgQIBAQMAAEChZRAIECBAgQIAAAQIECBAgYADwAwQIECBAgAABAgQIECBAICBgAAiULCIBAgQIECBAgAABAgQIEDAA+AECBAgQIECAAAECBAgQIBAQMAAEShaRAAECBAgQIECAAAECBAgYAPwAAQIECBAgQIAAAQIECBAICBgAAiWLSIAAAQIECBAgQIAAAQIEDAB+gAABAgQIECBAgAABAgQIBAQMAIGSRSRAgAABAgQIECBAgAABAgYAP0CAAAECBAgQIECAAAECBAICBoBAySISIECAAAECBAgQIECAAAEDgB8gQIAAAQIECBAgQIAAAQIBAQNAoGQRCRAgQIAAAQIECBAgQICAAcAPECBAgAABAgQIECBAgACBgIABIFCyiAQIECBAgAABAgQIECBAwADgBwgQIECAAAECBAgQIECAQEDAABAoWUQCBAgQIECAAAECBAgQIGAA8AMECBAgQIAAAQIECBAgQCAgYAAIlCwiAQIECBAgQIAAAQIECBAwAPgBAgQIECBAgAABAgQIECAQEDAABEoWkQABAgQIECBAgAABAgQIGAD8AAECBAgQIECAAAECBAgQCAgYAAIli0iAAAECBAgQIECAAAECBAwAfoAAAQIECBAgQIAAAQIECAQEDACBkkUkQIAAAQIECBAgQIAAAQIGAD9AgAABAgQIECBAgAABAgQCAgaAQMkiEiBAgAABAgQIECBAgAABA4AfIECAAAECBAgQIECAAAECAQEDQKBkEQkQIECAAAECBAgQIECAgAHADxAgQIAAAQIECBAgQIAAgYCAASBQsogECBAgQIAAAQIECBAgQMAA4AcIECBAgAABAgQIECBAgEBAwAAQKFlEAgQIECBAgAABAgQIECBgAPADBAgQIECAAAECBAgQIEAgIGAACJQsIgECBAgQIECAAAECBAgQMAD4AQIECBAgQIAAAQIECBAgEBAwAARKFpEAAQIECBAgQIAAAQIECBgA/AABAgQIECBAgAABAgQIEAgIGAACJYtIgAABAgQIECBAgAABAgQMAH6AAAECBAgQIECAAAECBAgEBAwAgZJFJECAAAECBAgQIECAAAECBgA/QIAAAQIECBAgQIAAAQIEAgIGgEDJIhIgQIAAAQIECBAgQIAAAQOAHyBAgAABAgQIECBAgAABAgEBA0CgZBEJECBAgAABAgQIECBAgIABwA8QIECAAAECBAgQIECAAIGAgAEgULKIBAgQIECAAAECBAgQIEDAAOAHCBAgQIAAAQIECBAgQIBAQMAAEChZRAIECBAgQIAAAQIECBAgYADwAwQIECBAgAABAgQIECBAICBgAAiULCIBAgQIECBAgAABAgQIEDAA+AECBAgQIECAAAECBAgQIBAQMAAEShaRAAECBAgQIECAAAECBAgYAPwAAQIECBAgQIAAAQIECBAICBgAAiWLSIAAAQIECBAgQIAAAQIEDAB+gAABAgQIECBAgAABAgQIBAQMAIGSRSRAgAABAgQIECBAgAABAgYAP0CAAAECBAgQIECAAAECBAICBoBAySISIECAAAECBAgQIECAAAEDgB8gQIAAAQIECBAgQIAAAQIBAQNAoGQRCRAgQIAAAQIECBAgQICAAcAPECBAgAABAgQIECBAgACBgIABIFCyiAQIECBAgAABAgQIECBAwADgBwgQIECAAAECBAgQIECAQEDAABAoWUQCBAgQIECAAAECBAgQIGAA8AMECBAgQIAAAQIECBAgQCAgYAAIlCwiAQIECBAgQIAAAQIECBAwAPgBAgQIECBAgAABAgQIECAQEDAABEoWkQABAgQIECBAgAABAgQIGAD8AAECBAgQIECAAAECBAgQCAgYAAIli0iAAAECBAgQIECAAAECBAwAfoAAAQIECBAgQIAAAQIECAQEDACBkkUkQIAAAQIECBAgQIAAAQIGAD9AgAABAgQIECBAgAABAgQCAgaAQMkiEiBAgAABAgQIECBAgAABA4AfIECAAAECBAgQIECAAAECAQEDQKBkEQkQIECAAAECBAgQIECAgAHADxAgQIAAAQIECBAgQIAAgYCAASBQsogECBAgQIAAAQIECBAgQMAA4AcIECBAgAABAgQIECBAgEBAwAAQKFlEAgQIECBAgAABAgQIECBgAPADBAgQIECAAAECBAgQIEAgIGAACJQsIgECBAgQIECAAAECBAgQMAD4AQIECBAgQIAAAQIECBAgEBAwAARKFpEAAQIECBAgQIAAAQIECBgA/AABAgQIECBAgAABAgQIEAgIGAACJYtIgAABAgQIECBAgAABAgQMAH6AAAECBAgQIECAAAECBAgEBAwAgZJFJECAAAECBAgQIECAAAECBgA/QIAAAQIECBAgQIAAAQIEAgIGgEDJIhIgQIAAAQIECBAgQIAAAQOAHyBAgAABAgQIECBAgAABAgEBA0CgZBEJECBAgAABAgQIECBAgIABwA8QIECAAAECBAgQIECAAIGAgAEgULKIBAgQIECAAAECBAgQIEDAAOAHCBAgQIAAAQIECBAgQIBAQMAAEChZRAIECBAgQIAAAQIECBAgYADwAwQIECBAgAABAgQIECBAICBgAAiULCIBAgQIECBAgAABAgQIEDAA+AECBAgQIECAAAECBAgQIBAQMAAEShaRAAECBAgQIECAAAECBAgYAPwAAQIECBAgQIAAAQIECBAICBgAAiWLSIAAAQIECBAgQIAAAQIEDAB+gAABAgQIECBAgAABAgQIBAQMAIGSRSRAgAABAgQIECBAgAABAgYAP0CAAAECBAgQIECAAAECBAICBoBAySISIECAAAECBAgQIECAAAEDgB8gQIAAAQIECBAgQIAAAQIBAQNAoGQRCRAgQIAAAQIECBAgQICAAcAPECBAgAABAgQIECBAgACBgIABIFCyiAQIECBAgAABAgQIECBAwADgBwgQIECAAAECBAgQIECAQEDAABAoWUQCBAgQIECAAAECBAgQIGAA8AMECBAgQIAAAQIECBAgQCAgYAAIlCwiAQIECBAgQIAAAQIECBAwAPgBAgQIECBAgAABAgQIECAQEDAABEoWkQABAgQIECBAgAABAgQIGAD8AAECBAgQIECAAAECBAgQCAgYAAIli0iAAAECBAgQIECAAAECBAwAfoAAAQIECBAgQIAAAQIECAQEDACBkkUkQIAAAQIECBAgQIAAAQIGAD9AgAABAgQIECBAgAABAgQCAgaAQMkiEiBAgAABAgQIECBAgAABA4AfIECAAAECBAgQIECAAAECAQEDQKBkEQkQIECAAAECBAgQIECAgAHADxAgQIAAAQIECBAgQIAAgYCAASBQsogECBAgQIAAAQIECBAgQMAA4AcIECBAgAABAgQIECBAgEBAwAAQKFlEAgQIECBAgAABAgQIECBgAPADBAgQIECAAAECBAgQIEAgIGAACJQsIgECBAgQIECAAAECBAgQMAD4AQIECBAgQIAAAQIECBAgEBAwAARKFpEAAQIECBAgQIAAAQIECBgA/AABAgQIECBAgAABAgQIEAgIGAACJYtIgAABAgQIECBAgAABAgQMAH6AAAECBAgQIECAAAECBAgEBAwAgZJFJECAAAECBAgQIECAAAECBgA/QIAAAQIECBAgQIAAAQIEAgIGgEDJIhIgQIAAAQIECBAgQIAAAQOAHyBAgAABAgQIECBAgAABAgEBA0CgZBEJECBAgAABAgQIECBAgIABwA8QIECAAAECBAgQIECAAIGAgAEgULKIBAgQIECAAAECBAgQIEDAAOAHCBAgQIAAAQIECBAgQIBAQMAAEChZRAIECBAgQIAAAQIECBAgYADwAwQIECBAgAABAgQIECBAICBgAAiULCIBAgQIECBAgAABAgQIEDAA+AECBAgQIECAAAECBAgQIBAQMAAEShaRAAECBAgQIECAAAECBAgYAPwAAQIECBAgQIAAAQIECBAICBgAAiWLSIAAAQIECBAgQIAAAQIEDAB+gAABAgQIECBAgAABAgQIBAQMAIGSRSRAgAABAgQIECBAgAABAgYAP0CAAAECBAgQIECAAAECBAICBoBAySISIECAAAECBAgQIECAAAEDgB8gQIAAAQIECBAgQIAAAQIBAQNAoGQRCRAgQIAAAQIECBAgQICAAcAPECBAgAABAgQIECBAgACBgIABIFCyiAQIECBAgAABAgQIECBAwADgBwgQIECAAAECBAgQIECAQEDAABAoWUQCBAgQIECAAAECBAgQIGAA8AMECBAgQIAAAQIECBAgQCAgYAAIlCwiAQIECBAgQIAAAQIECBAwAPgBAgQIECBAgAABAgQIECAQEDAABEoWkQABAgQIECBAgAABAgQIGAD8AAECBAgQIECAAAECBAgQCAgYAAIli0iAAAECBAgQIECAAAECBAwAfoAAAQIECBAgQIAAAQIECAQEDACBkkUkQIAAAQIECBAgQIAAAQIGAD9AgAABAgQIECBAgAABAgQCAgaAQMkiEiBAgAABAgQIECBAgAABA4AfIECAAAECBAgQIECAAAECAQEDQKBkEQkQIECAAAECBAgQIECAgAHADxAgQIAAAQIECBAgQIAAgYCAASBQsogECBAgQIAAAQIECBAgQMAA4AcIECBAgAABAgQIECBAgEBAwAAQKFlEAgQIECBAgAABAgQIECBgAPADBAgQIECAAAECBAgQIEAgIGAACJQsIgECBAgQIECAAAECBAgQMAD4AQIECBAgQIAAAQIECBAgEBAwAARKFpEAAQIECBAgQIAAAQIECBgA/AABAgQIECBAgAABAgQIEAgIGAACJYtIgAABAgQIECBAgAABAgQMAH6AAAECBAgQIECAAAECBAgEBAwAgZJFJECAAAECBAgQIECAAAECBgA/QIAAAQIECBAgQIAAAQIEAgIGgEDJIhIgQIAAAQIECBAgQIAAAQOAHyBAgAABAgQIECBAgAABAgEBA0CgZBEJECBAgAABAgQIECBAgIABwA8QIECAAAECBAgQIECAAIGAgAEgULKIBAgQIECAAAECBAgQIEDAAOAHCBAgQIAAAQIECBAgQIBAQMAAEChZRAIECBAgQIAAAQIECBAgYADwAwQIECBAgAABAgQIECBAICBgAAiULCIBAgQIECBAgAABAgQIEDAA+AECBAgQIECAAAECBAgQIBAQMAAEShaRAAECBAgQIECAAAECBAgYAPwAAQIECBAgQIAAAQIECBAICBgAAiWLSIAAAQIECBAgQIAAAQIEDAB+gAABAgQIECBAgAABAgQIBAQMAIGSRSRAgAABAgQIECBAgAABAgYAP0CAAAECBAgQIECAAAECBAICBoBAySISIECAAAECBAgQIECAAAEDgB8gQIAAAQIECBAgQIAAAQIBAQNAoGQRCRAgQIAAAQIECBAgQICAAcAPECBAgAABAgQIECBAgACBgIABIFCyiAQIECBAgAABAgQIECBAwADgBwgQIECAAAECBAgQIECAQEDAABAoWUQCBAgQIECAAAECBAgQIGAA8AMECBAgQIAAAQIECBAgQCAgYAAIlCwiAQIECBAgQIAAAQIECBAwAPgBAgQIECBAgAABAgQIECAQEDAABEoWkQABAgQIECBAgAABAgQIGAD8AAECBAgQIECAAAECBAgQCAgYAAIli0iAAAECBAgQIECAAAECBAwAfoAAAQIECBAgQIAAAQIECAQEDACBkkUkQIAAAQIECBAgQIAAAQIGAD9AgAABAgQIECBAgAABAgQCAgaAQMkiEiBAgAABAgQIECBAgAABA4AfIECAAAECBAgQIECAAAECAQEDQKBkEQkQIECAAAECBAgQIECAgAHADxAgQIAAAQIECBAgQIAAgYCAASBQsogECBAgQIAAAQIECBAgQMAA4AcIECBAgAABAgQIECBAgEBAwAAQKFlEAgQIECBAgAABAgQIECBgAPADBAgQIECAAAECBAgQIEAgIGAACJQsIgECBAgQIECAAAECBAgQMAD4AQIECBAgQIAAAQIECBAgEBAwAARKFpEAAQIECBAgQIAAAQIECBgA/AABAgQIECBAgAABAgQIEAgIGAACJYtIgAABAgQIECBAgAABAgQMAH6AAAECBAgQIECAAAECBAgEBAwAgZJFJECAAAECBAgQIECAAAECBgA/QIAAAQIECBAgQIAAAQIEAgIGgEDJIhIgQIAAAQIECBAgQIAAAQOAHyBAgAABAgQIECBAgAABAgEBA0CgZBEJECBAgAABAgQIECBAgIABwA8QIECAAAECBAgQIECAAIGAgAEgULKIBAgQIECAAAECBAgQIEDAAOAHCBAgQIAAAQIECBAgQIBAQMAAEChZRAIECBAgQIAAAQIECBAgYADwAwQIECBAgAABAgQIECBAICBgAAiULCIBAgQIECBAgAABAgQIEDAA+AECBAgQIECAAAECBAgQIBAQMAAEShaRAAECBAgQIECAAAECBAgYAPwAAQIECBAgQIAAAQIECBAICBgAAiWLSIAAAQIECBAgQIAAAQIEDAB+gAABAgQIECBAgAABAgQIBAQMAIGSRSRAgAABAgQIECBAgAABAgYAP0CAAAECBAgQIECAAAECBAICBoBAySISIECAAAECBAgQIECAAAEDgB8gQIAAAQIECBAgQIAAAQIBAQNAoGQRCRAgQIAAAQIECBAgQICAAcAPECBAgAABAgQIECBAgACBgIABIFCyiAQIECBAgAABAgQIECBAwADgBwgQIECAAAECBAgQIECAQEDAABAoWUQCBAgQIECAAAECBAgQIGAA8AMECBAgQIAAAQIECBAgQCAgYAAIlCwiAQIECBAgQIAAAQIECBAwAPgBAgQIECBAgAABAgQIECAQEDAABEoWkQABAgQIECBAgAABAgQIGAD8AAECBAgQIECAAAECBAgQCAgYAAIli0iAAAECBAgQIECAAAECBAwAfoAAAQIECBAgQIAAAQIECAQEDACBkkUkQIAAAQIECBAgQIAAAQIGAD9AgAABAgQIECBAgAABAgQCAgaAQMkiEiBAgAABAgQIECBAgAABA4AfIECAAAECBAgQIECAAAECAQEDQKBkEQkQIECAAAECBAgQIECAgAHADxAgQIAAAQIECBAgQIAAgYCAASBQsogECBAgQIAAAQIECBAgQMAA4AcIECBAgAABAgQIECBAgEBAwAAQKFlEAgQIECBAgAABAgQIECBgAPADBAgQIECAAAECBAgQIEAgIGAACJQsIgECBAgQIECAAAECBAgQMAD4AQIECBAgQIAAAQIECBAgEBAwAARKFpEAAQIECBAgQIAAAQIECBgA/AABAgQIECBAgAABAgQIEAgIGAACJYtIgAABAgQIECBAgAABAgQMAH6AAAECBAgQIECAAAECBAgEBAwAgZJFJECAAAECBAgQIECAAAECBgA/QIAAAQIECBAgQIAAAQIEAgIGgEDJIhIgQIAAAQIECBAgQIAAAQOAHyBAgAABAgQIECBAgAABAgEBA0CgZBEJECBAgAABAgQIECBAgIABwA8QIECAAAECBAgQIECAAIGAgAEgULKIBAgQIECAAAECBAgQIEDAAOAHCBAgQIAAAQIECBAgQIBAQMAAEChZRAIECBAgQIAAAQIECBAgYADwAwQIECBAgAABAgQIECBAICBgAAiULCIBAgQIECBAgAABAgQIEDAA+AECBAgQIECAAAECBAgQIBAQMAAEShaRAAECBAgQIECAAAECBAgYAPwAAQIECBAgQIAAAQIECBAICBgAAiWLSIAAAQIECBAgQIAAAQIEDAB+gAABAgQIECBAgAABAgQIBAQMAIGSRSRAgAABAgQIECBAgAABAgYAP0CAAAECBAgQIECAAAECBAICBoBAySISIECAAAECBAgQIECAAAEDgB8gQIAAAQIECBAgQIAAAQIBAQNAoGQRCRAgQIAAAQIECBAgQICAAcAPECBAgAABAgQIECBAgACBgIABIFCyiAQIECBAgAABAgQIECBAwADgBwgQIECAAAECBAgQIECAQEDAABAoWUQCBAgQIECAAAECBAgQIGAA8AMECBAgQIAAAQIECBAgQCAgYAAIlCwiAQIECBAgQIAAAQIECBAwAPgBAgQIECBAgAABAgQIECAQEDAABEoWkQABAgQIECBAgAABAgQIGAD8AAECBAgQIECAAAECBAgQCAgYAAIli0iAAAECBAgQIECAAAECBAwAfoAAAQIECBAgQIAAAQIECAQEDACBkkUkQIAAAQIECBAgQIAAAQIGAD9AgAABAgQIECBAgAABAgQCAgaAQMkiEiBAgAABAgQIECBAgAABA4AfIECAAAECBAgQIECAAAECAQEDQKBkEQkQIECAAAECBAgQIECAgAHADxAgQIAAAQIECBAgQIAAgYCAASBQsogECBAgQIAAAQIECBAgQMAA4AcIECBAgAABAgQIECBAgEBAwAAQKFlEAgQIECBAgAABAgQIECBgAPADBAgQIECAAAECBAgQIEAgIGAACJQsIgECBAgQIECAAAECBAgQMAD4AQIECBAgQIAAAQIECBAgEBAwAARKFpEAAQIECBAgQIAAAQIECBgA/AABAgQIECBAgAABAgQIEAgIGAACJYtIgAABAgQIECBAgAABAgQMAH6AAAECBAgQIECAAAECBAgEBAwAgZJFJECAAAECBAgQIECAAAECBgA/QIAAAQIECBAgQIAAAQIEAgIGgEDJIhIgQIAAAQIECBAgQIAAAQOAHyBAgAABAgQIECBAgAABAgEBA0CgZBEJECBAgAABAgQIECBAgIABwA8QIECAAAECBAgQIECAAIGAgAEgULKIBAgQIECAAAECBAgQIEDAAOAHCBAgQIAAAQIECBAgQIBAQMAAEChZRAIECBAgQIAAAQIECBAgYADwAwQIECBAgAABAgQIECBAICBgAAiULCIBAgQIECBAgAABAgQIEDAA+AECBAgQIJYZA9oAAA/tSURBVECAAAECBAgQIBAQMAAEShaRAAECBAgQIECAAAECBAgYAPwAAQIECBAgQIAAAQIECBAICBgAAiWLSIAAAQIECBAgQIAAAQIEDAB+gAABAgQIECBAgAABAgQIBAQMAIGSRSRAgAABAgQIECBAgAABAgYAP0CAAAECBAgQIECAAAECBAICBoBAySISIECAAAECBAgQIECAAAEDgB8gQIAAAQIECBAgQIAAAQIBAQNAoGQRCRAgQIAAAQIECBAgQICAAcAPECBAgAABAgQIECBAgACBgIABIFCyiAQIECBAgAABAgQIECBAwADgBwgQIECAAAECBAgQIECAQEDAABAoWUQCBAgQIECAAAECBAgQIGAA8AMECBAgQIAAAQIECBAgQCAgYAAIlCwiAQIECBAgQIAAAQIECBAwAPgBAgQIECBAgAABAgQIECAQEDAABEoWkQABAgQIECBAgAABAgQIGAD8AAECBAgQIECAAAECBAgQCAgYAAIli0iAAAECBAgQIECAAAECBAwAfoAAAQIECBAgQIAAAQIECAQEDACBkkUkQIAAAQIECBAgQIAAAQIGAD9AgAABAgQIECBAgAABAgQCAgaAQMkiEiBAgAABAgQIECBAgAABA4AfIECAAAECBAgQIECAAAECAQEDQKBkEQkQIECAAAECBAgQIECAgAHADxAgQIAAAQIECBAgQIAAgYCAASBQsogECBAgQIAAAQIECBAgQMAA4AcIECBAgAABAgQIECBAgEBAwAAQKFlEAgQIECBAgAABAgQIECBgAPADBAgQIECAAAECBAgQIEAgIGAACJQsIgECBAgQIECAAAECBAgQMAD4AQIECBAgQIAAAQIECBAgEBAwAARKFpEAAQIECBAgQIAAAQIECBgA/AABAgQIECBAgAABAgQIEAgIGAACJYtIgAABAgQIECBAgAABAgQMAH6AAAECBAgQIECAAAECBAgEBAwAgZJFJECAAAECBAgQIECAAAECBgA/QIAAAQIECBAgQIAAAQIEAgIGgEDJIhIgQIAAAQIECBAgQIAAAQOAHyBAgAABAgQIECBAgAABAgEBA0CgZBEJECBAgAABAgQIECBAgIABwA8QIECAAAECBAgQIECAAIGAgAEgULKIBAgQIECAAAECBAgQIEDAAOAHCBAgQIAAAQIECBAgQIBAQMAAEChZRAIECBAgQIAAAQIECBAgYADwAwQIECBAgAABAgQIECBAICBgAAiULCIBAgQIECBAgAABAgQIEDAA+AECBAgQIECAAAECBAgQIBAQMAAEShaRAAECBAgQIECAAAECBAgYAPwAAQIECBAgQIAAAQIECBAICBgAAiWLSIAAAQIECBAgQIAAAQIEDAB+gAABAgQIECBAgAABAgQIBAQMAIGSRSRAgAABAgQIECBAgAABAgYAP0CAAAECBAgQIECAAAECBAICBoBAySISIECAAAECBAgQIECAAAEDgB8gQIAAAQIECBAgQIAAAQIBAQNAoGQRCRAgQIAAAQIECBAgQICAAcAPECBAgAABAgQIECBAgACBgIABIFCyiAQIECBAgAABAgQIECBAwADgBwgQIECAAAECBAgQIECAQEDAABAoWUQCBAgQIECAAAECBAgQIGAA8AMECBAgQIAAAQIECBAgQCAgYAAIlCwiAQIECBAgQIAAAQIECBAwAPgBAgQIECBAgAABAgQIECAQEDAABEoWkQABAgQIECBAgAABAgQIGAD8AAECBAgQIECAAAECBAgQCAgYAAIli0iAAAECBAgQIECAAAECBAwAfoAAAQIECBAgQIAAAQIECAQEDACBkkUkQIAAAQIECBAgQIAAAQIGAD9AgAABAgQIECBAgAABAgQCAgaAQMkiEiBAgAABAgQIECBAgAABA4AfIECAAAECBAgQIECAAAECAQEDQKBkEQkQIECAAAECBAgQIECAgAHADxAgQIAAAQIECBAgQIAAgYCAASBQsogECBAgQIAAAQIECBAgQMAA4AcIECBAgAABAgQIECBAgEBAwAAQKFlEAgQIECBAgAABAgQIECBgAPADBAgQIECAAAECBAgQIEAgIGAACJQsIgECBAgQIECAAAECBAgQMAD4AQIECBAgQIAAAQIECBAgEBAwAARKFpEAAQIECBAgQIAAAQIECBgA/AABAgQIECBAgAABAgQIEAgIGAACJYtIgAABAgQIECBAgAABAgQMAH6AAAECBAgQIECAAAECBAgEBAwAgZJFJECAAAECBAgQIECAAAECBgA/QIAAAQIECBAgQIAAAQIEAgIGgEDJIhIgQIAAAQIECBAgQIAAAQOAHyBAgAABAgQIECBAgAABAgEBA0CgZBEJECBAgAABAgQIECBAgIABwA8QIECAAAECBAgQIECAAIGAgAEgULKIBAgQIECAAAECBAgQIEDAAOAHCBAgQIAAAQIECBAgQIBAQMAAEChZRAIECBAgQIAAAQIECBAgYADwAwQIECBAgAABAgQIECBAICBgAAiULCIBAgQIECBAgAABAgQIEDAA+AECBAgQIECAAAECBAgQIBAQMAAEShaRAAECBAgQIECAAAECBAgYAPwAAQIECBAgQIAAAQIECBAICBgAAiWLSIAAAQIECBAgQIAAAQIEDAB+gAABAgQIECBAgAABAgQIBAQMAIGSRSRAgAABAgQIECBAgAABAgYAP0CAAAECBAgQIECAAAECBAICBoBAySISIECAAAECBAgQIECAAAEDgB8gQIAAAQIECBAgQIAAAQIBAQNAoGQRCRAgQIAAAQIECBAgQICAAcAPECBAgAABAgQIECBAgACBgIABIFCyiAQIECBAgAABAgQIECBAwADgBwgQIECAAAECBAgQIECAQEDAABAoWUQCBAgQIECAAAECBAgQIGAA8AMECBAgQIAAAQIECBAgQCAgYAAIlCwiAQIECBAgQIAAAQIECBAwAPgBAgQIECBAgAABAgQIECAQEDAABEoWkQABAgQIECBAgAABAgQIGAD8AAECBAgQIECAAAECBAgQCAgYAAIli0iAAAECBAgQIECAAAECBAwAfoAAAQIECBAgQIAAAQIECAQEDACBkkUkQIAAAQIECBAgQIAAAQIGAD9AgAABAgQIECBAgAABAgQCAgaAQMkiEiBAgAABAgQIECBAgAABA4AfIECAAAECBAgQIECAAAECAQEDQKBkEQkQIECAAAECBAgQIECAgAHADxAgQIAAAQIECBAgQIAAgYCAASBQsogECBAgQIAAAQIECBAgQMAA4AcIECBAgAABAgQIECBAgEBAwAAQKFlEAgQIECBAgAABAgQIECBgAPADBAgQIECAAAECBAgQIEAgIGAACJQsIgECBAgQIECAAAECBAgQMAD4AQIECBAgQIAAAQIECBAgEBAwAARKFpEAAQIECBAgQIAAAQIECBgA/AABAgQIECBAgAABAgQIEAgIGAACJYtIgAABAgQIECBAgAABAgQMAH6AAAECBAgQIECAAAECBAgEBAwAgZJFJECAAAECBAgQIECAAAECBgA/QIAAAQIECBAgQIAAAQIEAgIGgEDJIhIgQIAAAQIECBAgQIAAAQOAHyBAgAABAgQIECBAgAABAgEBA0CgZBEJECBAgAABAgQIECBAgIABwA8QIECAAAECBAgQIECAAIGAgAEgULKIBAgQIECAAAECBAgQIEDAAOAHCBAgQIAAAQIECBAgQIBAQMAAEChZRAIECBAgQIAAAQIECBAgYADwAwQIECBAgAABAgQIECBAICBgAAiULCIBAgQIECBAgAABAgQIEDAA+AECBAgQIECAAAECBAgQIBAQMAAEShaRAAECBAgQIECAAAECBAgYAPwAAQIECBAgQIAAAQIECBAICBgAAiWLSIAAAQIECBAgQIAAAQIEDAB+gAABAgQIECBAgAABAgQIBAQMAIGSRSRAgAABAgQIECBAgAABAgYAP0CAAAECBAgQIECAAAECBAICBoBAySISIECAAAECBAgQIECAAAEDgB8gQIAAAQIECBAgQIAAAQIBAQNAoGQRCRAgQIAAAQIECBAgQICAAcAPECBAgAABAgQIECBAgACBgIABIFCyiAQIECBAgAABAgQIECBAwADgBwgQIECAAAECBAgQIECAQEDAABAoWUQCBAgQIECAAAECBAgQIGAA8AMECBAgQIAAAQIECBAgQCAgYAAIlCwiAQIECBAgQIAAAQIECBAwAPgBAgQIECBAgAABAgQIECAQEDAABEoWkQABAgQIECBAgAABAgQIGAD8AAECBAgQIECAAAECBAgQCAgYAAIli0iAAAECBAgQIECAAAECBAwAfoAAAQIECBAgQIAAAQIECAQEDACBkkUkQIAAAQIECBAgQIAAAQIGAD9AgAABAgQIECBAgAABAgQCAgaAQMkiEiBAgAABAgQIECBAgAABA4AfIECAAAECBAgQIECAAAECAQEDQKBkEQkQIECAAAECBAgQIECAgAHADxAgQIAAAQIECBAgQIAAgYCAASBQsogECBAgQIAAAQIECBAgQMAA4AcIECBAgAABAgQIECBAgEBAwAAQKFlEAgQIECBAgAABAgQIECBgAPADBAgQIECAAAECBAgQIEAgIGAACJQsIgECBAgQIECAAAECBAgQMAD4AQIECBAgQIAAAQIECBAgEBAwAARKFpEAAQIECBAgQIAAAQIECBgA/AABAgQIECBAgAABAgQIEAgIGAACJYtIgAABAgQIECBAgAABAgQMAH6AAAECBAgQIECAAAECBAgEBAwAgZJFJECAAAECBAgQIECAAAECBgA/QIAAAQIECBAgQIAAAQIEAgIGgEDJIhIgQIAAAQIECBAgQIAAAQOAHyBAgAABAgQIECBAgAABAgEBA0CgZBEJECBAgAABAgQIECBAgIABwA8QIECAAAECBAgQIECAAIGAgAEgULKIBAgQIECAAAECBAgQIEDAAOAHCBAgQIAAAQIECBAgQIBAQMAAEChZRAIECBAgQIAAAQIECBAgYADwAwQIECBAgAABAgQIECBAICBgAAiULCIBAgQIECBAgAABAgQIEDAA+AECBAgQIECAAAECBAgQIBAQMAAEShaRAAECBAgQIECAAAECBAgYAPwAAQIECBAgQIAAAQIECBAICBgAAiWLSIAAAQIECBAgQIAAAQIEDAB+gAABAgQIECBAgAABAgQIBAQMAIGSRSRAgAABAgQIECBAgAABAgYAP0CAAAECBAgQIECAAAECBAICBoBAySISIECAAAECBAgQIECAAAEDgB8gQIAAAQIECBAgQIAAAQIBAQNAoGQRCRAgQIAAAQIECBAgQICAAcAPECBAgAABAgQIECBAgACBgIABIFCyiAQIECBwNxoCoyEwGgKjITAaAqMhMBoCoyEwGgIA34wAPZ3msZsAAAAASUVORK5CYII=",
  "public": true,
  "files": [
    {
      "name": "MessengerProcessor.js",
      "data": "CgovKioKICogQSBzaW1wbGUgTWVzc2FnZVBvcnQgdGVzdGVyLgogKgogKiBAY2xhc3MgTWVzc2VuZ2VyUHJvY2Vzc29yCiAqIEBleHRlbmRzIEF1ZGlvV29ya2xldFByb2Nlc3NvcgogKi8KY2xhc3MgTWVzc2VuZ2VyUHJvY2Vzc29yIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29yIHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIHN1cGVyKCk7CiAgICB0aGlzLl9sYXN0VXBkYXRlID0gY3VycmVudFRpbWU7CiAgICB0aGlzLnBvcnQub25tZXNzYWdlID0gdGhpcy5oYW5kbGVNZXNzYWdlXy5iaW5kKHRoaXMpOwogICAgdGhpcy5fdGltZV9hcnJheSA9IFswXQogICAgdGhpcy5fb2Zmc2V0ID0gMDsKICB9CgogIGhhbmRsZU1lc3NhZ2VfKGV2ZW50KSB7CiAgICB0aGlzLl9vZmZzZXQgPSAwOwogICAgdGhpcy5fdGltZV9hcnJheSA9IGV2ZW50LmRhdGEKICB9CgogIHByb2Nlc3MoaW5wdXRzLCBvdXRwdXRzLCBwYXJhbWV0ZXJzKSB7CiAgICBmb3IoY29uc3QgbyBvZiBvdXRwdXRzKSB7CiAgICAgIGZvcihjb25zdCBjIG9mIG8pIHsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGNbaV0gPSB0aGlzLl90aW1lX2FycmF5W1soaSt0aGlzLl9vZmZzZXQpJXRoaXMuX3RpbWVfYXJyYXkubGVuZ3RoXV07CiAgICAgICAgfQogICAgICAgIHRoaXMuX29mZnNldCArPSBjLmxlbmd0aAogICAgICB9CiAgICB9CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn0KCnJlZ2lzdGVyUHJvY2Vzc29yKCdtZXNzZW5nZXItcHJvY2Vzc29yJywgTWVzc2VuZ2VyUHJvY2Vzc29yKTs="
    },
    {
      "name": "dsp.js",
      "data": "LyogCiAqICBEU1AuanMgLSBhIGNvbXByZWhlbnNpdmUgZGlnaXRhbCBzaWduYWwgcHJvY2Vzc2luZyAgbGlicmFyeSBmb3IgamF2YXNjcmlwdAogKiAKICogIENyZWF0ZWQgYnkgQ29yYmFuIEJyb29rIDxjb3JiYW5icm9va0BnbWFpbC5jb20+IG9uIDIwMTAtMDEtMDEuCiAqICBDb3B5cmlnaHQgMjAxMCBDb3JiYW4gQnJvb2suIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiAqCiAqLwoKLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ09OU1RBTlRTICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCi8qKgogKiBEU1AgaXMgYW4gb2JqZWN0IHdoaWNoIGNvbnRhaW5zIGdlbmVyYWwgcHVycG9zZSB1dGlsaXR5IGZ1bmN0aW9ucyBhbmQgY29uc3RhbnRzCiAqLwp2YXIgRFNQID0gewogIC8vIENoYW5uZWxzCiAgTEVGVDogICAgICAgICAgIDAsCiAgUklHSFQ6ICAgICAgICAgIDEsCiAgTUlYOiAgICAgICAgICAgIDIsCgogIC8vIFdhdmVmb3JtcwogIFNJTkU6ICAgICAgICAgICAxLAogIFRSSUFOR0xFOiAgICAgICAyLAogIFNBVzogICAgICAgICAgICAzLAogIFNRVUFSRTogICAgICAgICA0LAoKICAvLyBGaWx0ZXJzCiAgTE9XUEFTUzogICAgICAgIDAsCiAgSElHSFBBU1M6ICAgICAgIDEsCiAgQkFORFBBU1M6ICAgICAgIDIsCiAgTk9UQ0g6ICAgICAgICAgIDMsCgogIC8vIFdpbmRvdyBmdW5jdGlvbnMKICBCQVJUTEVUVDogICAgICAgMSwKICBCQVJUTEVUVEhBTk46ICAgMiwKICBCTEFDS01BTjogICAgICAgMywKICBDT1NJTkU6ICAgICAgICAgNCwKICBHQVVTUzogICAgICAgICAgNSwKICBIQU1NSU5HOiAgICAgICAgNiwKICBIQU5OOiAgICAgICAgICAgNywKICBMQU5DWk9TOiAgICAgICAgOCwKICBSRUNUQU5HVUxBUjogICAgOSwKICBUUklBTkdVTEFSOiAgICAgMTAsCgogIC8vIExvb3AgbW9kZXMKICBPRkY6ICAgICAgICAgICAgMCwKICBGVzogICAgICAgICAgICAgMSwKICBCVzogICAgICAgICAgICAgMiwKICBGV0JXOiAgICAgICAgICAgMywKCiAgLy8gTWF0aAogIFRXT19QSTogICAgICAgICAyKk1hdGguUEkKfTsKCi8vIFNldHVwIGFycmF5cyBmb3IgcGxhdGZvcm1zIHdoaWNoIGRvIG5vdCBzdXBwb3J0IGJ5dGUgYXJyYXlzCmZ1bmN0aW9uIHNldHVwVHlwZWRBcnJheShuYW1lLCBmYWxsYmFjaykgewogIC8vIGNoZWNrIGlmIFR5cGVkQXJyYXkgZXhpc3RzCiAgLy8gdHlwZW9mIG9uIE1pbmVmaWVsZCBhbmQgQ2hyb21lIHJldHVybiBmdW5jdGlvbiwgdHlwZW9mIG9uIFdlYmtpdCByZXR1cm5zIG9iamVjdC4KICBpZiAodHlwZW9mIHRoaXNbbmFtZV0gIT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIHRoaXNbbmFtZV0gIT09ICJvYmplY3QiKSB7CiAgICAvLyBub3BlLi4gY2hlY2sgaWYgV2ViR0xBcnJheSBleGlzdHMKICAgIGlmICh0eXBlb2YgdGhpc1tmYWxsYmFja10gPT09ICJmdW5jdGlvbiIgJiYgdHlwZW9mIHRoaXNbZmFsbGJhY2tdICE9PSAib2JqZWN0IikgewogICAgICB0aGlzW25hbWVdID0gdGhpc1tmYWxsYmFja107CiAgICB9IGVsc2UgewogICAgICAvLyBub3BlLi4gc2V0IGFzIE5hdGl2ZSBKUyBhcnJheQogICAgICB0aGlzW25hbWVdID0gZnVuY3Rpb24ob2JqKSB7CiAgICAgICAgaWYgKG9iaiBpbnN0YW5jZW9mIEFycmF5KSB7CiAgICAgICAgICByZXR1cm4gb2JqOwogICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIG9iaiA9PT0gIm51bWJlciIpIHsKICAgICAgICAgIHJldHVybiBuZXcgQXJyYXkob2JqKTsKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfQp9CgpzZXR1cFR5cGVkQXJyYXkoIkZsb2F0NjRBcnJheSIsICJXZWJHTEZsb2F0QXJyYXkiKTsKc2V0dXBUeXBlZEFycmF5KCJJbnQzMkFycmF5IiwgICAiV2ViR0xJbnRBcnJheSIpOwpzZXR1cFR5cGVkQXJyYXkoIlVpbnQxNkFycmF5IiwgICJXZWJHTFVuc2lnbmVkU2hvcnRBcnJheSIpOwpzZXR1cFR5cGVkQXJyYXkoIlVpbnQ4QXJyYXkiLCAgICJXZWJHTFVuc2lnbmVkQnl0ZUFycmF5Iik7CgoKLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgRFNQIFVUSUxJVFkgRlVOQ1RJT05TICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8KLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCi8qKgogKiBJbnZlcnRzIHRoZSBwaGFzZSBvZiBhIHNpZ25hbAogKgogKiBAcGFyYW0ge0FycmF5fSBidWZmZXIgQSBzYW1wbGUgYnVmZmVyCiAqCiAqIEByZXR1cm5zIFRoZSBpbnZlcnRlZCBzYW1wbGUgYnVmZmVyCiAqLwpEU1AuaW52ZXJ0ID0gZnVuY3Rpb24oYnVmZmVyKSB7CiAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGJ1ZmZlci5sZW5ndGg7IGkgPCBsZW47IGkrKykgewogICAgYnVmZmVyW2ldICo9IC0xOwogIH0KCiAgcmV0dXJuIGJ1ZmZlcjsKfTsKCi8qKgogKiBDb252ZXJ0cyBzcGxpdC1zdGVyZW8gKGR1YWwgbW9ubykgc2FtcGxlIGJ1ZmZlcnMgaW50byBhIHN0ZXJlbyBpbnRlcmxlYXZlZCBzYW1wbGUgYnVmZmVyCiAqCiAqIEBwYXJhbSB7QXJyYXl9IGxlZnQgIEEgc2FtcGxlIGJ1ZmZlcgogKiBAcGFyYW0ge0FycmF5fSByaWdodCBBIHNhbXBsZSBidWZmZXIKICoKICogQHJldHVybnMgVGhlIHN0ZXJlbyBpbnRlcmxlYXZlZCBidWZmZXIKICovCkRTUC5pbnRlcmxlYXZlID0gZnVuY3Rpb24obGVmdCwgcmlnaHQpIHsKICBpZiAobGVmdC5sZW5ndGggIT09IHJpZ2h0Lmxlbmd0aCkgewogICAgdGhyb3cgIkNhbiBub3QgaW50ZXJsZWF2ZS4gQ2hhbm5lbCBsZW5ndGhzIGRpZmZlci4iOwogIH0KIAogIHZhciBzdGVyZW9JbnRlcmxlYXZlZCA9IG5ldyBGbG9hdDY0QXJyYXkobGVmdC5sZW5ndGggKiAyKTsKIAogIGZvciAodmFyIGkgPSAwLCBsZW4gPSBsZWZ0Lmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CiAgICBzdGVyZW9JbnRlcmxlYXZlZFsyKmldICAgPSBsZWZ0W2ldOwogICAgc3RlcmVvSW50ZXJsZWF2ZWRbMippKzFdID0gcmlnaHRbaV07CiAgfQogCiAgcmV0dXJuIHN0ZXJlb0ludGVybGVhdmVkOwp9OwoKLyoqCiAqIENvbnZlcnRzIGEgc3RlcmVvLWludGVybGVhdmVkIHNhbXBsZSBidWZmZXIgaW50byBzcGxpdC1zdGVyZW8gKGR1YWwgbW9ubykgc2FtcGxlIGJ1ZmZlcnMKICoKICogQHBhcmFtIHtBcnJheX0gYnVmZmVyIEEgc3RlcmVvLWludGVybGVhdmVkIHNhbXBsZSBidWZmZXIKICoKICogQHJldHVybnMgYW4gQXJyYXkgY29udGFpbmluZyBsZWZ0IGFuZCByaWdodCBjaGFubmVscwogKi8KRFNQLmRlaW50ZXJsZWF2ZSA9IChmdW5jdGlvbigpIHsKICB2YXIgbGVmdCwgcmlnaHQsIG1peCwgZGVpbnRlcmxlYXZlQ2hhbm5lbCA9IFtdOyAKCiAgZGVpbnRlcmxlYXZlQ2hhbm5lbFtEU1AuTUlYXSA9IGZ1bmN0aW9uKGJ1ZmZlcikgewogICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGJ1ZmZlci5sZW5ndGgvMjsgaSA8IGxlbjsgaSsrKSB7CiAgICAgIG1peFtpXSA9IChidWZmZXJbMippXSArIGJ1ZmZlclsyKmkrMV0pIC8gMjsKICAgIH0KICAgIHJldHVybiBtaXg7CiAgfTsKCiAgZGVpbnRlcmxlYXZlQ2hhbm5lbFtEU1AuTEVGVF0gPSBmdW5jdGlvbihidWZmZXIpIHsKICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBidWZmZXIubGVuZ3RoLzI7IGkgPCBsZW47IGkrKykgewogICAgICBsZWZ0W2ldICA9IGJ1ZmZlclsyKmldOwogICAgfQogICAgcmV0dXJuIGxlZnQ7CiAgfTsKCiAgZGVpbnRlcmxlYXZlQ2hhbm5lbFtEU1AuUklHSFRdID0gZnVuY3Rpb24oYnVmZmVyKSB7CiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gYnVmZmVyLmxlbmd0aC8yOyBpIDwgbGVuOyBpKyspIHsKICAgICAgcmlnaHRbaV0gID0gYnVmZmVyWzIqaSsxXTsKICAgIH0KICAgIHJldHVybiByaWdodDsKICB9OwoKICByZXR1cm4gZnVuY3Rpb24oY2hhbm5lbCwgYnVmZmVyKSB7IAogICAgbGVmdCAgPSBsZWZ0ICB8fCBuZXcgRmxvYXQ2NEFycmF5KGJ1ZmZlci5sZW5ndGgvMik7CiAgICByaWdodCA9IHJpZ2h0IHx8IG5ldyBGbG9hdDY0QXJyYXkoYnVmZmVyLmxlbmd0aC8yKTsKICAgIG1peCAgID0gbWl4ICAgfHwgbmV3IEZsb2F0NjRBcnJheShidWZmZXIubGVuZ3RoLzIpOwoKICAgIGlmIChidWZmZXIubGVuZ3RoLzIgIT09IGxlZnQubGVuZ3RoKSB7CiAgICAgIGxlZnQgID0gbmV3IEZsb2F0NjRBcnJheShidWZmZXIubGVuZ3RoLzIpOwogICAgICByaWdodCA9IG5ldyBGbG9hdDY0QXJyYXkoYnVmZmVyLmxlbmd0aC8yKTsKICAgICAgbWl4ICAgPSBuZXcgRmxvYXQ2NEFycmF5KGJ1ZmZlci5sZW5ndGgvMik7CiAgICB9CgogICAgcmV0dXJuIGRlaW50ZXJsZWF2ZUNoYW5uZWxbY2hhbm5lbF0oYnVmZmVyKTsKICB9Owp9KCkpOwoKLyoqCiAqIFNlcGFyYXRlcyBhIGNoYW5uZWwgZnJvbSBhIHN0ZXJlby1pbnRlcmxlYXZlZCBzYW1wbGUgYnVmZmVyCiAqCiAqIEBwYXJhbSB7QXJyYXl9ICBidWZmZXIgQSBzdGVyZW8taW50ZXJsZWF2ZWQgc2FtcGxlIGJ1ZmZlcgogKiBAcGFyYW0ge051bWJlcn0gY2hhbm5lbCBBIGNoYW5uZWwgY29uc3RhbnQgKExFRlQsIFJJR0hULCBNSVgpCiAqCiAqIEByZXR1cm5zIGFuIEFycmF5IGNvbnRhaW5pbmcgYSBzaWduYWwgbW9ubyBzYW1wbGUgYnVmZmVyCiAqLwpEU1AuZ2V0Q2hhbm5lbCA9IERTUC5kZWludGVybGVhdmU7CgovKioKICogSGVscGVyIG1ldGhvZCAoZm9yIFJldmVyYikgdG8gbWl4IHR3byAoaW50ZXJsZWF2ZWQpIHNhbXBsZWJ1ZmZlcnMuIEl0J3MgcG9zc2libGUKICogdG8gbmVnYXRlIHRoZSBzZWNvbmQgYnVmZmVyIHdoaWxlIG1peGluZyBhbmQgdG8gcGVyZm9ybSBhIHZvbHVtZSBjb3JyZWN0aW9uCiAqIG9uIHRoZSBmaW5hbCBzaWduYWwuCiAqCiAqIEBwYXJhbSB7QXJyYXl9IHNhbXBsZUJ1ZmZlcjEgQXJyYXkgY29udGFpbmluZyBGbG9hdCB2YWx1ZXMgb3IgYSBGbG9hdDY0QXJyYXkKICogQHBhcmFtIHtBcnJheX0gc2FtcGxlQnVmZmVyMiBBcnJheSBjb250YWluaW5nIEZsb2F0IHZhbHVlcyBvciBhIEZsb2F0NjRBcnJheQogKiBAcGFyYW0ge0Jvb2xlYW59IG5lZ2F0ZSBXaGVuIHRydWUgaW52ZXJ0cy9mbGlwcyB0aGUgYXVkaW8gc2lnbmFsCiAqIEBwYXJhbSB7TnVtYmVyfSB2b2x1bWVDb3JyZWN0aW9uIFdoZW4geW91IGFkZCBtdWx0aXBsZSBzYW1wbGUgYnVmZmVycywgdXNlIHRoaXMgdG8gdGFtZSB5b3VyIHNpZ25hbCA7KQogKgogKiBAcmV0dXJucyBBIG5ldyBGbG9hdDY0QXJyYXkgaW50ZXJsZWF2ZWQgYnVmZmVyLgogKi8KRFNQLm1peFNhbXBsZUJ1ZmZlcnMgPSBmdW5jdGlvbihzYW1wbGVCdWZmZXIxLCBzYW1wbGVCdWZmZXIyLCBuZWdhdGUsIHZvbHVtZUNvcnJlY3Rpb24pewogIHZhciBvdXRwdXRTYW1wbGVzID0gbmV3IEZsb2F0NjRBcnJheShzYW1wbGVCdWZmZXIxKTsKCiAgZm9yKHZhciBpID0gMDsgaTxzYW1wbGVCdWZmZXIxLmxlbmd0aDsgaSsrKXsKICAgIG91dHB1dFNhbXBsZXNbaV0gKz0gKG5lZ2F0ZSA/IC1zYW1wbGVCdWZmZXIyW2ldIDogc2FtcGxlQnVmZmVyMltpXSkgLyB2b2x1bWVDb3JyZWN0aW9uOwogIH0KIAogIHJldHVybiBvdXRwdXRTYW1wbGVzOwp9OyAKCi8vIEJpcXVhZCBmaWx0ZXIgdHlwZXMKRFNQLkxQRiA9IDA7ICAgICAgICAgICAgICAgIC8vIEgocykgPSAxIC8gKHNeMiArIHMvUSArIDEpCkRTUC5IUEYgPSAxOyAgICAgICAgICAgICAgICAvLyBIKHMpID0gc14yIC8gKHNeMiArIHMvUSArIDEpCkRTUC5CUEZfQ09OU1RBTlRfU0tJUlQgPSAyOyAvLyBIKHMpID0gcyAvIChzXjIgKyBzL1EgKyAxKSAgKGNvbnN0YW50IHNraXJ0IGdhaW4sIHBlYWsgZ2FpbiA9IFEpCkRTUC5CUEZfQ09OU1RBTlRfUEVBSyA9IDM7ICAvLyBIKHMpID0gKHMvUSkgLyAoc14yICsgcy9RICsgMSkgICAgICAoY29uc3RhbnQgMCBkQiBwZWFrIGdhaW4pCkRTUC5OT1RDSCA9IDQ7ICAgICAgICAgICAgICAvLyBIKHMpID0gKHNeMiArIDEpIC8gKHNeMiArIHMvUSArIDEpCkRTUC5BUEYgPSA1OyAgICAgICAgICAgICAgICAvLyBIKHMpID0gKHNeMiAtIHMvUSArIDEpIC8gKHNeMiArIHMvUSArIDEpCkRTUC5QRUFLSU5HX0VRID0gNjsgICAgICAgICAvLyBIKHMpID0gKHNeMiArIHMqKEEvUSkgKyAxKSAvIChzXjIgKyBzLyhBKlEpICsgMSkKRFNQLkxPV19TSEVMRiA9IDc7ICAgICAgICAgIC8vIEgocykgPSBBICogKHNeMiArIChzcXJ0KEEpL1EpKnMgKyBBKS8oQSpzXjIgKyAoc3FydChBKS9RKSpzICsgMSkKRFNQLkhJR0hfU0hFTEYgPSA4OyAgICAgICAgIC8vIEgocykgPSBBICogKEEqc14yICsgKHNxcnQoQSkvUSkqcyArIDEpLyhzXjIgKyAoc3FydChBKS9RKSpzICsgQSkKCi8vIEJpcXVhZCBmaWx0ZXIgcGFyYW1ldGVyIHR5cGVzCkRTUC5RID0gMTsKRFNQLkJXID0gMjsgLy8gU0hBUkVEIHdpdGggQkFDS1dBUkRTIExPT1AgTU9ERQpEU1AuUyA9IDM7CgovLyBGaW5kIFJNUyBvZiBzaWduYWwKRFNQLlJNUyA9IGZ1bmN0aW9uKGJ1ZmZlcikgewogIHZhciB0b3RhbCA9IDA7CiAgCiAgZm9yICh2YXIgaSA9IDAsIG4gPSBidWZmZXIubGVuZ3RoOyBpIDwgbjsgaSsrKSB7CiAgICB0b3RhbCArPSBidWZmZXJbaV0gKiBidWZmZXJbaV07CiAgfQogIAogIHJldHVybiBNYXRoLnNxcnQodG90YWwgLyBuKTsKfTsKCi8vIEZpbmQgUGVhayBvZiBzaWduYWwKRFNQLlBlYWsgPSBmdW5jdGlvbihidWZmZXIpIHsKICB2YXIgcGVhayA9IDA7CiAgCiAgZm9yICh2YXIgaSA9IDAsIG4gPSBidWZmZXIubGVuZ3RoOyBpIDwgbjsgaSsrKSB7CiAgICBwZWFrID0gKE1hdGguYWJzKGJ1ZmZlcltpXSkgPiBwZWFrKSA/IE1hdGguYWJzKGJ1ZmZlcltpXSkgOiBwZWFrOyAKICB9CiAgCiAgcmV0dXJuIHBlYWs7Cn07CgovLyBGb3VyaWVyIFRyYW5zZm9ybSBNb2R1bGUgdXNlZCBieSBERlQsIEZGVCwgUkZGVApmdW5jdGlvbiBGb3VyaWVyVHJhbnNmb3JtKGJ1ZmZlclNpemUsIHNhbXBsZVJhdGUpIHsKICB0aGlzLmJ1ZmZlclNpemUgPSBidWZmZXJTaXplOwogIHRoaXMuc2FtcGxlUmF0ZSA9IHNhbXBsZVJhdGU7CiAgdGhpcy5iYW5kd2lkdGggID0gMiAvIGJ1ZmZlclNpemUgKiBzYW1wbGVSYXRlIC8gMjsKCiAgdGhpcy5zcGVjdHJ1bSAgID0gbmV3IEZsb2F0NjRBcnJheShidWZmZXJTaXplLzIpOwogIHRoaXMucmVhbCAgICAgICA9IG5ldyBGbG9hdDY0QXJyYXkoYnVmZmVyU2l6ZSk7CiAgdGhpcy5pbWFnICAgICAgID0gbmV3IEZsb2F0NjRBcnJheShidWZmZXJTaXplKTsKCiAgdGhpcy5wZWFrQmFuZCAgID0gMDsKICB0aGlzLnBlYWsgICAgICAgPSAwOwoKICAvKioKICAgKiBDYWxjdWxhdGVzIHRoZSAqbWlkZGxlKiBmcmVxdWVuY3kgb2YgYW4gRkZUIGJhbmQuCiAgICoKICAgKiBAcGFyYW0ge051bWJlcn0gaW5kZXggVGhlIGluZGV4IG9mIHRoZSBGRlQgYmFuZC4KICAgKgogICAqIEByZXR1cm5zIFRoZSBtaWRkbGUgZnJlcXVlbmN5IGluIEh6LgogICAqLwogIHRoaXMuZ2V0QmFuZEZyZXF1ZW5jeSA9IGZ1bmN0aW9uKGluZGV4KSB7CiAgICByZXR1cm4gdGhpcy5iYW5kd2lkdGggKiBpbmRleCArIHRoaXMuYmFuZHdpZHRoIC8gMjsKICB9OwoKICB0aGlzLmNhbGN1bGF0ZVNwZWN0cnVtID0gZnVuY3Rpb24oKSB7CiAgICB2YXIgc3BlY3RydW0gID0gdGhpcy5zcGVjdHJ1bSwKICAgICAgICByZWFsICAgICAgPSB0aGlzLnJlYWwsCiAgICAgICAgaW1hZyAgICAgID0gdGhpcy5pbWFnLAogICAgICAgIGJTaSAgICAgICA9IDIgLyB0aGlzLmJ1ZmZlclNpemUsCiAgICAgICAgc3FydCAgICAgID0gTWF0aC5zcXJ0LAogICAgICAgIHJ2YWwsIAogICAgICAgIGl2YWwsCiAgICAgICAgbWFnOwoKICAgIGZvciAodmFyIGkgPSAwLCBOID0gYnVmZmVyU2l6ZS8yOyBpIDwgTjsgaSsrKSB7CiAgICAgIHJ2YWwgPSByZWFsW2ldOwogICAgICBpdmFsID0gaW1hZ1tpXTsKICAgICAgbWFnID0gYlNpICogc3FydChydmFsICogcnZhbCArIGl2YWwgKiBpdmFsKTsKCiAgICAgIGlmIChtYWcgPiB0aGlzLnBlYWspIHsKICAgICAgICB0aGlzLnBlYWtCYW5kID0gaTsKICAgICAgICB0aGlzLnBlYWsgPSBtYWc7CiAgICAgIH0KCiAgICAgIHNwZWN0cnVtW2ldID0gbWFnOwogICAgfQogIH07Cn0KCi8qKgogKiBERlQgaXMgYSBjbGFzcyBmb3IgY2FsY3VsYXRpbmcgdGhlIERpc2NyZXRlIEZvdXJpZXIgVHJhbnNmb3JtIG9mIGEgc2lnbmFsLgogKgogKiBAcGFyYW0ge051bWJlcn0gYnVmZmVyU2l6ZSBUaGUgc2l6ZSBvZiB0aGUgc2FtcGxlIGJ1ZmZlciB0byBiZSBjb21wdXRlZAogKiBAcGFyYW0ge051bWJlcn0gc2FtcGxlUmF0ZSBUaGUgc2FtcGxlUmF0ZSBvZiB0aGUgYnVmZmVyIChlZy4gNDQxMDApCiAqCiAqIEBjb25zdHJ1Y3RvcgogKi8KZnVuY3Rpb24gREZUKGJ1ZmZlclNpemUsIHNhbXBsZVJhdGUpIHsKICBGb3VyaWVyVHJhbnNmb3JtLmNhbGwodGhpcywgYnVmZmVyU2l6ZSwgc2FtcGxlUmF0ZSk7CgogIHZhciBOID0gYnVmZmVyU2l6ZS8yICogYnVmZmVyU2l6ZTsKICB2YXIgVFdPX1BJID0gMiAqIE1hdGguUEk7CgogIHRoaXMuc2luVGFibGUgPSBuZXcgRmxvYXQ2NEFycmF5KE4pOwogIHRoaXMuY29zVGFibGUgPSBuZXcgRmxvYXQ2NEFycmF5KE4pOwoKICBmb3IgKHZhciBpID0gMDsgaSA8IE47IGkrKykgewogICAgdGhpcy5zaW5UYWJsZVtpXSA9IE1hdGguc2luKGkgKiBUV09fUEkgLyBidWZmZXJTaXplKTsKICAgIHRoaXMuY29zVGFibGVbaV0gPSBNYXRoLmNvcyhpICogVFdPX1BJIC8gYnVmZmVyU2l6ZSk7CiAgfQp9CgovKioKICogUGVyZm9ybXMgYSBmb3J3YXJkIHRyYW5zZm9ybSBvbiB0aGUgc2FtcGxlIGJ1ZmZlci4KICogQ29udmVydHMgYSB0aW1lIGRvbWFpbiBzaWduYWwgdG8gZnJlcXVlbmN5IGRvbWFpbiBzcGVjdHJhLgogKgogKiBAcGFyYW0ge0FycmF5fSBidWZmZXIgVGhlIHNhbXBsZSBidWZmZXIKICoKICogQHJldHVybnMgVGhlIGZyZXF1ZW5jeSBzcGVjdHJ1bSBhcnJheQogKi8KREZULnByb3RvdHlwZS5mb3J3YXJkID0gZnVuY3Rpb24oYnVmZmVyKSB7CiAgdmFyIHJlYWwgPSB0aGlzLnJlYWwsIAogICAgICBpbWFnID0gdGhpcy5pbWFnLAogICAgICBydmFsLAogICAgICBpdmFsOwoKICBmb3IgKHZhciBrID0gMDsgayA8IHRoaXMuYnVmZmVyU2l6ZS8yOyBrKyspIHsKICAgIHJ2YWwgPSAwLjA7CiAgICBpdmFsID0gMC4wOwoKICAgIGZvciAodmFyIG4gPSAwOyBuIDwgYnVmZmVyLmxlbmd0aDsgbisrKSB7CiAgICAgIHJ2YWwgKz0gdGhpcy5jb3NUYWJsZVtrKm5dICogYnVmZmVyW25dOwogICAgICBpdmFsICs9IHRoaXMuc2luVGFibGVbaypuXSAqIGJ1ZmZlcltuXTsKICAgIH0KCiAgICByZWFsW2tdID0gcnZhbDsKICAgIGltYWdba10gPSBpdmFsOwogIH0KCiAgcmV0dXJuIHRoaXMuY2FsY3VsYXRlU3BlY3RydW0oKTsKfTsKCgovKioKICogRkZUIGlzIGEgY2xhc3MgZm9yIGNhbGN1bGF0aW5nIHRoZSBEaXNjcmV0ZSBGb3VyaWVyIFRyYW5zZm9ybSBvZiBhIHNpZ25hbAogKiB3aXRoIHRoZSBGYXN0IEZvdXJpZXIgVHJhbnNmb3JtIGFsZ29yaXRobS4KICoKICogQHBhcmFtIHtOdW1iZXJ9IGJ1ZmZlclNpemUgVGhlIHNpemUgb2YgdGhlIHNhbXBsZSBidWZmZXIgdG8gYmUgY29tcHV0ZWQuIE11c3QgYmUgcG93ZXIgb2YgMgogKiBAcGFyYW0ge051bWJlcn0gc2FtcGxlUmF0ZSBUaGUgc2FtcGxlUmF0ZSBvZiB0aGUgYnVmZmVyIChlZy4gNDQxMDApCiAqCiAqIEBjb25zdHJ1Y3RvcgogKi8KZnVuY3Rpb24gRkZUKGJ1ZmZlclNpemUsIHNhbXBsZVJhdGUpIHsKICBGb3VyaWVyVHJhbnNmb3JtLmNhbGwodGhpcywgYnVmZmVyU2l6ZSwgc2FtcGxlUmF0ZSk7CiAgIAogIHRoaXMucmV2ZXJzZVRhYmxlID0gbmV3IFVpbnQzMkFycmF5KGJ1ZmZlclNpemUpOwoKICB2YXIgbGltaXQgPSAxOwogIHZhciBiaXQgPSBidWZmZXJTaXplID4+IDE7CgogIHZhciBpOwoKICB3aGlsZSAobGltaXQgPCBidWZmZXJTaXplKSB7CiAgICBmb3IgKGkgPSAwOyBpIDwgbGltaXQ7IGkrKykgewogICAgICB0aGlzLnJldmVyc2VUYWJsZVtpICsgbGltaXRdID0gdGhpcy5yZXZlcnNlVGFibGVbaV0gKyBiaXQ7CiAgICB9CgogICAgbGltaXQgPSBsaW1pdCA8PCAxOwogICAgYml0ID0gYml0ID4+IDE7CiAgfQoKICB0aGlzLnNpblRhYmxlID0gbmV3IEZsb2F0NjRBcnJheShidWZmZXJTaXplKTsKICB0aGlzLmNvc1RhYmxlID0gbmV3IEZsb2F0NjRBcnJheShidWZmZXJTaXplKTsKCiAgZm9yIChpID0gMDsgaSA8IGJ1ZmZlclNpemU7IGkrKykgewogICAgdGhpcy5zaW5UYWJsZVtpXSA9IE1hdGguc2luKC1NYXRoLlBJL2kpOwogICAgdGhpcy5jb3NUYWJsZVtpXSA9IE1hdGguY29zKC1NYXRoLlBJL2kpOwogIH0KfQoKLyoqCiAqIFBlcmZvcm1zIGEgZm9yd2FyZCB0cmFuc2Zvcm0gb24gdGhlIHNhbXBsZSBidWZmZXIuCiAqIENvbnZlcnRzIGEgdGltZSBkb21haW4gc2lnbmFsIHRvIGZyZXF1ZW5jeSBkb21haW4gc3BlY3RyYS4KICoKICogQHBhcmFtIHtBcnJheX0gYnVmZmVyIFRoZSBzYW1wbGUgYnVmZmVyLiBCdWZmZXIgTGVuZ3RoIG11c3QgYmUgcG93ZXIgb2YgMgogKgogKiBAcmV0dXJucyBUaGUgZnJlcXVlbmN5IHNwZWN0cnVtIGFycmF5CiAqLwpGRlQucHJvdG90eXBlLmZvcndhcmQgPSBmdW5jdGlvbihidWZmZXIpIHsKICAvLyBMb2NhbGx5IHNjb3BlIHZhcmlhYmxlcyBmb3Igc3BlZWQgdXAKICB2YXIgYnVmZmVyU2l6ZSAgICAgID0gdGhpcy5idWZmZXJTaXplLAogICAgICBjb3NUYWJsZSAgICAgICAgPSB0aGlzLmNvc1RhYmxlLAogICAgICBzaW5UYWJsZSAgICAgICAgPSB0aGlzLnNpblRhYmxlLAogICAgICByZXZlcnNlVGFibGUgICAgPSB0aGlzLnJldmVyc2VUYWJsZSwKICAgICAgcmVhbCAgICAgICAgICAgID0gdGhpcy5yZWFsLAogICAgICBpbWFnICAgICAgICAgICAgPSB0aGlzLmltYWcsCiAgICAgIHNwZWN0cnVtICAgICAgICA9IHRoaXMuc3BlY3RydW07CgogIHZhciBrID0gTWF0aC5mbG9vcihNYXRoLmxvZyhidWZmZXJTaXplKSAvIE1hdGguTE4yKTsKCiAgaWYgKE1hdGgucG93KDIsIGspICE9PSBidWZmZXJTaXplKSB7IHRocm93ICJJbnZhbGlkIGJ1ZmZlciBzaXplLCBtdXN0IGJlIGEgcG93ZXIgb2YgMi4iOyB9CiAgaWYgKGJ1ZmZlclNpemUgIT09IGJ1ZmZlci5sZW5ndGgpICB7IHRocm93ICJTdXBwbGllZCBidWZmZXIgaXMgbm90IHRoZSBzYW1lIHNpemUgYXMgZGVmaW5lZCBGRlQuIEZGVCBTaXplOiAiICsgYnVmZmVyU2l6ZSArICIgQnVmZmVyIFNpemU6ICIgKyBidWZmZXIubGVuZ3RoOyB9CgogIHZhciBoYWxmU2l6ZSA9IDEsCiAgICAgIHBoYXNlU2hpZnRTdGVwUmVhbCwKICAgICAgcGhhc2VTaGlmdFN0ZXBJbWFnLAogICAgICBjdXJyZW50UGhhc2VTaGlmdFJlYWwsCiAgICAgIGN1cnJlbnRQaGFzZVNoaWZ0SW1hZywKICAgICAgb2ZmLAogICAgICB0ciwKICAgICAgdGksCiAgICAgIHRtcFJlYWwsCiAgICAgIGk7CgogIGZvciAoaSA9IDA7IGkgPCBidWZmZXJTaXplOyBpKyspIHsKICAgIHJlYWxbaV0gPSBidWZmZXJbcmV2ZXJzZVRhYmxlW2ldXTsKICAgIGltYWdbaV0gPSAwOwogIH0KCiAgd2hpbGUgKGhhbGZTaXplIDwgYnVmZmVyU2l6ZSkgewogICAgLy9waGFzZVNoaWZ0U3RlcFJlYWwgPSBNYXRoLmNvcygtTWF0aC5QSS9oYWxmU2l6ZSk7CiAgICAvL3BoYXNlU2hpZnRTdGVwSW1hZyA9IE1hdGguc2luKC1NYXRoLlBJL2hhbGZTaXplKTsKICAgIHBoYXNlU2hpZnRTdGVwUmVhbCA9IGNvc1RhYmxlW2hhbGZTaXplXTsKICAgIHBoYXNlU2hpZnRTdGVwSW1hZyA9IHNpblRhYmxlW2hhbGZTaXplXTsKICAgIAogICAgY3VycmVudFBoYXNlU2hpZnRSZWFsID0gMTsKICAgIGN1cnJlbnRQaGFzZVNoaWZ0SW1hZyA9IDA7CgogICAgZm9yICh2YXIgZmZ0U3RlcCA9IDA7IGZmdFN0ZXAgPCBoYWxmU2l6ZTsgZmZ0U3RlcCsrKSB7CiAgICAgIGkgPSBmZnRTdGVwOwoKICAgICAgd2hpbGUgKGkgPCBidWZmZXJTaXplKSB7CiAgICAgICAgb2ZmID0gaSArIGhhbGZTaXplOwogICAgICAgIHRyID0gKGN1cnJlbnRQaGFzZVNoaWZ0UmVhbCAqIHJlYWxbb2ZmXSkgLSAoY3VycmVudFBoYXNlU2hpZnRJbWFnICogaW1hZ1tvZmZdKTsKICAgICAgICB0aSA9IChjdXJyZW50UGhhc2VTaGlmdFJlYWwgKiBpbWFnW29mZl0pICsgKGN1cnJlbnRQaGFzZVNoaWZ0SW1hZyAqIHJlYWxbb2ZmXSk7CgogICAgICAgIHJlYWxbb2ZmXSA9IHJlYWxbaV0gLSB0cjsKICAgICAgICBpbWFnW29mZl0gPSBpbWFnW2ldIC0gdGk7CiAgICAgICAgcmVhbFtpXSArPSB0cjsKICAgICAgICBpbWFnW2ldICs9IHRpOwoKICAgICAgICBpICs9IGhhbGZTaXplIDw8IDE7CiAgICAgIH0KCiAgICAgIHRtcFJlYWwgPSBjdXJyZW50UGhhc2VTaGlmdFJlYWw7CiAgICAgIGN1cnJlbnRQaGFzZVNoaWZ0UmVhbCA9ICh0bXBSZWFsICogcGhhc2VTaGlmdFN0ZXBSZWFsKSAtIChjdXJyZW50UGhhc2VTaGlmdEltYWcgKiBwaGFzZVNoaWZ0U3RlcEltYWcpOwogICAgICBjdXJyZW50UGhhc2VTaGlmdEltYWcgPSAodG1wUmVhbCAqIHBoYXNlU2hpZnRTdGVwSW1hZykgKyAoY3VycmVudFBoYXNlU2hpZnRJbWFnICogcGhhc2VTaGlmdFN0ZXBSZWFsKTsKICAgIH0KCiAgICBoYWxmU2l6ZSA9IGhhbGZTaXplIDw8IDE7CiAgfQoKICByZXR1cm4gdGhpcy5jYWxjdWxhdGVTcGVjdHJ1bSgpOwp9OwoKRkZULnByb3RvdHlwZS5pbnZlcnNlID0gZnVuY3Rpb24ocmVhbCwgaW1hZykgewogIC8vIExvY2FsbHkgc2NvcGUgdmFyaWFibGVzIGZvciBzcGVlZCB1cAogIHZhciBidWZmZXJTaXplICAgICAgPSB0aGlzLmJ1ZmZlclNpemUsCiAgICAgIGNvc1RhYmxlICAgICAgICA9IHRoaXMuY29zVGFibGUsCiAgICAgIHNpblRhYmxlICAgICAgICA9IHRoaXMuc2luVGFibGUsCiAgICAgIHJldmVyc2VUYWJsZSAgICA9IHRoaXMucmV2ZXJzZVRhYmxlLAogICAgICBzcGVjdHJ1bSAgICAgICAgPSB0aGlzLnNwZWN0cnVtOwogICAgIAogICAgICByZWFsID0gcmVhbCB8fCB0aGlzLnJlYWw7CiAgICAgIGltYWcgPSBpbWFnIHx8IHRoaXMuaW1hZzsKCiAgdmFyIGhhbGZTaXplID0gMSwKICAgICAgcGhhc2VTaGlmdFN0ZXBSZWFsLAogICAgICBwaGFzZVNoaWZ0U3RlcEltYWcsCiAgICAgIGN1cnJlbnRQaGFzZVNoaWZ0UmVhbCwKICAgICAgY3VycmVudFBoYXNlU2hpZnRJbWFnLAogICAgICBvZmYsCiAgICAgIHRyLAogICAgICB0aSwKICAgICAgdG1wUmVhbCwKICAgICAgaTsKCiAgZm9yIChpID0gMDsgaSA8IGJ1ZmZlclNpemU7IGkrKykgewogICAgaW1hZ1tpXSAqPSAtMTsKICB9CgogIHZhciByZXZSZWFsID0gbmV3IEZsb2F0NjRBcnJheShidWZmZXJTaXplKTsKICB2YXIgcmV2SW1hZyA9IG5ldyBGbG9hdDY0QXJyYXkoYnVmZmVyU2l6ZSk7CiAKICBmb3IgKGkgPSAwOyBpIDwgcmVhbC5sZW5ndGg7IGkrKykgewogICAgcmV2UmVhbFtpXSA9IHJlYWxbcmV2ZXJzZVRhYmxlW2ldXTsKICAgIHJldkltYWdbaV0gPSBpbWFnW3JldmVyc2VUYWJsZVtpXV07CiAgfQogCiAgcmVhbCA9IHJldlJlYWw7CiAgaW1hZyA9IHJldkltYWc7CgogIHdoaWxlIChoYWxmU2l6ZSA8IGJ1ZmZlclNpemUpIHsKICAgIHBoYXNlU2hpZnRTdGVwUmVhbCA9IGNvc1RhYmxlW2hhbGZTaXplXTsKICAgIHBoYXNlU2hpZnRTdGVwSW1hZyA9IHNpblRhYmxlW2hhbGZTaXplXTsKICAgIGN1cnJlbnRQaGFzZVNoaWZ0UmVhbCA9IDE7CiAgICBjdXJyZW50UGhhc2VTaGlmdEltYWcgPSAwOwoKICAgIGZvciAodmFyIGZmdFN0ZXAgPSAwOyBmZnRTdGVwIDwgaGFsZlNpemU7IGZmdFN0ZXArKykgewogICAgICBpID0gZmZ0U3RlcDsKCiAgICAgIHdoaWxlIChpIDwgYnVmZmVyU2l6ZSkgewogICAgICAgIG9mZiA9IGkgKyBoYWxmU2l6ZTsKICAgICAgICB0ciA9IChjdXJyZW50UGhhc2VTaGlmdFJlYWwgKiByZWFsW29mZl0pIC0gKGN1cnJlbnRQaGFzZVNoaWZ0SW1hZyAqIGltYWdbb2ZmXSk7CiAgICAgICAgdGkgPSAoY3VycmVudFBoYXNlU2hpZnRSZWFsICogaW1hZ1tvZmZdKSArIChjdXJyZW50UGhhc2VTaGlmdEltYWcgKiByZWFsW29mZl0pOwoKICAgICAgICByZWFsW29mZl0gPSByZWFsW2ldIC0gdHI7CiAgICAgICAgaW1hZ1tvZmZdID0gaW1hZ1tpXSAtIHRpOwogICAgICAgIHJlYWxbaV0gKz0gdHI7CiAgICAgICAgaW1hZ1tpXSArPSB0aTsKCiAgICAgICAgaSArPSBoYWxmU2l6ZSA8PCAxOwogICAgICB9CgogICAgICB0bXBSZWFsID0gY3VycmVudFBoYXNlU2hpZnRSZWFsOwogICAgICBjdXJyZW50UGhhc2VTaGlmdFJlYWwgPSAodG1wUmVhbCAqIHBoYXNlU2hpZnRTdGVwUmVhbCkgLSAoY3VycmVudFBoYXNlU2hpZnRJbWFnICogcGhhc2VTaGlmdFN0ZXBJbWFnKTsKICAgICAgY3VycmVudFBoYXNlU2hpZnRJbWFnID0gKHRtcFJlYWwgKiBwaGFzZVNoaWZ0U3RlcEltYWcpICsgKGN1cnJlbnRQaGFzZVNoaWZ0SW1hZyAqIHBoYXNlU2hpZnRTdGVwUmVhbCk7CiAgICB9CgogICAgaGFsZlNpemUgPSBoYWxmU2l6ZSA8PCAxOwogIH0KCiAgdmFyIGJ1ZmZlciA9IG5ldyBGbG9hdDY0QXJyYXkoYnVmZmVyU2l6ZSk7IC8vIHRoaXMgc2hvdWxkIGJlIHJldXNlZCBpbnN0ZWFkCiAgZm9yIChpID0gMDsgaSA8IGJ1ZmZlclNpemU7IGkrKykgewogICAgYnVmZmVyW2ldID0gcmVhbFtpXSAvIGJ1ZmZlclNpemU7CiAgfQoKICByZXR1cm4gYnVmZmVyOwp9OwoKLyoqCiAqIFJGRlQgaXMgYSBjbGFzcyBmb3IgY2FsY3VsYXRpbmcgdGhlIERpc2NyZXRlIEZvdXJpZXIgVHJhbnNmb3JtIG9mIGEgc2lnbmFsCiAqIHdpdGggdGhlIEZhc3QgRm91cmllciBUcmFuc2Zvcm0gYWxnb3JpdGhtLgogKgogKiBUaGlzIG1ldGhvZCBjdXJyZW50bHkgb25seSBjb250YWlucyBhIGZvcndhcmQgdHJhbnNmb3JtIGJ1dCBpcyBoaWdobHkgb3B0aW1pemVkLgogKgogKiBAcGFyYW0ge051bWJlcn0gYnVmZmVyU2l6ZSBUaGUgc2l6ZSBvZiB0aGUgc2FtcGxlIGJ1ZmZlciB0byBiZSBjb21wdXRlZC4gTXVzdCBiZSBwb3dlciBvZiAyCiAqIEBwYXJhbSB7TnVtYmVyfSBzYW1wbGVSYXRlIFRoZSBzYW1wbGVSYXRlIG9mIHRoZSBidWZmZXIgKGVnLiA0NDEwMCkKICoKICogQGNvbnN0cnVjdG9yCiAqLwoKLy8gbG9va3VwIHRhYmxlcyBkb24ndCByZWFsbHkgZ2FpbiB1cyBhbnkgc3BlZWQsIGJ1dCB0aGV5IGRvIGluY3JlYXNlCi8vIGNhY2hlIGZvb3RwcmludCwgc28gZG9uJ3QgdXNlIHRoZW0gaW4gaGVyZQoKLy8gYWxzbyB3ZSBkb24ndCB1c2Ugc2VwZWFyYXRlIGFycmF5cyBmb3IgcmVhbC9pbWFnaW5hcnkgcGFydHMKCi8vIHRoaXMgb25lIGEgbGl0dGxlIG1vcmUgdGhhbiB0d2ljZSBhcyBmYXN0IGFzIHRoZSBvbmUgaW4gRkZUCi8vIGhvd2V2ZXIgSSBvbmx5IGRpZCB0aGUgZm9yd2FyZCB0cmFuc2Zvcm0KCi8vIHRoZSByZXN0IG9mIHRoaXMgd2FzIHRyYW5zbGF0ZWQgZnJvbSBDLCBzZWUgaHR0cDovL3d3dy5qamouZGUvZnh0LwovLyB0aGlzIGlzIHRoZSByZWFsIHNwbGl0IHJhZGl4IEZGVAoKZnVuY3Rpb24gUkZGVChidWZmZXJTaXplLCBzYW1wbGVSYXRlKSB7CiAgRm91cmllclRyYW5zZm9ybS5jYWxsKHRoaXMsIGJ1ZmZlclNpemUsIHNhbXBsZVJhdGUpOwoKICB0aGlzLnRyYW5zID0gbmV3IEZsb2F0NjRBcnJheShidWZmZXJTaXplKTsKCiAgdGhpcy5yZXZlcnNlVGFibGUgPSBuZXcgVWludDMyQXJyYXkoYnVmZmVyU2l6ZSk7CgogIC8vIGRvbid0IHVzZSBhIGxvb2t1cCB0YWJsZSB0byBkbyB0aGUgcGVybXV0ZSwgdXNlIHRoaXMgaW5zdGVhZAogIHRoaXMucmV2ZXJzZUJpblBlcm11dGUgPSBmdW5jdGlvbiAoZGVzdCwgc291cmNlKSB7CiAgICB2YXIgYnVmZmVyU2l6ZSAgPSB0aGlzLmJ1ZmZlclNpemUsIAogICAgICAgIGhhbGZTaXplICAgID0gYnVmZmVyU2l6ZSA+Pj4gMSwgCiAgICAgICAgbm0xICAgICAgICAgPSBidWZmZXJTaXplIC0gMSwgCiAgICAgICAgaSA9IDEsIHIgPSAwLCBoOwoKICAgIGRlc3RbMF0gPSBzb3VyY2VbMF07CgogICAgZG8gewogICAgICByICs9IGhhbGZTaXplOwogICAgICBkZXN0W2ldID0gc291cmNlW3JdOwogICAgICBkZXN0W3JdID0gc291cmNlW2ldOwogICAgICAKICAgICAgaSsrOwoKICAgICAgaCA9IGhhbGZTaXplIDw8IDE7CiAgICAgIHdoaWxlIChoID0gaCA+PiAxLCAhKChyIF49IGgpICYgaCkpOwoKICAgICAgaWYgKHIgPj0gaSkgeyAKICAgICAgICBkZXN0W2ldICAgICA9IHNvdXJjZVtyXTsgCiAgICAgICAgZGVzdFtyXSAgICAgPSBzb3VyY2VbaV07CgogICAgICAgIGRlc3Rbbm0xLWldID0gc291cmNlW25tMS1yXTsgCiAgICAgICAgZGVzdFtubTEtcl0gPSBzb3VyY2Vbbm0xLWldOwogICAgICB9CiAgICAgIGkrKzsKICAgIH0gd2hpbGUgKGkgPCBoYWxmU2l6ZSk7CiAgICBkZXN0W25tMV0gPSBzb3VyY2Vbbm0xXTsKICB9OwoKICB0aGlzLmdlbmVyYXRlUmV2ZXJzZVRhYmxlID0gZnVuY3Rpb24gKCkgewogICAgdmFyIGJ1ZmZlclNpemUgID0gdGhpcy5idWZmZXJTaXplLCAKICAgICAgICBoYWxmU2l6ZSAgICA9IGJ1ZmZlclNpemUgPj4+IDEsIAogICAgICAgIG5tMSAgICAgICAgID0gYnVmZmVyU2l6ZSAtIDEsIAogICAgICAgIGkgPSAxLCByID0gMCwgaDsKCiAgICB0aGlzLnJldmVyc2VUYWJsZVswXSA9IDA7CgogICAgZG8gewogICAgICByICs9IGhhbGZTaXplOwogICAgICAKICAgICAgdGhpcy5yZXZlcnNlVGFibGVbaV0gPSByOwogICAgICB0aGlzLnJldmVyc2VUYWJsZVtyXSA9IGk7CgogICAgICBpKys7CgogICAgICBoID0gaGFsZlNpemUgPDwgMTsKICAgICAgd2hpbGUgKGggPSBoID4+IDEsICEoKHIgXj0gaCkgJiBoKSk7CgogICAgICBpZiAociA+PSBpKSB7IAogICAgICAgIHRoaXMucmV2ZXJzZVRhYmxlW2ldID0gcjsKICAgICAgICB0aGlzLnJldmVyc2VUYWJsZVtyXSA9IGk7CgogICAgICAgIHRoaXMucmV2ZXJzZVRhYmxlW25tMS1pXSA9IG5tMS1yOwogICAgICAgIHRoaXMucmV2ZXJzZVRhYmxlW25tMS1yXSA9IG5tMS1pOwogICAgICB9CiAgICAgIGkrKzsKICAgIH0gd2hpbGUgKGkgPCBoYWxmU2l6ZSk7CgogICAgdGhpcy5yZXZlcnNlVGFibGVbbm0xXSA9IG5tMTsKICB9OwoKICB0aGlzLmdlbmVyYXRlUmV2ZXJzZVRhYmxlKCk7Cn0KCgovLyBPcmRlcmluZyBvZiBvdXRwdXQ6Ci8vCi8vIHRyYW5zWzBdICAgICA9IHJlWzBdICg9PXplcm8gZnJlcXVlbmN5LCBwdXJlbHkgcmVhbCkKLy8gdHJhbnNbMV0gICAgID0gcmVbMV0KLy8gICAgICAgICAgICAgLi4uCi8vIHRyYW5zW24vMi0xXSA9IHJlW24vMi0xXQovLyB0cmFuc1tuLzJdICAgPSByZVtuLzJdICAgICg9PW55cXVpc3QgZnJlcXVlbmN5LCBwdXJlbHkgcmVhbCkKLy8KLy8gdHJhbnNbbi8yKzFdID0gaW1bbi8yLTFdCi8vIHRyYW5zW24vMisyXSA9IGltW24vMi0yXQovLyAgICAgICAgICAgICAuLi4KLy8gdHJhbnNbbi0xXSAgID0gaW1bMV0gCgpSRkZULnByb3RvdHlwZS5mb3J3YXJkID0gZnVuY3Rpb24oYnVmZmVyKSB7CiAgdmFyIG4gICAgICAgICA9IHRoaXMuYnVmZmVyU2l6ZSwgCiAgICAgIHNwZWN0cnVtICA9IHRoaXMuc3BlY3RydW0sCiAgICAgIHggICAgICAgICA9IHRoaXMudHJhbnMsIAogICAgICBUV09fUEkgICAgPSAyKk1hdGguUEksCiAgICAgIHNxcnQgICAgICA9IE1hdGguc3FydCwKICAgICAgaSAgICAgICAgID0gbiA+Pj4gMSwKICAgICAgYlNpICAgICAgID0gMiAvIG4sCiAgICAgIG4yLCBuNCwgbjgsIG5uLCAKICAgICAgdDEsIHQyLCB0MywgdDQsIAogICAgICBpMSwgaTIsIGkzLCBpNCwgaTUsIGk2LCBpNywgaTgsIAogICAgICBzdDEsIGNjMSwgc3MxLCBjYzMsIHNzMywKICAgICAgZSwgCiAgICAgIGEsCiAgICAgIHJ2YWwsIGl2YWwsIG1hZzsgCgogIHRoaXMucmV2ZXJzZUJpblBlcm11dGUoeCwgYnVmZmVyKTsKCiAgLyoKICB2YXIgcmV2ZXJzZVRhYmxlID0gdGhpcy5yZXZlcnNlVGFibGU7CgogIGZvciAodmFyIGsgPSAwLCBsZW4gPSByZXZlcnNlVGFibGUubGVuZ3RoOyBrIDwgbGVuOyBrKyspIHsKICAgIHhba10gPSBidWZmZXJbcmV2ZXJzZVRhYmxlW2tdXTsKICB9CiAgKi8KCiAgZm9yICh2YXIgaXggPSAwLCBpZCA9IDQ7IGl4IDwgbjsgaWQgKj0gNCkgewogICAgZm9yICh2YXIgaTAgPSBpeDsgaTAgPCBuOyBpMCArPSBpZCkgewogICAgICAvL3N1bWRpZmYoeFtpMF0sIHhbaTArMV0pOyAvLyB7YSwgYn0gIDwtLXwge2ErYiwgYS1ifQogICAgICBzdDEgPSB4W2kwXSAtIHhbaTArMV07CiAgICAgIHhbaTBdICs9IHhbaTArMV07CiAgICAgIHhbaTArMV0gPSBzdDE7CiAgICB9IAogICAgaXggPSAyKihpZC0xKTsKICB9CgogIG4yID0gMjsKICBubiA9IG4gPj4+IDE7CgogIHdoaWxlKChubiA9IG5uID4+PiAxKSkgewogICAgaXggPSAwOwogICAgbjIgPSBuMiA8PCAxOwogICAgaWQgPSBuMiA8PCAxOwogICAgbjQgPSBuMiA+Pj4gMjsKICAgIG44ID0gbjIgPj4+IDM7CiAgICBkbyB7CiAgICAgIGlmKG40ICE9PSAxKSB7CiAgICAgICAgZm9yKGkwID0gaXg7IGkwIDwgbjsgaTAgKz0gaWQpIHsKICAgICAgICAgIGkxID0gaTA7CiAgICAgICAgICBpMiA9IGkxICsgbjQ7CiAgICAgICAgICBpMyA9IGkyICsgbjQ7CiAgICAgICAgICBpNCA9IGkzICsgbjQ7CiAgICAgCiAgICAgICAgICAvL2RpZmZzdW0zX3IoeFtpM10sIHhbaTRdLCB0MSk7IC8vIHthLCBiLCBzfSA8LS18IHthLCBiLWEsIGErYn0KICAgICAgICAgIHQxID0geFtpM10gKyB4W2k0XTsKICAgICAgICAgIHhbaTRdIC09IHhbaTNdOwogICAgICAgICAgLy9zdW1kaWZmMyh4W2kxXSwgdDEsIHhbaTNdKTsgICAvLyB7YSwgYiwgZH0gPC0tfCB7YStiLCBiLCBhLWJ9CiAgICAgICAgICB4W2kzXSA9IHhbaTFdIC0gdDE7IAogICAgICAgICAgeFtpMV0gKz0gdDE7CiAgICAgCiAgICAgICAgICBpMSArPSBuODsKICAgICAgICAgIGkyICs9IG44OwogICAgICAgICAgaTMgKz0gbjg7CiAgICAgICAgICBpNCArPSBuODsKICAgICAgICAgCiAgICAgICAgICAvL3N1bWRpZmYoeFtpM10sIHhbaTRdLCB0MSwgdDIpOyAvLyB7cywgZH0gIDwtLXwge2ErYiwgYS1ifQogICAgICAgICAgdDEgPSB4W2kzXSArIHhbaTRdOwogICAgICAgICAgdDIgPSB4W2kzXSAtIHhbaTRdOwogICAgICAgICAKICAgICAgICAgIHQxID0gLXQxICogTWF0aC5TUVJUMV8yOwogICAgICAgICAgdDIgKj0gTWF0aC5TUVJUMV8yOwogICAgIAogICAgICAgICAgLy8gc3VtZGlmZih0MSwgeFtpMl0sIHhbaTRdLCB4W2kzXSk7IC8vIHtzLCBkfSAgPC0tfCB7YStiLCBhLWJ9CiAgICAgICAgICBzdDEgPSB4W2kyXTsKICAgICAgICAgIHhbaTRdID0gdDEgKyBzdDE7IAogICAgICAgICAgeFtpM10gPSB0MSAtIHN0MTsKICAgICAgICAgIAogICAgICAgICAgLy9zdW1kaWZmMyh4W2kxXSwgdDIsIHhbaTJdKTsgLy8ge2EsIGIsIGR9IDwtLXwge2ErYiwgYiwgYS1ifQogICAgICAgICAgeFtpMl0gPSB4W2kxXSAtIHQyOwogICAgICAgICAgeFtpMV0gKz0gdDI7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGZvcihpMCA9IGl4OyBpMCA8IG47IGkwICs9IGlkKSB7CiAgICAgICAgICBpMSA9IGkwOwogICAgICAgICAgaTIgPSBpMSArIG40OwogICAgICAgICAgaTMgPSBpMiArIG40OwogICAgICAgICAgaTQgPSBpMyArIG40OwogICAgIAogICAgICAgICAgLy9kaWZmc3VtM19yKHhbaTNdLCB4W2k0XSwgdDEpOyAvLyB7YSwgYiwgc30gPC0tfCB7YSwgYi1hLCBhK2J9CiAgICAgICAgICB0MSA9IHhbaTNdICsgeFtpNF07IAogICAgICAgICAgeFtpNF0gLT0geFtpM107CiAgICAgICAgICAKICAgICAgICAgIC8vc3VtZGlmZjMoeFtpMV0sIHQxLCB4W2kzXSk7ICAgLy8ge2EsIGIsIGR9IDwtLXwge2ErYiwgYiwgYS1ifQogICAgICAgICAgeFtpM10gPSB4W2kxXSAtIHQxOyAKICAgICAgICAgIHhbaTFdICs9IHQxOwogICAgICAgIH0KICAgICAgfQogICAKICAgICAgaXggPSAoaWQgPDwgMSkgLSBuMjsKICAgICAgaWQgPSBpZCA8PCAyOwogICAgfSB3aGlsZSAoaXggPCBuKTsKIAogICAgZSA9IFRXT19QSSAvIG4yOwoKICAgIGZvciAodmFyIGogPSAxOyBqIDwgbjg7IGorKykgewogICAgICBhID0gaiAqIGU7CiAgICAgIHNzMSA9IE1hdGguc2luKGEpOwogICAgICBjYzEgPSBNYXRoLmNvcyhhKTsKCiAgICAgIC8vc3MzID0gc2luKDMqYSk7IGNjMyA9IGNvcygzKmEpOwogICAgICBjYzMgPSA0KmNjMSooY2MxKmNjMS0wLjc1KTsKICAgICAgc3MzID0gNCpzczEqKDAuNzUtc3MxKnNzMSk7CiAgIAogICAgICBpeCA9IDA7IGlkID0gbjIgPDwgMTsKICAgICAgZG8gewogICAgICAgIGZvciAoaTAgPSBpeDsgaTAgPCBuOyBpMCArPSBpZCkgewogICAgICAgICAgaTEgPSBpMCArIGo7CiAgICAgICAgICBpMiA9IGkxICsgbjQ7CiAgICAgICAgICBpMyA9IGkyICsgbjQ7CiAgICAgICAgICBpNCA9IGkzICsgbjQ7CiAgICAgICAKICAgICAgICAgIGk1ID0gaTAgKyBuNCAtIGo7CiAgICAgICAgICBpNiA9IGk1ICsgbjQ7CiAgICAgICAgICBpNyA9IGk2ICsgbjQ7CiAgICAgICAgICBpOCA9IGk3ICsgbjQ7CiAgICAgICAKICAgICAgICAgIC8vY211bHQoYywgcywgeCwgeSwgJnUsICZ2KQogICAgICAgICAgLy9jbXVsdChjYzEsIHNzMSwgeFtpN10sIHhbaTNdLCB0MiwgdDEpOyAvLyB7dSx2fSA8LS18IHt4KmMteSpzLCB4KnMreSpjfQogICAgICAgICAgdDIgPSB4W2k3XSpjYzEgLSB4W2kzXSpzczE7IAogICAgICAgICAgdDEgPSB4W2k3XSpzczEgKyB4W2kzXSpjYzE7CiAgICAgICAgICAKICAgICAgICAgIC8vY211bHQoY2MzLCBzczMsIHhbaThdLCB4W2k0XSwgdDQsIHQzKTsKICAgICAgICAgIHQ0ID0geFtpOF0qY2MzIC0geFtpNF0qc3MzOyAKICAgICAgICAgIHQzID0geFtpOF0qc3MzICsgeFtpNF0qY2MzOwogICAgICAgCiAgICAgICAgICAvL3N1bWRpZmYodDIsIHQ0KTsgICAvLyB7YSwgYn0gPC0tfCB7YStiLCBhLWJ9CiAgICAgICAgICBzdDEgPSB0MiAtIHQ0OwogICAgICAgICAgdDIgKz0gdDQ7CiAgICAgICAgICB0NCA9IHN0MTsKICAgICAgICAgIAogICAgICAgICAgLy9zdW1kaWZmKHQyLCB4W2k2XSwgeFtpOF0sIHhbaTNdKTsgLy8ge3MsIGR9ICA8LS18IHthK2IsIGEtYn0KICAgICAgICAgIC8vc3QxID0geFtpNl07IHhbaThdID0gdDIgKyBzdDE7IHhbaTNdID0gdDIgLSBzdDE7CiAgICAgICAgICB4W2k4XSA9IHQyICsgeFtpNl07IAogICAgICAgICAgeFtpM10gPSB0MiAtIHhbaTZdOwogICAgICAgICAKICAgICAgICAgIC8vc3VtZGlmZl9yKHQxLCB0Myk7IC8vIHthLCBifSA8LS18IHthK2IsIGItYX0KICAgICAgICAgIHN0MSA9IHQzIC0gdDE7CiAgICAgICAgICB0MSArPSB0MzsKICAgICAgICAgIHQzID0gc3QxOwogICAgICAgICAgCiAgICAgICAgICAvL3N1bWRpZmYodDMsIHhbaTJdLCB4W2k0XSwgeFtpN10pOyAvLyB7cywgZH0gIDwtLXwge2ErYiwgYS1ifQogICAgICAgICAgLy9zdDEgPSB4W2kyXTsgeFtpNF0gPSB0MyArIHN0MTsgeFtpN10gPSB0MyAtIHN0MTsKICAgICAgICAgIHhbaTRdID0gdDMgKyB4W2kyXTsgCiAgICAgICAgICB4W2k3XSA9IHQzIC0geFtpMl07CiAgICAgICAgIAogICAgICAgICAgLy9zdW1kaWZmMyh4W2kxXSwgdDEsIHhbaTZdKTsgICAvLyB7YSwgYiwgZH0gPC0tfCB7YStiLCBiLCBhLWJ9CiAgICAgICAgICB4W2k2XSA9IHhbaTFdIC0gdDE7IAogICAgICAgICAgeFtpMV0gKz0gdDE7CiAgICAgICAgICAKICAgICAgICAgIC8vZGlmZnN1bTNfcih0NCwgeFtpNV0sIHhbaTJdKTsgLy8ge2EsIGIsIHN9IDwtLXwge2EsIGItYSwgYStifQogICAgICAgICAgeFtpMl0gPSB0NCArIHhbaTVdOyAKICAgICAgICAgIHhbaTVdIC09IHQ0OwogICAgICAgIH0KICAgICAKICAgICAgICBpeCA9IChpZCA8PCAxKSAtIG4yOwogICAgICAgIGlkID0gaWQgPDwgMjsKICAgCiAgICAgIH0gd2hpbGUgKGl4IDwgbik7CiAgICB9CiAgfQoKICB3aGlsZSAoLS1pKSB7CiAgICBydmFsID0geFtpXTsKICAgIGl2YWwgPSB4W24taS0xXTsKICAgIG1hZyA9IGJTaSAqIHNxcnQocnZhbCAqIHJ2YWwgKyBpdmFsICogaXZhbCk7CgogICAgaWYgKG1hZyA+IHRoaXMucGVhaykgewogICAgICB0aGlzLnBlYWtCYW5kID0gaTsKICAgICAgdGhpcy5wZWFrID0gbWFnOwogICAgfQoKICAgIHNwZWN0cnVtW2ldID0gbWFnOwogIH0KCiAgc3BlY3RydW1bMF0gPSBiU2kgKiB4WzBdOwoKICByZXR1cm4gc3BlY3RydW07Cn07CgpmdW5jdGlvbiBTYW1wbGVyKGZpbGUsIGJ1ZmZlclNpemUsIHNhbXBsZVJhdGUsIHBsYXlTdGFydCwgcGxheUVuZCwgbG9vcFN0YXJ0LCBsb29wRW5kLCBsb29wTW9kZSkgewogIHRoaXMuZmlsZSA9IGZpbGU7CiAgdGhpcy5idWZmZXJTaXplID0gYnVmZmVyU2l6ZTsKICB0aGlzLnNhbXBsZVJhdGUgPSBzYW1wbGVSYXRlOwogIHRoaXMucGxheVN0YXJ0ICA9IHBsYXlTdGFydCB8fCAwOyAvLyAwJQogIHRoaXMucGxheUVuZCAgICA9IHBsYXlFbmQgICB8fCAxOyAvLyAxMDAlCiAgdGhpcy5sb29wU3RhcnQgID0gbG9vcFN0YXJ0IHx8IDA7CiAgdGhpcy5sb29wRW5kICAgID0gbG9vcEVuZCAgIHx8IDE7CiAgdGhpcy5sb29wTW9kZSAgID0gbG9vcE1vZGUgIHx8IERTUC5PRkY7CiAgdGhpcy5sb2FkZWQgICAgID0gZmFsc2U7CiAgdGhpcy5zYW1wbGVzICAgID0gW107CiAgdGhpcy5zaWduYWwgICAgID0gbmV3IEZsb2F0NjRBcnJheShidWZmZXJTaXplKTsKICB0aGlzLmZyYW1lQ291bnQgPSAwOwogIHRoaXMuZW52ZWxvcGUgICA9IG51bGw7CiAgdGhpcy5hbXBsaXR1ZGUgID0gMTsKICB0aGlzLnJvb3RGcmVxdWVuY3kgPSAxMTA7IC8vIEEyIDExMAogIHRoaXMuZnJlcXVlbmN5ICA9IDU1MDsKICB0aGlzLnN0ZXAgICAgICAgPSB0aGlzLmZyZXF1ZW5jeSAvIHRoaXMucm9vdEZyZXF1ZW5jeTsKICB0aGlzLmR1cmF0aW9uICAgPSAwOwogIHRoaXMuc2FtcGxlc1Byb2Nlc3NlZCA9IDA7CiAgdGhpcy5wbGF5aGVhZCAgID0gMDsKIAogIHZhciBhdWRpbyA9IC8qIG5ldyBBdWRpbygpOyovIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIkFVRElPIik7CiAgdmFyIHNlbGYgPSB0aGlzOwogCiAgdGhpcy5sb2FkU2FtcGxlcyA9IGZ1bmN0aW9uKGV2ZW50KSB7CiAgICB2YXIgYnVmZmVyID0gRFNQLmdldENoYW5uZWwoRFNQLk1JWCwgZXZlbnQuZnJhbWVCdWZmZXIpOwogICAgZm9yICggdmFyIGkgPSAwOyBpIDwgYnVmZmVyLmxlbmd0aDsgaSsrKSB7CiAgICAgIHNlbGYuc2FtcGxlcy5wdXNoKGJ1ZmZlcltpXSk7CiAgICB9CiAgfTsKIAogIHRoaXMubG9hZENvbXBsZXRlID0gZnVuY3Rpb24oKSB7CiAgICAvLyBjb252ZXJ0IGZsZXhpYmxlIGpzIGFycmF5IGludG8gYSBmYXN0IHR5cGVkIGFycmF5CiAgICBzZWxmLnNhbXBsZXMgPSBuZXcgRmxvYXQ2NEFycmF5KHNlbGYuc2FtcGxlcyk7CiAgICBzZWxmLmxvYWRlZCA9IHRydWU7CiAgfTsKIAogIHRoaXMubG9hZE1ldGFEYXRhID0gZnVuY3Rpb24oKSB7CiAgICBzZWxmLmR1cmF0aW9uID0gYXVkaW8uZHVyYXRpb247CiAgfTsKIAogIGF1ZGlvLmFkZEV2ZW50TGlzdGVuZXIoIk1vekF1ZGlvQXZhaWxhYmxlIiwgdGhpcy5sb2FkU2FtcGxlcywgZmFsc2UpOwogIGF1ZGlvLmFkZEV2ZW50TGlzdGVuZXIoImxvYWRlZG1ldGFkYXRhIiwgdGhpcy5sb2FkTWV0YURhdGEsIGZhbHNlKTsKICBhdWRpby5hZGRFdmVudExpc3RlbmVyKCJlbmRlZCIsIHRoaXMubG9hZENvbXBsZXRlLCBmYWxzZSk7CiAgYXVkaW8ubXV0ZWQgPSB0cnVlOwogIGF1ZGlvLnNyYyA9IGZpbGU7CiAgYXVkaW8ucGxheSgpOwp9CgpTYW1wbGVyLnByb3RvdHlwZS5hcHBseUVudmVsb3BlID0gZnVuY3Rpb24oKSB7CiAgdGhpcy5lbnZlbG9wZS5wcm9jZXNzKHRoaXMuc2lnbmFsKTsKICByZXR1cm4gdGhpcy5zaWduYWw7Cn07CgpTYW1wbGVyLnByb3RvdHlwZS5nZW5lcmF0ZSA9IGZ1bmN0aW9uKCkgewogIHZhciBmcmFtZU9mZnNldCA9IHRoaXMuZnJhbWVDb3VudCAqIHRoaXMuYnVmZmVyU2l6ZTsKIAogIHZhciBsb29wV2lkdGggPSB0aGlzLnBsYXlFbmQgKiB0aGlzLnNhbXBsZXMubGVuZ3RoIC0gdGhpcy5wbGF5U3RhcnQgKiB0aGlzLnNhbXBsZXMubGVuZ3RoOwogIHZhciBwbGF5U3RhcnRTYW1wbGVzID0gdGhpcy5wbGF5U3RhcnQgKiB0aGlzLnNhbXBsZXMubGVuZ3RoOyAvLyBpZSAwLjUgLT4gNTAlIG9mIHRoZSBsZW5ndGgKICB2YXIgcGxheUVuZFNhbXBsZXMgPSB0aGlzLnBsYXlFbmQgKiB0aGlzLnNhbXBsZXMubGVuZ3RoOyAvLyBpZSAwLjUgLT4gNTAlIG9mIHRoZSBsZW5ndGgKICB2YXIgb2Zmc2V0OwoKICBmb3IgKCB2YXIgaSA9IDA7IGkgPCB0aGlzLmJ1ZmZlclNpemU7IGkrKyApIHsKICAgIHN3aXRjaCAodGhpcy5sb29wTW9kZSkgewogICAgICBjYXNlIERTUC5PRkY6CiAgICAgICAgdGhpcy5wbGF5aGVhZCA9IE1hdGgucm91bmQodGhpcy5zYW1wbGVzUHJvY2Vzc2VkICogdGhpcy5zdGVwICsgcGxheVN0YXJ0U2FtcGxlcyk7CiAgICAgICAgaWYgKHRoaXMucGxheWhlYWQgPCAodGhpcy5wbGF5RW5kICogdGhpcy5zYW1wbGVzLmxlbmd0aCkgKSB7CiAgICAgICAgICB0aGlzLnNpZ25hbFtpXSA9IHRoaXMuc2FtcGxlc1t0aGlzLnBsYXloZWFkXSAqIHRoaXMuYW1wbGl0dWRlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLnNpZ25hbFtpXSA9IDA7CiAgICAgICAgfQogICAgICAgIGJyZWFrOwogICAgIAogICAgICBjYXNlIERTUC5GVzoKICAgICAgICB0aGlzLnBsYXloZWFkID0gTWF0aC5yb3VuZCgodGhpcy5zYW1wbGVzUHJvY2Vzc2VkICogdGhpcy5zdGVwKSAlIGxvb3BXaWR0aCArIHBsYXlTdGFydFNhbXBsZXMpOwogICAgICAgIGlmICh0aGlzLnBsYXloZWFkIDwgKHRoaXMucGxheUVuZCAqIHRoaXMuc2FtcGxlcy5sZW5ndGgpICkgewogICAgICAgICAgdGhpcy5zaWduYWxbaV0gPSB0aGlzLnNhbXBsZXNbdGhpcy5wbGF5aGVhZF0gKiB0aGlzLmFtcGxpdHVkZTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICAgICAKICAgICAgY2FzZSBEU1AuQlc6CiAgICAgICAgdGhpcy5wbGF5aGVhZCA9IHBsYXlFbmRTYW1wbGVzIC0gTWF0aC5yb3VuZCgodGhpcy5zYW1wbGVzUHJvY2Vzc2VkICogdGhpcy5zdGVwKSAlIGxvb3BXaWR0aCk7CiAgICAgICAgaWYgKHRoaXMucGxheWhlYWQgPCAodGhpcy5wbGF5RW5kICogdGhpcy5zYW1wbGVzLmxlbmd0aCkgKSB7CiAgICAgICAgICB0aGlzLnNpZ25hbFtpXSA9IHRoaXMuc2FtcGxlc1t0aGlzLnBsYXloZWFkXSAqIHRoaXMuYW1wbGl0dWRlOwogICAgICAgIH0KICAgICAgICBicmVhazsKICAgICAgIAogICAgICBjYXNlIERTUC5GV0JXOgogICAgICAgIGlmICggTWF0aC5mbG9vcih0aGlzLnNhbXBsZXNQcm9jZXNzZWQgKiB0aGlzLnN0ZXAgLyBsb29wV2lkdGgpICUgMiA9PT0gMCApIHsKICAgICAgICAgIHRoaXMucGxheWhlYWQgPSBNYXRoLnJvdW5kKCh0aGlzLnNhbXBsZXNQcm9jZXNzZWQgKiB0aGlzLnN0ZXApICUgbG9vcFdpZHRoICsgcGxheVN0YXJ0U2FtcGxlcyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMucGxheWhlYWQgPSBwbGF5RW5kU2FtcGxlcyAtIE1hdGgucm91bmQoKHRoaXMuc2FtcGxlc1Byb2Nlc3NlZCAqIHRoaXMuc3RlcCkgJSBsb29wV2lkdGgpOwogICAgICAgIH0gIAogICAgICAgIGlmICh0aGlzLnBsYXloZWFkIDwgKHRoaXMucGxheUVuZCAqIHRoaXMuc2FtcGxlcy5sZW5ndGgpICkgewogICAgICAgICAgdGhpcy5zaWduYWxbaV0gPSB0aGlzLnNhbXBsZXNbdGhpcy5wbGF5aGVhZF0gKiB0aGlzLmFtcGxpdHVkZTsKICAgICAgICB9CiAgICAgICAgYnJlYWs7CiAgICB9CiAgICB0aGlzLnNhbXBsZXNQcm9jZXNzZWQrKzsKICB9CgogIHRoaXMuZnJhbWVDb3VudCsrOwoKICByZXR1cm4gdGhpcy5zaWduYWw7Cn07CgpTYW1wbGVyLnByb3RvdHlwZS5zZXRGcmVxID0gZnVuY3Rpb24oZnJlcXVlbmN5KSB7CiAgICB2YXIgdG90YWxQcm9jZXNzZWQgPSB0aGlzLnNhbXBsZXNQcm9jZXNzZWQgKiB0aGlzLnN0ZXA7CiAgICB0aGlzLmZyZXF1ZW5jeSA9IGZyZXF1ZW5jeTsKICAgIHRoaXMuc3RlcCA9IHRoaXMuZnJlcXVlbmN5IC8gdGhpcy5yb290RnJlcXVlbmN5OwogICAgdGhpcy5zYW1wbGVzUHJvY2Vzc2VkID0gTWF0aC5yb3VuZCh0b3RhbFByb2Nlc3NlZC90aGlzLnN0ZXApOwp9OwoKU2FtcGxlci5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbigpIHsKICB0aGlzLnNhbXBsZXNQcm9jZXNzZWQgPSAwOwogIHRoaXMucGxheWhlYWQgPSAwOwp9OwoKLyoqCiAqIE9zY2lsbGF0b3IgY2xhc3MgZm9yIGdlbmVyYXRpbmcgYW5kIG1vZGlmeWluZyBzaWduYWxzCiAqCiAqIEBwYXJhbSB7TnVtYmVyfSB0eXBlICAgICAgIEEgd2F2ZWZvcm0gY29uc3RhbnQgKGVnLiBEU1AuU0lORSkKICogQHBhcmFtIHtOdW1iZXJ9IGZyZXF1ZW5jeSAgSW5pdGlhbCBmcmVxdWVuY3kgb2YgdGhlIHNpZ25hbAogKiBAcGFyYW0ge051bWJlcn0gYW1wbGl0dWRlICBJbml0aWFsIGFtcGxpdHVkZSBvZiB0aGUgc2lnbmFsCiAqIEBwYXJhbSB7TnVtYmVyfSBidWZmZXJTaXplIFNpemUgb2YgdGhlIHNhbXBsZSBidWZmZXIgdG8gZ2VuZXJhdGUKICogQHBhcmFtIHtOdW1iZXJ9IHNhbXBsZVJhdGUgVGhlIHNhbXBsZSByYXRlIG9mIHRoZSBzaWduYWwKICoKICogQGNvbnRydWN0b3IKICovCmZ1bmN0aW9uIE9zY2lsbGF0b3IodHlwZSwgZnJlcXVlbmN5LCBhbXBsaXR1ZGUsIGJ1ZmZlclNpemUsIHNhbXBsZVJhdGUpIHsKICB0aGlzLmZyZXF1ZW5jeSAgPSBmcmVxdWVuY3k7CiAgdGhpcy5hbXBsaXR1ZGUgID0gYW1wbGl0dWRlOwogIHRoaXMuYnVmZmVyU2l6ZSA9IGJ1ZmZlclNpemU7CiAgdGhpcy5zYW1wbGVSYXRlID0gc2FtcGxlUmF0ZTsKICAvL3RoaXMucHVsc2VXaWR0aCA9IHB1bHNlV2lkdGg7CiAgdGhpcy5mcmFtZUNvdW50ID0gMDsKIAogIHRoaXMud2F2ZVRhYmxlTGVuZ3RoID0gMjA0ODsKCiAgdGhpcy5jeWNsZXNQZXJTYW1wbGUgPSBmcmVxdWVuY3kgLyBzYW1wbGVSYXRlOwoKICB0aGlzLnNpZ25hbCA9IG5ldyBGbG9hdDY0QXJyYXkoYnVmZmVyU2l6ZSk7CiAgdGhpcy5lbnZlbG9wZSA9IG51bGw7CgogIHN3aXRjaChwYXJzZUludCh0eXBlLCAxMCkpIHsKICAgIGNhc2UgRFNQLlRSSUFOR0xFOgogICAgICB0aGlzLmZ1bmMgPSBPc2NpbGxhdG9yLlRyaWFuZ2xlOwogICAgICBicmVhazsKCiAgICBjYXNlIERTUC5TQVc6CiAgICAgIHRoaXMuZnVuYyA9IE9zY2lsbGF0b3IuU2F3OwogICAgICBicmVhazsKCiAgICBjYXNlIERTUC5TUVVBUkU6CiAgICAgIHRoaXMuZnVuYyA9IE9zY2lsbGF0b3IuU3F1YXJlOwogICAgICBicmVhazsKCiAgICBkZWZhdWx0OgogICAgY2FzZSBEU1AuU0lORToKICAgICAgdGhpcy5mdW5jID0gT3NjaWxsYXRvci5TaW5lOwogICAgICBicmVhazsKICB9CgogIHRoaXMuZ2VuZXJhdGVXYXZlVGFibGUgPSBmdW5jdGlvbigpIHsKICAgIE9zY2lsbGF0b3Iud2F2ZVRhYmxlW3RoaXMuZnVuY10gPSBuZXcgRmxvYXQ2NEFycmF5KDIwNDgpOwogICAgdmFyIHdhdmVUYWJsZVRpbWUgPSB0aGlzLndhdmVUYWJsZUxlbmd0aCAvIHRoaXMuc2FtcGxlUmF0ZTsKICAgIHZhciB3YXZlVGFibGVIeiA9IDEgLyB3YXZlVGFibGVUaW1lOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy53YXZlVGFibGVMZW5ndGg7IGkrKykgewogICAgICBPc2NpbGxhdG9yLndhdmVUYWJsZVt0aGlzLmZ1bmNdW2ldID0gdGhpcy5mdW5jKGkgKiB3YXZlVGFibGVIei90aGlzLnNhbXBsZVJhdGUpOwogICAgfQogIH07CgogIGlmICggdHlwZW9mIE9zY2lsbGF0b3Iud2F2ZVRhYmxlID09PSAndW5kZWZpbmVkJyApIHsKICAgIE9zY2lsbGF0b3Iud2F2ZVRhYmxlID0ge307CiAgfQoKICBpZiAoIHR5cGVvZiBPc2NpbGxhdG9yLndhdmVUYWJsZVt0aGlzLmZ1bmNdID09PSAndW5kZWZpbmVkJyApIHsKICAgIHRoaXMuZ2VuZXJhdGVXYXZlVGFibGUoKTsKICB9CiAKICB0aGlzLndhdmVUYWJsZSA9IE9zY2lsbGF0b3Iud2F2ZVRhYmxlW3RoaXMuZnVuY107Cn0KCi8qKgogKiBTZXQgdGhlIGFtcGxpdHVkZSBvZiB0aGUgc2lnbmFsCiAqCiAqIEBwYXJhbSB7TnVtYmVyfSBhbXBsaXR1ZGUgVGhlIGFtcGxpdHVkZSBvZiB0aGUgc2lnbmFsIChiZXR3ZWVuIDAgYW5kIDEpCiAqLwpPc2NpbGxhdG9yLnByb3RvdHlwZS5zZXRBbXAgPSBmdW5jdGlvbihhbXBsaXR1ZGUpIHsKICBpZiAoYW1wbGl0dWRlID49IDAgJiYgYW1wbGl0dWRlIDw9IDEpIHsKICAgIHRoaXMuYW1wbGl0dWRlID0gYW1wbGl0dWRlOwogIH0gZWxzZSB7CiAgICB0aHJvdyAiQW1wbGl0dWRlIG91dCBvZiByYW5nZSAoMC4uMSkuIjsKICB9Cn07CiAgCi8qKgogKiBTZXQgdGhlIGZyZXF1ZW5jeSBvZiB0aGUgc2lnbmFsCiAqCiAqIEBwYXJhbSB7TnVtYmVyfSBmcmVxdWVuY3kgVGhlIGZyZXF1ZW5jeSBvZiB0aGUgc2lnbmFsCiAqLyAgCk9zY2lsbGF0b3IucHJvdG90eXBlLnNldEZyZXEgPSBmdW5jdGlvbihmcmVxdWVuY3kpIHsKICB0aGlzLmZyZXF1ZW5jeSA9IGZyZXF1ZW5jeTsKICB0aGlzLmN5Y2xlc1BlclNhbXBsZSA9IGZyZXF1ZW5jeSAvIHRoaXMuc2FtcGxlUmF0ZTsKfTsKICAgICAKLy8gQWRkIGFuIG9zY2lsbGF0b3IKT3NjaWxsYXRvci5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24ob3NjaWxsYXRvcikgewogIGZvciAoIHZhciBpID0gMDsgaSA8IHRoaXMuYnVmZmVyU2l6ZTsgaSsrICkgewogICAgLy90aGlzLnNpZ25hbFtpXSArPSBvc2NpbGxhdG9yLnZhbHVlQXQoaSk7CiAgICB0aGlzLnNpZ25hbFtpXSArPSBvc2NpbGxhdG9yLnNpZ25hbFtpXTsKICB9CiAKICByZXR1cm4gdGhpcy5zaWduYWw7Cn07CiAgICAgCi8vIEFkZCBhIHNpZ25hbCB0byB0aGUgY3VycmVudCBnZW5lcmF0ZWQgb3NjIHNpZ25hbApPc2NpbGxhdG9yLnByb3RvdHlwZS5hZGRTaWduYWwgPSBmdW5jdGlvbihzaWduYWwpIHsKICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBzaWduYWwubGVuZ3RoOyBpKysgKSB7CiAgICBpZiAoIGkgPj0gdGhpcy5idWZmZXJTaXplICkgewogICAgICBicmVhazsKICAgIH0KICAgIHRoaXMuc2lnbmFsW2ldICs9IHNpZ25hbFtpXTsKICAgCiAgICAvKgogICAgLy8gQ29uc3RyYWluIGFtcGxpdHVkZQogICAgaWYgKCB0aGlzLnNpZ25hbFtpXSA+IDEgKSB7CiAgICAgIHRoaXMuc2lnbmFsW2ldID0gMTsKICAgIH0gZWxzZSBpZiAoIHRoaXMuc2lnbmFsW2ldIDwgLTEgKSB7CiAgICAgIHRoaXMuc2lnbmFsW2ldID0gLTE7CiAgICB9CiAgICAqLwogIH0KICByZXR1cm4gdGhpcy5zaWduYWw7Cn07CiAgICAgCi8vIEFkZCBhbiBlbnZlbG9wZSB0byB0aGUgb3NjaWxsYXRvcgpPc2NpbGxhdG9yLnByb3RvdHlwZS5hZGRFbnZlbG9wZSA9IGZ1bmN0aW9uKGVudmVsb3BlKSB7CiAgdGhpcy5lbnZlbG9wZSA9IGVudmVsb3BlOwp9OwoKT3NjaWxsYXRvci5wcm90b3R5cGUuYXBwbHlFbnZlbG9wZSA9IGZ1bmN0aW9uKCkgewogIHRoaXMuZW52ZWxvcGUucHJvY2Vzcyh0aGlzLnNpZ25hbCk7Cn07CiAgICAgCk9zY2lsbGF0b3IucHJvdG90eXBlLnZhbHVlQXQgPSBmdW5jdGlvbihvZmZzZXQpIHsKICByZXR1cm4gdGhpcy53YXZlVGFibGVbb2Zmc2V0ICUgdGhpcy53YXZlVGFibGVMZW5ndGhdOwp9OwogICAgIApPc2NpbGxhdG9yLnByb3RvdHlwZS5nZW5lcmF0ZSA9IGZ1bmN0aW9uKCkgewogIHZhciBmcmFtZU9mZnNldCA9IHRoaXMuZnJhbWVDb3VudCAqIHRoaXMuYnVmZmVyU2l6ZTsKICB2YXIgc3RlcCA9IHRoaXMud2F2ZVRhYmxlTGVuZ3RoICogdGhpcy5mcmVxdWVuY3kgLyB0aGlzLnNhbXBsZVJhdGU7CiAgdmFyIG9mZnNldDsKCiAgZm9yICggdmFyIGkgPSAwOyBpIDwgdGhpcy5idWZmZXJTaXplOyBpKysgKSB7CiAgICAvL3ZhciBzdGVwID0gKGZyYW1lT2Zmc2V0ICsgaSkgKiB0aGlzLmN5Y2xlc1BlclNhbXBsZSAlIDE7CiAgICAvL3RoaXMuc2lnbmFsW2ldID0gdGhpcy5mdW5jKHN0ZXApICogdGhpcy5hbXBsaXR1ZGU7CiAgICAvL3RoaXMuc2lnbmFsW2ldID0gdGhpcy52YWx1ZUF0KE1hdGgucm91bmQoKGZyYW1lT2Zmc2V0ICsgaSkgKiBzdGVwKSkgKiB0aGlzLmFtcGxpdHVkZTsKICAgIG9mZnNldCA9IE1hdGgucm91bmQoKGZyYW1lT2Zmc2V0ICsgaSkgKiBzdGVwKTsKICAgIHRoaXMuc2lnbmFsW2ldID0gdGhpcy53YXZlVGFibGVbb2Zmc2V0ICUgdGhpcy53YXZlVGFibGVMZW5ndGhdICogdGhpcy5hbXBsaXR1ZGU7CiAgfQoKICB0aGlzLmZyYW1lQ291bnQrKzsKCiAgcmV0dXJuIHRoaXMuc2lnbmFsOwp9OwoKT3NjaWxsYXRvci5TaW5lID0gZnVuY3Rpb24oc3RlcCkgewogIHJldHVybiBNYXRoLnNpbihEU1AuVFdPX1BJICogc3RlcCk7Cn07CgpPc2NpbGxhdG9yLlNxdWFyZSA9IGZ1bmN0aW9uKHN0ZXApIHsKICByZXR1cm4gc3RlcCA8IDAuNSA/IDEgOiAtMTsKfTsKCk9zY2lsbGF0b3IuU2F3ID0gZnVuY3Rpb24oc3RlcCkgewogIHJldHVybiAyICogKHN0ZXAgLSBNYXRoLnJvdW5kKHN0ZXApKTsKfTsKCk9zY2lsbGF0b3IuVHJpYW5nbGUgPSBmdW5jdGlvbihzdGVwKSB7CiAgcmV0dXJuIDEgLSA0ICogTWF0aC5hYnMoTWF0aC5yb3VuZChzdGVwKSAtIHN0ZXApOwp9OwoKT3NjaWxsYXRvci5QdWxzZSA9IGZ1bmN0aW9uKHN0ZXApIHsKICAvLyBzdHViCn07CiAKZnVuY3Rpb24gQURTUihhdHRhY2tMZW5ndGgsIGRlY2F5TGVuZ3RoLCBzdXN0YWluTGV2ZWwsIHN1c3RhaW5MZW5ndGgsIHJlbGVhc2VMZW5ndGgsIHNhbXBsZVJhdGUpIHsKICB0aGlzLnNhbXBsZVJhdGUgPSBzYW1wbGVSYXRlOwogIC8vIExlbmd0aCBpbiBzZWNvbmRzCiAgdGhpcy5hdHRhY2tMZW5ndGggID0gYXR0YWNrTGVuZ3RoOwogIHRoaXMuZGVjYXlMZW5ndGggICA9IGRlY2F5TGVuZ3RoOwogIHRoaXMuc3VzdGFpbkxldmVsICA9IHN1c3RhaW5MZXZlbDsKICB0aGlzLnN1c3RhaW5MZW5ndGggPSBzdXN0YWluTGVuZ3RoOwogIHRoaXMucmVsZWFzZUxlbmd0aCA9IHJlbGVhc2VMZW5ndGg7CiAgdGhpcy5zYW1wbGVSYXRlICAgID0gc2FtcGxlUmF0ZTsKIAogIC8vIExlbmd0aCBpbiBzYW1wbGVzCiAgdGhpcy5hdHRhY2tTYW1wbGVzICA9IGF0dGFja0xlbmd0aCAgKiBzYW1wbGVSYXRlOwogIHRoaXMuZGVjYXlTYW1wbGVzICAgPSBkZWNheUxlbmd0aCAgICogc2FtcGxlUmF0ZTsKICB0aGlzLnN1c3RhaW5TYW1wbGVzID0gc3VzdGFpbkxlbmd0aCAqIHNhbXBsZVJhdGU7CiAgdGhpcy5yZWxlYXNlU2FtcGxlcyA9IHJlbGVhc2VMZW5ndGggKiBzYW1wbGVSYXRlOwogCiAgLy8gVXBkYXRlcyB0aGUgZW52ZWxvcGUgc2FtcGxlIHBvc2l0aW9ucwogIHRoaXMudXBkYXRlID0gZnVuY3Rpb24oKSB7CiAgICB0aGlzLmF0dGFjayAgICAgICAgID0gICAgICAgICAgICAgICAgdGhpcy5hdHRhY2tTYW1wbGVzOwogICAgdGhpcy5kZWNheSAgICAgICAgICA9IHRoaXMuYXR0YWNrICArIHRoaXMuZGVjYXlTYW1wbGVzOwogICAgdGhpcy5zdXN0YWluICAgICAgICA9IHRoaXMuZGVjYXkgICArIHRoaXMuc3VzdGFpblNhbXBsZXM7CiAgICB0aGlzLnJlbGVhc2UgICAgICAgID0gdGhpcy5zdXN0YWluICsgdGhpcy5yZWxlYXNlU2FtcGxlczsKICB9OwogCiAgdGhpcy51cGRhdGUoKTsKIAogIHRoaXMuc2FtcGxlc1Byb2Nlc3NlZCA9IDA7Cn0KCkFEU1IucHJvdG90eXBlLm5vdGVPbiA9IGZ1bmN0aW9uKCkgewogIHRoaXMuc2FtcGxlc1Byb2Nlc3NlZCA9IDA7CiAgdGhpcy5zdXN0YWluU2FtcGxlcyA9IHRoaXMuc3VzdGFpbkxlbmd0aCAqIHRoaXMuc2FtcGxlUmF0ZTsKICB0aGlzLnVwZGF0ZSgpOwp9OwoKLy8gU2VuZCBhIG5vdGUgb2ZmIHdoZW4gdXNpbmcgYSBzdXN0YWluIG9mIGluZmluaXR5IHRvIGxldCB0aGUgZW52ZWxvcGUgZW50ZXIgdGhlIHJlbGVhc2UgcGhhc2UKQURTUi5wcm90b3R5cGUubm90ZU9mZiA9IGZ1bmN0aW9uKCkgewogIHRoaXMuc3VzdGFpblNhbXBsZXMgPSB0aGlzLnNhbXBsZXNQcm9jZXNzZWQgLSB0aGlzLmRlY2F5U2FtcGxlczsKICB0aGlzLnVwZGF0ZSgpOwp9OwoKQURTUi5wcm90b3R5cGUucHJvY2Vzc1NhbXBsZSA9IGZ1bmN0aW9uKHNhbXBsZSkgewogIHZhciBhbXBsaXR1ZGUgPSAwOwoKICBpZiAoIHRoaXMuc2FtcGxlc1Byb2Nlc3NlZCA8PSB0aGlzLmF0dGFjayApIHsKICAgIGFtcGxpdHVkZSA9IDAgKyAoMSAtIDApICogKCh0aGlzLnNhbXBsZXNQcm9jZXNzZWQgLSAwKSAvICh0aGlzLmF0dGFjayAtIDApKTsKICB9IGVsc2UgaWYgKCB0aGlzLnNhbXBsZXNQcm9jZXNzZWQgPiB0aGlzLmF0dGFjayAmJiB0aGlzLnNhbXBsZXNQcm9jZXNzZWQgPD0gdGhpcy5kZWNheSApIHsKICAgIGFtcGxpdHVkZSA9IDEgKyAodGhpcy5zdXN0YWluTGV2ZWwgLSAxKSAqICgodGhpcy5zYW1wbGVzUHJvY2Vzc2VkIC0gdGhpcy5hdHRhY2spIC8gKHRoaXMuZGVjYXkgLSB0aGlzLmF0dGFjaykpOwogIH0gZWxzZSBpZiAoIHRoaXMuc2FtcGxlc1Byb2Nlc3NlZCA+IHRoaXMuZGVjYXkgJiYgdGhpcy5zYW1wbGVzUHJvY2Vzc2VkIDw9IHRoaXMuc3VzdGFpbiApIHsKICAgIGFtcGxpdHVkZSA9IHRoaXMuc3VzdGFpbkxldmVsOwogIH0gZWxzZSBpZiAoIHRoaXMuc2FtcGxlc1Byb2Nlc3NlZCA+IHRoaXMuc3VzdGFpbiAmJiB0aGlzLnNhbXBsZXNQcm9jZXNzZWQgPD0gdGhpcy5yZWxlYXNlICkgewogICAgYW1wbGl0dWRlID0gdGhpcy5zdXN0YWluTGV2ZWwgKyAoMCAtIHRoaXMuc3VzdGFpbkxldmVsKSAqICgodGhpcy5zYW1wbGVzUHJvY2Vzc2VkIC0gdGhpcy5zdXN0YWluKSAvICh0aGlzLnJlbGVhc2UgLSB0aGlzLnN1c3RhaW4pKTsKICB9CiAKICByZXR1cm4gc2FtcGxlICogYW1wbGl0dWRlOwp9OwoKQURTUi5wcm90b3R5cGUudmFsdWUgPSBmdW5jdGlvbigpIHsKICB2YXIgYW1wbGl0dWRlID0gMDsKCiAgaWYgKCB0aGlzLnNhbXBsZXNQcm9jZXNzZWQgPD0gdGhpcy5hdHRhY2sgKSB7CiAgICBhbXBsaXR1ZGUgPSAwICsgKDEgLSAwKSAqICgodGhpcy5zYW1wbGVzUHJvY2Vzc2VkIC0gMCkgLyAodGhpcy5hdHRhY2sgLSAwKSk7CiAgfSBlbHNlIGlmICggdGhpcy5zYW1wbGVzUHJvY2Vzc2VkID4gdGhpcy5hdHRhY2sgJiYgdGhpcy5zYW1wbGVzUHJvY2Vzc2VkIDw9IHRoaXMuZGVjYXkgKSB7CiAgICBhbXBsaXR1ZGUgPSAxICsgKHRoaXMuc3VzdGFpbkxldmVsIC0gMSkgKiAoKHRoaXMuc2FtcGxlc1Byb2Nlc3NlZCAtIHRoaXMuYXR0YWNrKSAvICh0aGlzLmRlY2F5IC0gdGhpcy5hdHRhY2spKTsKICB9IGVsc2UgaWYgKCB0aGlzLnNhbXBsZXNQcm9jZXNzZWQgPiB0aGlzLmRlY2F5ICYmIHRoaXMuc2FtcGxlc1Byb2Nlc3NlZCA8PSB0aGlzLnN1c3RhaW4gKSB7CiAgICBhbXBsaXR1ZGUgPSB0aGlzLnN1c3RhaW5MZXZlbDsKICB9IGVsc2UgaWYgKCB0aGlzLnNhbXBsZXNQcm9jZXNzZWQgPiB0aGlzLnN1c3RhaW4gJiYgdGhpcy5zYW1wbGVzUHJvY2Vzc2VkIDw9IHRoaXMucmVsZWFzZSApIHsKICAgIGFtcGxpdHVkZSA9IHRoaXMuc3VzdGFpbkxldmVsICsgKDAgLSB0aGlzLnN1c3RhaW5MZXZlbCkgKiAoKHRoaXMuc2FtcGxlc1Byb2Nlc3NlZCAtIHRoaXMuc3VzdGFpbikgLyAodGhpcy5yZWxlYXNlIC0gdGhpcy5zdXN0YWluKSk7CiAgfQogCiAgcmV0dXJuIGFtcGxpdHVkZTsKfTsKICAgICAKQURTUi5wcm90b3R5cGUucHJvY2VzcyA9IGZ1bmN0aW9uKGJ1ZmZlcikgewogIGZvciAoIHZhciBpID0gMDsgaSA8IGJ1ZmZlci5sZW5ndGg7IGkrKyApIHsKICAgIGJ1ZmZlcltpXSAqPSB0aGlzLnZhbHVlKCk7CgogICAgdGhpcy5zYW1wbGVzUHJvY2Vzc2VkKys7CiAgfQogCiAgcmV0dXJuIGJ1ZmZlcjsKfTsKICAgICAKICAgICAKQURTUi5wcm90b3R5cGUuaXNBY3RpdmUgPSBmdW5jdGlvbigpIHsKICBpZiAoIHRoaXMuc2FtcGxlc1Byb2Nlc3NlZCA+IHRoaXMucmVsZWFzZSB8fCB0aGlzLnNhbXBsZXNQcm9jZXNzZWQgPT09IC0xICkgewogICAgcmV0dXJuIGZhbHNlOwogIH0gZWxzZSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn07CgpBRFNSLnByb3RvdHlwZS5kaXNhYmxlID0gZnVuY3Rpb24oKSB7CiAgdGhpcy5zYW1wbGVzUHJvY2Vzc2VkID0gLTE7Cn07CiAKZnVuY3Rpb24gSUlSRmlsdGVyKHR5cGUsIGN1dG9mZiwgcmVzb25hbmNlLCBzYW1wbGVSYXRlKSB7CiAgdGhpcy5zYW1wbGVSYXRlID0gc2FtcGxlUmF0ZTsKCiAgc3dpdGNoKHR5cGUpIHsKICAgIGNhc2UgRFNQLkxPV1BBU1M6CiAgICBjYXNlIERTUC5MUDEyOgogICAgICB0aGlzLmZ1bmMgPSBuZXcgSUlSRmlsdGVyLkxQMTIoY3V0b2ZmLCByZXNvbmFuY2UsIHNhbXBsZVJhdGUpOwogICAgICBicmVhazsKICB9Cn0KCklJUkZpbHRlci5wcm90b3R5cGUuX19kZWZpbmVHZXR0ZXJfXygnY3V0b2ZmJywKICBmdW5jdGlvbigpIHsKICAgIHJldHVybiB0aGlzLmZ1bmMuY3V0b2ZmOwogIH0KKTsKCklJUkZpbHRlci5wcm90b3R5cGUuX19kZWZpbmVHZXR0ZXJfXygncmVzb25hbmNlJywKICBmdW5jdGlvbigpIHsKICAgIHJldHVybiB0aGlzLmZ1bmMucmVzb25hbmNlOwogIH0KKTsKCklJUkZpbHRlci5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24oY3V0b2ZmLCByZXNvbmFuY2UpIHsKICB0aGlzLmZ1bmMuY2FsY0NvZWZmKGN1dG9mZiwgcmVzb25hbmNlKTsKfTsKCklJUkZpbHRlci5wcm90b3R5cGUucHJvY2VzcyA9IGZ1bmN0aW9uKGJ1ZmZlcikgewogIHRoaXMuZnVuYy5wcm9jZXNzKGJ1ZmZlcik7Cn07CgovLyBBZGQgYW4gZW52ZWxvcGUgdG8gdGhlIGZpbHRlcgpJSVJGaWx0ZXIucHJvdG90eXBlLmFkZEVudmVsb3BlID0gZnVuY3Rpb24oZW52ZWxvcGUpIHsKICBpZiAoIGVudmVsb3BlIGluc3RhbmNlb2YgQURTUiApIHsKICAgIHRoaXMuZnVuYy5hZGRFbnZlbG9wZShlbnZlbG9wZSk7CiAgfSBlbHNlIHsKICAgIHRocm93ICJOb3QgYW4gZW52ZWxvcGUuIjsKICB9Cn07CgpJSVJGaWx0ZXIuTFAxMiA9IGZ1bmN0aW9uKGN1dG9mZiwgcmVzb25hbmNlLCBzYW1wbGVSYXRlKSB7CiAgdGhpcy5zYW1wbGVSYXRlID0gc2FtcGxlUmF0ZTsKICB0aGlzLnZpYnJhUG9zICAgPSAwOwogIHRoaXMudmlicmFTcGVlZCA9IDA7CiAgdGhpcy5lbnZlbG9wZSA9IGZhbHNlOwogCiAgdGhpcy5jYWxjQ29lZmYgPSBmdW5jdGlvbihjdXRvZmYsIHJlc29uYW5jZSkgewogICAgdGhpcy53ID0gMi4wICogTWF0aC5QSSAqIGN1dG9mZiAvIHRoaXMuc2FtcGxlUmF0ZTsKICAgIHRoaXMucSA9IDEuMCAtIHRoaXMudyAvICgyLjAgKiAocmVzb25hbmNlICsgMC41IC8gKDEuMCArIHRoaXMudykpICsgdGhpcy53IC0gMi4wKTsKICAgIHRoaXMuciA9IHRoaXMucSAqIHRoaXMucTsKICAgIHRoaXMuYyA9IHRoaXMuciArIDEuMCAtIDIuMCAqIE1hdGguY29zKHRoaXMudykgKiB0aGlzLnE7CiAgIAogICAgdGhpcy5jdXRvZmYgPSBjdXRvZmY7CiAgICB0aGlzLnJlc29uYW5jZSA9IHJlc29uYW5jZTsKICB9OwoKICB0aGlzLmNhbGNDb2VmZihjdXRvZmYsIHJlc29uYW5jZSk7CgogIHRoaXMucHJvY2VzcyA9IGZ1bmN0aW9uKGJ1ZmZlcikgewogICAgZm9yICggdmFyIGkgPSAwOyBpIDwgYnVmZmVyLmxlbmd0aDsgaSsrICkgewogICAgICB0aGlzLnZpYnJhU3BlZWQgKz0gKGJ1ZmZlcltpXSAtIHRoaXMudmlicmFQb3MpICogdGhpcy5jOwogICAgICB0aGlzLnZpYnJhUG9zICAgKz0gdGhpcy52aWJyYVNwZWVkOwogICAgICB0aGlzLnZpYnJhU3BlZWQgKj0gdGhpcy5yOwogICAKICAgICAgLyoKICAgICAgdmFyIHRlbXAgPSB0aGlzLnZpYnJhUG9zOwogICAgIAogICAgICBpZiAoIHRlbXAgPiAxLjAgKSB7CiAgICAgICAgdGVtcCA9IDEuMDsKICAgICAgfSBlbHNlIGlmICggdGVtcCA8IC0xLjAgKSB7CiAgICAgICAgdGVtcCA9IC0xLjA7CiAgICAgIH0gZWxzZSBpZiAoIHRlbXAgIT0gdGVtcCApIHsKICAgICAgICB0ZW1wID0gMTsKICAgICAgfQogICAgIAogICAgICBidWZmZXJbaV0gPSB0ZW1wOwogICAgICAqLwoKICAgICAgaWYgKHRoaXMuZW52ZWxvcGUpIHsKICAgICAgICBidWZmZXJbaV0gPSAoYnVmZmVyW2ldICogKDEgLSB0aGlzLmVudmVsb3BlLnZhbHVlKCkpKSArICh0aGlzLnZpYnJhUG9zICogdGhpcy5lbnZlbG9wZS52YWx1ZSgpKTsKICAgICAgICB0aGlzLmVudmVsb3BlLnNhbXBsZXNQcm9jZXNzZWQrKzsKICAgICAgfSBlbHNlIHsKICAgICAgICBidWZmZXJbaV0gPSB0aGlzLnZpYnJhUG9zOwogICAgICB9CiAgICB9CiAgfTsKfTsgCgpJSVJGaWx0ZXIuTFAxMi5wcm90b3R5cGUuYWRkRW52ZWxvcGUgPSBmdW5jdGlvbihlbnZlbG9wZSkgewogIHRoaXMuZW52ZWxvcGUgPSBlbnZlbG9wZTsKfTsKCmZ1bmN0aW9uIElJUkZpbHRlcjIodHlwZSwgY3V0b2ZmLCByZXNvbmFuY2UsIHNhbXBsZVJhdGUpIHsKICB0aGlzLnR5cGUgPSB0eXBlOwogIHRoaXMuY3V0b2ZmID0gY3V0b2ZmOwogIHRoaXMucmVzb25hbmNlID0gcmVzb25hbmNlOwogIHRoaXMuc2FtcGxlUmF0ZSA9IHNhbXBsZVJhdGU7CgogIHRoaXMuZiA9IEZsb2F0NjRBcnJheSg0KTsKICB0aGlzLmZbMF0gPSAwLjA7IC8vIGxwCiAgdGhpcy5mWzFdID0gMC4wOyAvLyBocAogIHRoaXMuZlsyXSA9IDAuMDsgLy8gYnAKICB0aGlzLmZbM10gPSAwLjA7IC8vIGJyIAogCiAgdGhpcy5jYWxjQ29lZmYgPSBmdW5jdGlvbihjdXRvZmYsIHJlc29uYW5jZSkgewogICAgdGhpcy5mcmVxID0gMiAqIE1hdGguc2luKE1hdGguUEkgKiBNYXRoLm1pbigwLjI1LCBjdXRvZmYvKHRoaXMuc2FtcGxlUmF0ZSoyKSkpOyAgCiAgICB0aGlzLmRhbXAgPSBNYXRoLm1pbigyICogKDEgLSBNYXRoLnBvdyhyZXNvbmFuY2UsIDAuMjUpKSwgTWF0aC5taW4oMiwgMi90aGlzLmZyZXEgLSB0aGlzLmZyZXEgKiAwLjUpKTsKICB9OwoKICB0aGlzLmNhbGNDb2VmZihjdXRvZmYsIHJlc29uYW5jZSk7Cn0KCklJUkZpbHRlcjIucHJvdG90eXBlLnByb2Nlc3MgPSBmdW5jdGlvbihidWZmZXIpIHsKICB2YXIgaW5wdXQsIG91dHB1dDsKICB2YXIgZiA9IHRoaXMuZjsKCiAgZm9yICggdmFyIGkgPSAwOyBpIDwgYnVmZmVyLmxlbmd0aDsgaSsrICkgewogICAgaW5wdXQgPSBidWZmZXJbaV07CgogICAgLy8gZmlyc3QgcGFzcwogICAgZlszXSA9IGlucHV0IC0gdGhpcy5kYW1wICogZlsyXTsKICAgIGZbMF0gPSBmWzBdICsgdGhpcy5mcmVxICogZlsyXTsKICAgIGZbMV0gPSBmWzNdIC0gZlswXTsKICAgIGZbMl0gPSB0aGlzLmZyZXEgKiBmWzFdICsgZlsyXTsKICAgIG91dHB1dCA9IDAuNSAqIGZbdGhpcy50eXBlXTsKCiAgICAvLyBzZWNvbmQgcGFzcwogICAgZlszXSA9IGlucHV0IC0gdGhpcy5kYW1wICogZlsyXTsKICAgIGZbMF0gPSBmWzBdICsgdGhpcy5mcmVxICogZlsyXTsKICAgIGZbMV0gPSBmWzNdIC0gZlswXTsKICAgIGZbMl0gPSB0aGlzLmZyZXEgKiBmWzFdICsgZlsyXTsKICAgIG91dHB1dCArPSAwLjUgKiBmW3RoaXMudHlwZV07CgogICAgaWYgKHRoaXMuZW52ZWxvcGUpIHsKICAgICAgYnVmZmVyW2ldID0gKGJ1ZmZlcltpXSAqICgxIC0gdGhpcy5lbnZlbG9wZS52YWx1ZSgpKSkgKyAob3V0cHV0ICogdGhpcy5lbnZlbG9wZS52YWx1ZSgpKTsKICAgICAgdGhpcy5lbnZlbG9wZS5zYW1wbGVzUHJvY2Vzc2VkKys7CiAgICB9IGVsc2UgewogICAgICBidWZmZXJbaV0gPSBvdXRwdXQ7CiAgICB9CiAgfQp9OwoKSUlSRmlsdGVyMi5wcm90b3R5cGUuYWRkRW52ZWxvcGUgPSBmdW5jdGlvbihlbnZlbG9wZSkgewogIGlmICggZW52ZWxvcGUgaW5zdGFuY2VvZiBBRFNSICkgewogICAgdGhpcy5lbnZlbG9wZSA9IGVudmVsb3BlOwogIH0gZWxzZSB7CiAgICB0aHJvdyAiVGhpcyBpcyBub3QgYW4gZW52ZWxvcGUuIjsKICB9Cn07CgpJSVJGaWx0ZXIyLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbihjdXRvZmYsIHJlc29uYW5jZSkgewogIHRoaXMuY2FsY0NvZWZmKGN1dG9mZiwgcmVzb25hbmNlKTsKfTsKCgoKZnVuY3Rpb24gV2luZG93RnVuY3Rpb24odHlwZSwgYWxwaGEpIHsKICB0aGlzLmFscGhhID0gYWxwaGE7CiAKICBzd2l0Y2godHlwZSkgewogICAgY2FzZSBEU1AuQkFSVExFVFQ6CiAgICAgIHRoaXMuZnVuYyA9IFdpbmRvd0Z1bmN0aW9uLkJhcnRsZXR0OwogICAgICBicmVhazsKICAgICAKICAgIGNhc2UgRFNQLkJBUlRMRVRUSEFOTjoKICAgICAgdGhpcy5mdW5jID0gV2luZG93RnVuY3Rpb24uQmFydGxldHRIYW5uOwogICAgICBicmVhazsKICAgICAKICAgIGNhc2UgRFNQLkJMQUNLTUFOOgogICAgICB0aGlzLmZ1bmMgPSBXaW5kb3dGdW5jdGlvbi5CbGFja21hbjsKICAgICAgdGhpcy5hbHBoYSA9IHRoaXMuYWxwaGEgfHwgMC4xNjsKICAgICAgYnJlYWs7CiAgIAogICAgY2FzZSBEU1AuQ09TSU5FOgogICAgICB0aGlzLmZ1bmMgPSBXaW5kb3dGdW5jdGlvbi5Db3NpbmU7CiAgICAgIGJyZWFrOwogICAgIAogICAgY2FzZSBEU1AuR0FVU1M6CiAgICAgIHRoaXMuZnVuYyA9IFdpbmRvd0Z1bmN0aW9uLkdhdXNzOwogICAgICB0aGlzLmFscGhhID0gdGhpcy5hbHBoYSB8fCAwLjI1OwogICAgICBicmVhazsKICAgICAKICAgIGNhc2UgRFNQLkhBTU1JTkc6CiAgICAgIHRoaXMuZnVuYyA9IFdpbmRvd0Z1bmN0aW9uLkhhbW1pbmc7CiAgICAgIGJyZWFrOwogICAgIAogICAgY2FzZSBEU1AuSEFOTjoKICAgICAgdGhpcy5mdW5jID0gV2luZG93RnVuY3Rpb24uSGFubjsKICAgICAgYnJlYWs7CiAgIAogICAgY2FzZSBEU1AuTEFOQ1pPUzoKICAgICAgdGhpcy5mdW5jID0gV2luZG93RnVuY3Rpb24uTGFuY3pvejsKICAgICAgYnJlYWs7CiAgICAgCiAgICBjYXNlIERTUC5SRUNUQU5HVUxBUjoKICAgICAgdGhpcy5mdW5jID0gV2luZG93RnVuY3Rpb24uUmVjdGFuZ3VsYXI7CiAgICAgIGJyZWFrOwogICAgIAogICAgY2FzZSBEU1AuVFJJQU5HVUxBUjoKICAgICAgdGhpcy5mdW5jID0gV2luZG93RnVuY3Rpb24uVHJpYW5ndWxhcjsKICAgICAgYnJlYWs7CiAgfQp9CgpXaW5kb3dGdW5jdGlvbi5wcm90b3R5cGUucHJvY2VzcyA9IGZ1bmN0aW9uKGJ1ZmZlcikgewogIHZhciBsZW5ndGggPSBidWZmZXIubGVuZ3RoOwogIGZvciAoIHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrICkgewogICAgYnVmZmVyW2ldICo9IHRoaXMuZnVuYyhsZW5ndGgsIGksIHRoaXMuYWxwaGEpOwogIH0KICByZXR1cm4gYnVmZmVyOwp9OwoKV2luZG93RnVuY3Rpb24uQmFydGxldHQgPSBmdW5jdGlvbihsZW5ndGgsIGluZGV4KSB7CiAgcmV0dXJuIDIgLyAobGVuZ3RoIC0gMSkgKiAoKGxlbmd0aCAtIDEpIC8gMiAtIE1hdGguYWJzKGluZGV4IC0gKGxlbmd0aCAtIDEpIC8gMikpOwp9OwoKV2luZG93RnVuY3Rpb24uQmFydGxldHRIYW5uID0gZnVuY3Rpb24obGVuZ3RoLCBpbmRleCkgewogIHJldHVybiAwLjYyIC0gMC40OCAqIE1hdGguYWJzKGluZGV4IC8gKGxlbmd0aCAtIDEpIC0gMC41KSAtIDAuMzggKiBNYXRoLmNvcyhEU1AuVFdPX1BJICogaW5kZXggLyAobGVuZ3RoIC0gMSkpOwp9OwoKV2luZG93RnVuY3Rpb24uQmxhY2ttYW4gPSBmdW5jdGlvbihsZW5ndGgsIGluZGV4LCBhbHBoYSkgewogIHZhciBhMCA9ICgxIC0gYWxwaGEpIC8gMjsKICB2YXIgYTEgPSAwLjU7CiAgdmFyIGEyID0gYWxwaGEgLyAyOwoKICByZXR1cm4gYTAgLSBhMSAqIE1hdGguY29zKERTUC5UV09fUEkgKiBpbmRleCAvIChsZW5ndGggLSAxKSkgKyBhMiAqIE1hdGguY29zKDQgKiBNYXRoLlBJICogaW5kZXggLyAobGVuZ3RoIC0gMSkpOwp9OwoKV2luZG93RnVuY3Rpb24uQ29zaW5lID0gZnVuY3Rpb24obGVuZ3RoLCBpbmRleCkgewogIHJldHVybiBNYXRoLmNvcyhNYXRoLlBJICogaW5kZXggLyAobGVuZ3RoIC0gMSkgLSBNYXRoLlBJIC8gMik7Cn07CgpXaW5kb3dGdW5jdGlvbi5HYXVzcyA9IGZ1bmN0aW9uKGxlbmd0aCwgaW5kZXgsIGFscGhhKSB7CiAgcmV0dXJuIE1hdGgucG93KE1hdGguRSwgLTAuNSAqIE1hdGgucG93KChpbmRleCAtIChsZW5ndGggLSAxKSAvIDIpIC8gKGFscGhhICogKGxlbmd0aCAtIDEpIC8gMiksIDIpKTsKfTsKCldpbmRvd0Z1bmN0aW9uLkhhbW1pbmcgPSBmdW5jdGlvbihsZW5ndGgsIGluZGV4KSB7CiAgcmV0dXJuIDAuNTQgLSAwLjQ2ICogTWF0aC5jb3MoRFNQLlRXT19QSSAqIGluZGV4IC8gKGxlbmd0aCAtIDEpKTsKfTsKCldpbmRvd0Z1bmN0aW9uLkhhbm4gPSBmdW5jdGlvbihsZW5ndGgsIGluZGV4KSB7CiAgcmV0dXJuIDAuNSAqICgxIC0gTWF0aC5jb3MoRFNQLlRXT19QSSAqIGluZGV4IC8gKGxlbmd0aCAtIDEpKSk7Cn07CgpXaW5kb3dGdW5jdGlvbi5MYW5jem9zID0gZnVuY3Rpb24obGVuZ3RoLCBpbmRleCkgewogIHZhciB4ID0gMiAqIGluZGV4IC8gKGxlbmd0aCAtIDEpIC0gMTsKICByZXR1cm4gTWF0aC5zaW4oTWF0aC5QSSAqIHgpIC8gKE1hdGguUEkgKiB4KTsKfTsKCldpbmRvd0Z1bmN0aW9uLlJlY3Rhbmd1bGFyID0gZnVuY3Rpb24obGVuZ3RoLCBpbmRleCkgewogIHJldHVybiAxOwp9OwoKV2luZG93RnVuY3Rpb24uVHJpYW5ndWxhciA9IGZ1bmN0aW9uKGxlbmd0aCwgaW5kZXgpIHsKICByZXR1cm4gMiAvIGxlbmd0aCAqIChsZW5ndGggLyAyIC0gTWF0aC5hYnMoaW5kZXggLSAobGVuZ3RoIC0gMSkgLyAyKSk7Cn07CgpmdW5jdGlvbiBzaW5oIChhcmcpIHsKICAvLyBSZXR1cm5zIHRoZSBoeXBlcmJvbGljIHNpbmUgb2YgdGhlIG51bWJlciwgZGVmaW5lZCBhcyAoZXhwKG51bWJlcikgLSBleHAoLW51bWJlcikpLzIgCiAgLy8KICAvLyB2ZXJzaW9uOiAxMDA0LjIzMTQKICAvLyBkaXNjdXNzIGF0OiBodHRwOi8vcGhwanMub3JnL2Z1bmN0aW9ucy9zaW5oICAgIC8vICsgICBvcmlnaW5hbCBieTogT25ubyBNYXJzbWFuCiAgLy8gKiAgICAgZXhhbXBsZSAxOiBzaW5oKC0wLjk4MzQzMzAzNDg4MjU5MDkpOwogIC8vICogICAgIHJldHVybnMgMTogLTEuMTQ5Nzk3MTQwMjYzNjUwMgogIHJldHVybiAoTWF0aC5leHAoYXJnKSAtIE1hdGguZXhwKC1hcmcpKS8yOwp9CgovKiAKICogIEJpcXVhZCBmaWx0ZXIKICogCiAqICBDcmVhdGVkIGJ5IFJpY2FyZCBNYXJ4ZXIgPGVtYWlsQHJpY2FyZG1hcnhlci5jb20+IG9uIDIwMTAtMDUtMjMuCiAqICBDb3B5cmlnaHQgMjAxMCBSaWNhcmQgTWFyeGVyLiBBbGwgcmlnaHRzIHJlc2VydmVkLgogKgogKi8KLy8gSW1wbGVtZW50YXRpb24gYmFzZWQgb246Ci8vIGh0dHA6Ly93d3cubXVzaWNkc3Aub3JnL2ZpbGVzL0F1ZGlvLUVRLUNvb2tib29rLnR4dApmdW5jdGlvbiBCaXF1YWQodHlwZSwgc2FtcGxlUmF0ZSkgewogIHRoaXMuRnMgPSBzYW1wbGVSYXRlOwogIHRoaXMudHlwZSA9IHR5cGU7ICAvLyB0eXBlIG9mIHRoZSBmaWx0ZXIKICB0aGlzLnBhcmFtZXRlclR5cGUgPSBEU1AuUTsgLy8gdHlwZSBvZiB0aGUgcGFyYW1ldGVyCgogIHRoaXMueF8xX2wgPSAwOwogIHRoaXMueF8yX2wgPSAwOwogIHRoaXMueV8xX2wgPSAwOwogIHRoaXMueV8yX2wgPSAwOwoKICB0aGlzLnhfMV9yID0gMDsKICB0aGlzLnhfMl9yID0gMDsKICB0aGlzLnlfMV9yID0gMDsKICB0aGlzLnlfMl9yID0gMDsKCiAgdGhpcy5iMCA9IDE7CiAgdGhpcy5hMCA9IDE7CgogIHRoaXMuYjEgPSAwOwogIHRoaXMuYTEgPSAwOwoKICB0aGlzLmIyID0gMDsKICB0aGlzLmEyID0gMDsKCiAgdGhpcy5iMGEwID0gdGhpcy5iMCAvIHRoaXMuYTA7CiAgdGhpcy5iMWEwID0gdGhpcy5iMSAvIHRoaXMuYTA7CiAgdGhpcy5iMmEwID0gdGhpcy5iMiAvIHRoaXMuYTA7CiAgdGhpcy5hMWEwID0gdGhpcy5hMSAvIHRoaXMuYTA7CiAgdGhpcy5hMmEwID0gdGhpcy5hMiAvIHRoaXMuYTA7CgogIHRoaXMuZjAgPSAzMDAwOyAgIC8vICJ3aGVyZXZlciBpdCdzIGhhcHBlbmluJywgbWFuLiIgIENlbnRlciBGcmVxdWVuY3kgb3IKICAgICAgICAgICAgICAgICAgICAvLyBDb3JuZXIgRnJlcXVlbmN5LCBvciBzaGVsZiBtaWRwb2ludCBmcmVxdWVuY3ksIGRlcGVuZGluZwogICAgICAgICAgICAgICAgICAgIC8vIG9uIHdoaWNoIGZpbHRlciB0eXBlLiAgVGhlICJzaWduaWZpY2FudCBmcmVxdWVuY3kiLgoKICB0aGlzLmRCZ2FpbiA9IDEyOyAvLyB1c2VkIG9ubHkgZm9yIHBlYWtpbmcgYW5kIHNoZWx2aW5nIGZpbHRlcnMKCiAgdGhpcy5RID0gMTsgICAgICAgLy8gdGhlIEVFIGtpbmQgb2YgZGVmaW5pdGlvbiwgZXhjZXB0IGZvciBwZWFraW5nRVEgaW4gd2hpY2ggQSpRIGlzCiAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGNsYXNzaWMgRUUgUS4gIFRoYXQgYWRqdXN0bWVudCBpbiBkZWZpbml0aW9uIHdhcyBtYWRlIHNvIHRoYXQKICAgICAgICAgICAgICAgICAgICAvLyBhIGJvb3N0IG9mIE4gZEIgZm9sbG93ZWQgYnkgYSBjdXQgb2YgTiBkQiBmb3IgaWRlbnRpY2FsIFEgYW5kCiAgICAgICAgICAgICAgICAgICAgLy8gZjAvRnMgcmVzdWx0cyBpbiBhIHByZWNpc2VseSBmbGF0IHVuaXR5IGdhaW4gZmlsdGVyIG9yICJ3aXJlIi4KCiAgdGhpcy5CVyA9IC0zOyAgICAgLy8gdGhlIGJhbmR3aWR0aCBpbiBvY3RhdmVzIChiZXR3ZWVuIC0zIGRCIGZyZXF1ZW5jaWVzIGZvciBCUEYKICAgICAgICAgICAgICAgICAgICAvLyBhbmQgbm90Y2ggb3IgYmV0d2VlbiBtaWRwb2ludCAoZEJnYWluLzIpIGdhaW4gZnJlcXVlbmNpZXMgZm9yCiAgICAgICAgICAgICAgICAgICAgLy8gcGVha2luZyBFUQoKICB0aGlzLlMgPSAxOyAgICAgICAvLyBhICJzaGVsZiBzbG9wZSIgcGFyYW1ldGVyIChmb3Igc2hlbHZpbmcgRVEgb25seSkuICBXaGVuIFMgPSAxLAogICAgICAgICAgICAgICAgICAgIC8vIHRoZSBzaGVsZiBzbG9wZSBpcyBhcyBzdGVlcCBhcyBpdCBjYW4gYmUgYW5kIHJlbWFpbiBtb25vdG9uaWNhbGx5CiAgICAgICAgICAgICAgICAgICAgLy8gaW5jcmVhc2luZyBvciBkZWNyZWFzaW5nIGdhaW4gd2l0aCBmcmVxdWVuY3kuICBUaGUgc2hlbGYgc2xvcGUsIGluCiAgICAgICAgICAgICAgICAgICAgLy8gZEIvb2N0YXZlLCByZW1haW5zIHByb3BvcnRpb25hbCB0byBTIGZvciBhbGwgb3RoZXIgdmFsdWVzIGZvciBhCiAgICAgICAgICAgICAgICAgICAgLy8gZml4ZWQgZjAvRnMgYW5kIGRCZ2Fpbi4KCiAgdGhpcy5jb2VmZmljaWVudHMgPSBmdW5jdGlvbigpIHsKICAgIHZhciBiID0gW3RoaXMuYjAsIHRoaXMuYjEsIHRoaXMuYjJdOwogICAgdmFyIGEgPSBbdGhpcy5hMCwgdGhpcy5hMSwgdGhpcy5hMl07CiAgICByZXR1cm4ge2I6IGIsIGE6YX07CiAgfTsKCiAgdGhpcy5zZXRGaWx0ZXJUeXBlID0gZnVuY3Rpb24odHlwZSkgewogICAgdGhpcy50eXBlID0gdHlwZTsKICAgIHRoaXMucmVjYWxjdWxhdGVDb2VmZmljaWVudHMoKTsKICB9OwoKICB0aGlzLnNldFNhbXBsZVJhdGUgPSBmdW5jdGlvbihyYXRlKSB7CiAgICB0aGlzLkZzID0gcmF0ZTsKICAgIHRoaXMucmVjYWxjdWxhdGVDb2VmZmljaWVudHMoKTsKICB9OwoKICB0aGlzLnNldFEgPSBmdW5jdGlvbihxKSB7CiAgICB0aGlzLnBhcmFtZXRlclR5cGUgPSBEU1AuUTsKICAgIHRoaXMuUSA9IE1hdGgubWF4KE1hdGgubWluKHEsIDExNS4wKSwgMC4wMDEpOwogICAgdGhpcy5yZWNhbGN1bGF0ZUNvZWZmaWNpZW50cygpOwogIH07CgogIHRoaXMuc2V0QlcgPSBmdW5jdGlvbihidykgewogICAgdGhpcy5wYXJhbWV0ZXJUeXBlID0gRFNQLkJXOwogICAgdGhpcy5CVyA9IGJ3OwogICAgdGhpcy5yZWNhbGN1bGF0ZUNvZWZmaWNpZW50cygpOwogIH07CgogIHRoaXMuc2V0UyA9IGZ1bmN0aW9uKHMpIHsKICAgIHRoaXMucGFyYW1ldGVyVHlwZSA9IERTUC5TOwogICAgdGhpcy5TID0gTWF0aC5tYXgoTWF0aC5taW4ocywgNS4wKSwgMC4wMDAxKTsKICAgIHRoaXMucmVjYWxjdWxhdGVDb2VmZmljaWVudHMoKTsKICB9OwoKICB0aGlzLnNldEYwID0gZnVuY3Rpb24oZnJlcSkgewogICAgdGhpcy5mMCA9IGZyZXE7CiAgICB0aGlzLnJlY2FsY3VsYXRlQ29lZmZpY2llbnRzKCk7CiAgfTsgCiAKICB0aGlzLnNldERiR2FpbiA9IGZ1bmN0aW9uKGcpIHsKICAgIHRoaXMuZEJnYWluID0gZzsKICAgIHRoaXMucmVjYWxjdWxhdGVDb2VmZmljaWVudHMoKTsKICB9OwoKICB0aGlzLnJlY2FsY3VsYXRlQ29lZmZpY2llbnRzID0gZnVuY3Rpb24oKSB7CiAgICB2YXIgQTsKICAgIGlmICh0eXBlID09PSBEU1AuUEVBS0lOR19FUSB8fCB0eXBlID09PSBEU1AuTE9XX1NIRUxGIHx8IHR5cGUgPT09IERTUC5ISUdIX1NIRUxGICkgewogICAgICBBID0gTWF0aC5wb3coMTAsICh0aGlzLmRCZ2Fpbi80MCkpOyAgLy8gZm9yIHBlYWtpbmcgYW5kIHNoZWx2aW5nIEVRIGZpbHRlcnMgb25seQogICAgfSBlbHNlIHsKICAgICAgQSAgPSBNYXRoLnNxcnQoIE1hdGgucG93KDEwLCAodGhpcy5kQmdhaW4vMjApKSApOyAgIAogICAgfQoKICAgIHZhciB3MCA9IERTUC5UV09fUEkgKiB0aGlzLmYwIC8gdGhpcy5GczsKCiAgICB2YXIgY29zdzAgPSBNYXRoLmNvcyh3MCk7CiAgICB2YXIgc2ludzAgPSBNYXRoLnNpbih3MCk7CgogICAgdmFyIGFscGhhID0gMDsKICAgCiAgICBzd2l0Y2ggKHRoaXMucGFyYW1ldGVyVHlwZSkgewogICAgICBjYXNlIERTUC5ROgogICAgICAgIGFscGhhID0gc2ludzAvKDIqdGhpcy5RKTsKICAgICAgICBicmVhazsKICAgICAgICAgICAKICAgICAgY2FzZSBEU1AuQlc6CiAgICAgICAgYWxwaGEgPSBzaW53MCAqIHNpbmgoIE1hdGguTE4yLzIgKiB0aGlzLkJXICogdzAvc2ludzAgKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgRFNQLlM6CiAgICAgICAgYWxwaGEgPSBzaW53MC8yICogTWF0aC5zcXJ0KCAoQSArIDEvQSkqKDEvdGhpcy5TIC0gMSkgKyAyICk7CiAgICAgICAgYnJlYWs7CiAgICB9CgogICAgLyoqCiAgICAgICAgRllJOiBUaGUgcmVsYXRpb25zaGlwIGJldHdlZW4gYmFuZHdpZHRoIGFuZCBRIGlzCiAgICAgICAgICAgICAxL1EgPSAyKnNpbmgobG4oMikvMipCVyp3MC9zaW4odzApKSAgICAgKGRpZ2l0YWwgZmlsdGVyIHcgQkxUKQogICAgICAgIG9yICAgMS9RID0gMipzaW5oKGxuKDIpLzIqQlcpICAgICAgICAgICAgIChhbmFsb2cgZmlsdGVyIHByb3RvdHlwZSkKCiAgICAgICAgVGhlIHJlbGF0aW9uc2hpcCBiZXR3ZWVuIHNoZWxmIHNsb3BlIGFuZCBRIGlzCiAgICAgICAgICAgICAxL1EgPSBzcXJ0KChBICsgMS9BKSooMS9TIC0gMSkgKyAyKQogICAgKi8KCiAgICB2YXIgY29lZmY7CgogICAgc3dpdGNoICh0aGlzLnR5cGUpIHsKICAgICAgY2FzZSBEU1AuTFBGOiAgICAgICAvLyBIKHMpID0gMSAvIChzXjIgKyBzL1EgKyAxKQogICAgICAgIHRoaXMuYjAgPSAgKDEgLSBjb3N3MCkvMjsKICAgICAgICB0aGlzLmIxID0gICAxIC0gY29zdzA7CiAgICAgICAgdGhpcy5iMiA9ICAoMSAtIGNvc3cwKS8yOwogICAgICAgIHRoaXMuYTAgPSAgIDEgKyBhbHBoYTsKICAgICAgICB0aGlzLmExID0gIC0yICogY29zdzA7CiAgICAgICAgdGhpcy5hMiA9ICAgMSAtIGFscGhhOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBEU1AuSFBGOiAgICAgICAvLyBIKHMpID0gc14yIC8gKHNeMiArIHMvUSArIDEpCiAgICAgICAgdGhpcy5iMCA9ICAoMSArIGNvc3cwKS8yOwogICAgICAgIHRoaXMuYjEgPSAtKDEgKyBjb3N3MCk7CiAgICAgICAgdGhpcy5iMiA9ICAoMSArIGNvc3cwKS8yOwogICAgICAgIHRoaXMuYTAgPSAgIDEgKyBhbHBoYTsKICAgICAgICB0aGlzLmExID0gIC0yICogY29zdzA7CiAgICAgICAgdGhpcy5hMiA9ICAgMSAtIGFscGhhOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBEU1AuQlBGX0NPTlNUQU5UX1NLSVJUOiAgICAgICAvLyBIKHMpID0gcyAvIChzXjIgKyBzL1EgKyAxKSAgKGNvbnN0YW50IHNraXJ0IGdhaW4sIHBlYWsgZ2FpbiA9IFEpCiAgICAgICAgdGhpcy5iMCA9ICAgc2ludzAvMjsKICAgICAgICB0aGlzLmIxID0gICAwOwogICAgICAgIHRoaXMuYjIgPSAgLXNpbncwLzI7CiAgICAgICAgdGhpcy5hMCA9ICAgMSArIGFscGhhOwogICAgICAgIHRoaXMuYTEgPSAgLTIqY29zdzA7CiAgICAgICAgdGhpcy5hMiA9ICAgMSAtIGFscGhhOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBEU1AuQlBGX0NPTlNUQU5UX1BFQUs6ICAgICAgIC8vIEgocykgPSAocy9RKSAvIChzXjIgKyBzL1EgKyAxKSAgICAgIChjb25zdGFudCAwIGRCIHBlYWsgZ2FpbikKICAgICAgICB0aGlzLmIwID0gICBhbHBoYTsKICAgICAgICB0aGlzLmIxID0gICAwOwogICAgICAgIHRoaXMuYjIgPSAgLWFscGhhOwogICAgICAgIHRoaXMuYTAgPSAgIDEgKyBhbHBoYTsKICAgICAgICB0aGlzLmExID0gIC0yKmNvc3cwOwogICAgICAgIHRoaXMuYTIgPSAgIDEgLSBhbHBoYTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgRFNQLk5PVENIOiAgICAgLy8gSChzKSA9IChzXjIgKyAxKSAvIChzXjIgKyBzL1EgKyAxKQogICAgICAgIHRoaXMuYjAgPSAgIDE7CiAgICAgICAgdGhpcy5iMSA9ICAtMipjb3N3MDsKICAgICAgICB0aGlzLmIyID0gICAxOwogICAgICAgIHRoaXMuYTAgPSAgIDEgKyBhbHBoYTsKICAgICAgICB0aGlzLmExID0gIC0yKmNvc3cwOwogICAgICAgIHRoaXMuYTIgPSAgIDEgLSBhbHBoYTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgRFNQLkFQRjogICAgICAgLy8gSChzKSA9IChzXjIgLSBzL1EgKyAxKSAvIChzXjIgKyBzL1EgKyAxKQogICAgICAgIHRoaXMuYjAgPSAgIDEgLSBhbHBoYTsKICAgICAgICB0aGlzLmIxID0gIC0yKmNvc3cwOwogICAgICAgIHRoaXMuYjIgPSAgIDEgKyBhbHBoYTsKICAgICAgICB0aGlzLmEwID0gICAxICsgYWxwaGE7CiAgICAgICAgdGhpcy5hMSA9ICAtMipjb3N3MDsKICAgICAgICB0aGlzLmEyID0gICAxIC0gYWxwaGE7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlIERTUC5QRUFLSU5HX0VROiAgLy8gSChzKSA9IChzXjIgKyBzKihBL1EpICsgMSkgLyAoc14yICsgcy8oQSpRKSArIDEpCiAgICAgICAgdGhpcy5iMCA9ICAgMSArIGFscGhhKkE7CiAgICAgICAgdGhpcy5iMSA9ICAtMipjb3N3MDsKICAgICAgICB0aGlzLmIyID0gICAxIC0gYWxwaGEqQTsKICAgICAgICB0aGlzLmEwID0gICAxICsgYWxwaGEvQTsKICAgICAgICB0aGlzLmExID0gIC0yKmNvc3cwOwogICAgICAgIHRoaXMuYTIgPSAgIDEgLSBhbHBoYS9BOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSBEU1AuTE9XX1NIRUxGOiAgIC8vIEgocykgPSBBICogKHNeMiArIChzcXJ0KEEpL1EpKnMgKyBBKS8oQSpzXjIgKyAoc3FydChBKS9RKSpzICsgMSkKICAgICAgICBjb2VmZiA9IHNpbncwICogTWF0aC5zcXJ0KCAoQV4yICsgMSkqKDEvdGhpcy5TIC0gMSkgKyAyKkEgKTsKICAgICAgICB0aGlzLmIwID0gICAgQSooKEErMSkgLSAoQS0xKSpjb3N3MCArIGNvZWZmKTsKICAgICAgICB0aGlzLmIxID0gIDIqQSooKEEtMSkgLSAoQSsxKSpjb3N3MCk7CiAgICAgICAgdGhpcy5iMiA9ICAgIEEqKChBKzEpIC0gKEEtMSkqY29zdzAgLSBjb2VmZik7CiAgICAgICAgdGhpcy5hMCA9ICAgICAgIChBKzEpICsgKEEtMSkqY29zdzAgKyBjb2VmZjsKICAgICAgICB0aGlzLmExID0gICAtMiooKEEtMSkgKyAoQSsxKSpjb3N3MCk7CiAgICAgICAgdGhpcy5hMiA9ICAgICAgIChBKzEpICsgKEEtMSkqY29zdzAgLSBjb2VmZjsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgRFNQLkhJR0hfU0hFTEY6ICAgLy8gSChzKSA9IEEgKiAoQSpzXjIgKyAoc3FydChBKS9RKSpzICsgMSkvKHNeMiArIChzcXJ0KEEpL1EpKnMgKyBBKQogICAgICAgIGNvZWZmID0gc2ludzAgKiBNYXRoLnNxcnQoIChBXjIgKyAxKSooMS90aGlzLlMgLSAxKSArIDIqQSApOwogICAgICAgIHRoaXMuYjAgPSAgICBBKigoQSsxKSArIChBLTEpKmNvc3cwICsgY29lZmYpOwogICAgICAgIHRoaXMuYjEgPSAtMipBKigoQS0xKSArIChBKzEpKmNvc3cwKTsKICAgICAgICB0aGlzLmIyID0gICAgQSooKEErMSkgKyAoQS0xKSpjb3N3MCAtIGNvZWZmKTsKICAgICAgICB0aGlzLmEwID0gICAgICAgKEErMSkgLSAoQS0xKSpjb3N3MCArIGNvZWZmOwogICAgICAgIHRoaXMuYTEgPSAgICAyKigoQS0xKSAtIChBKzEpKmNvc3cwKTsKICAgICAgICB0aGlzLmEyID0gICAgICAgKEErMSkgLSAoQS0xKSpjb3N3MCAtIGNvZWZmOwogICAgICAgIGJyZWFrOwogICAgfQogICAKICAgIHRoaXMuYjBhMCA9IHRoaXMuYjAvdGhpcy5hMDsKICAgIHRoaXMuYjFhMCA9IHRoaXMuYjEvdGhpcy5hMDsKICAgIHRoaXMuYjJhMCA9IHRoaXMuYjIvdGhpcy5hMDsKICAgIHRoaXMuYTFhMCA9IHRoaXMuYTEvdGhpcy5hMDsKICAgIHRoaXMuYTJhMCA9IHRoaXMuYTIvdGhpcy5hMDsKICB9OwoKICB0aGlzLnByb2Nlc3MgPSBmdW5jdGlvbihidWZmZXIpIHsKICAgICAgLy95W25dID0gKGIwL2EwKSp4W25dICsgKGIxL2EwKSp4W24tMV0gKyAoYjIvYTApKnhbbi0yXQogICAgICAvLyAgICAgICAtIChhMS9hMCkqeVtuLTFdIC0gKGEyL2EwKSp5W24tMl0KCiAgICAgIHZhciBsZW4gPSBidWZmZXIubGVuZ3RoOwogICAgICB2YXIgb3V0cHV0ID0gbmV3IEZsb2F0NjRBcnJheShsZW4pOwoKICAgICAgZm9yICggdmFyIGk9MDsgaTxidWZmZXIubGVuZ3RoOyBpKysgKSB7CiAgICAgICAgb3V0cHV0W2ldID0gdGhpcy5iMGEwKmJ1ZmZlcltpXSArIHRoaXMuYjFhMCp0aGlzLnhfMV9sICsgdGhpcy5iMmEwKnRoaXMueF8yX2wgLSB0aGlzLmExYTAqdGhpcy55XzFfbCAtIHRoaXMuYTJhMCp0aGlzLnlfMl9sOwogICAgICAgIHRoaXMueV8yX2wgPSB0aGlzLnlfMV9sOwogICAgICAgIHRoaXMueV8xX2wgPSBvdXRwdXRbaV07CiAgICAgICAgdGhpcy54XzJfbCA9IHRoaXMueF8xX2w7CiAgICAgICAgdGhpcy54XzFfbCA9IGJ1ZmZlcltpXTsKICAgICAgfQoKICAgICAgcmV0dXJuIG91dHB1dDsKICB9OwoKICB0aGlzLnByb2Nlc3NTdGVyZW8gPSBmdW5jdGlvbihidWZmZXIpIHsKICAgICAgLy95W25dID0gKGIwL2EwKSp4W25dICsgKGIxL2EwKSp4W24tMV0gKyAoYjIvYTApKnhbbi0yXQogICAgICAvLyAgICAgICAtIChhMS9hMCkqeVtuLTFdIC0gKGEyL2EwKSp5W24tMl0KCiAgICAgIHZhciBsZW4gPSBidWZmZXIubGVuZ3RoOwogICAgICB2YXIgb3V0cHV0ID0gbmV3IEZsb2F0NjRBcnJheShsZW4pOwogICAgIAogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbi8yOyBpKyspIHsKICAgICAgICBvdXRwdXRbMippXSA9IHRoaXMuYjBhMCpidWZmZXJbMippXSArIHRoaXMuYjFhMCp0aGlzLnhfMV9sICsgdGhpcy5iMmEwKnRoaXMueF8yX2wgLSB0aGlzLmExYTAqdGhpcy55XzFfbCAtIHRoaXMuYTJhMCp0aGlzLnlfMl9sOwogICAgICAgIHRoaXMueV8yX2wgPSB0aGlzLnlfMV9sOwogICAgICAgIHRoaXMueV8xX2wgPSBvdXRwdXRbMippXTsKICAgICAgICB0aGlzLnhfMl9sID0gdGhpcy54XzFfbDsKICAgICAgICB0aGlzLnhfMV9sID0gYnVmZmVyWzIqaV07CgogICAgICAgIG91dHB1dFsyKmkrMV0gPSB0aGlzLmIwYTAqYnVmZmVyWzIqaSsxXSArIHRoaXMuYjFhMCp0aGlzLnhfMV9yICsgdGhpcy5iMmEwKnRoaXMueF8yX3IgLSB0aGlzLmExYTAqdGhpcy55XzFfciAtIHRoaXMuYTJhMCp0aGlzLnlfMl9yOwogICAgICAgIHRoaXMueV8yX3IgPSB0aGlzLnlfMV9yOwogICAgICAgIHRoaXMueV8xX3IgPSBvdXRwdXRbMippKzFdOwogICAgICAgIHRoaXMueF8yX3IgPSB0aGlzLnhfMV9yOwogICAgICAgIHRoaXMueF8xX3IgPSBidWZmZXJbMippKzFdOwogICAgICB9CgogICAgICByZXR1cm4gb3V0cHV0OwogIH07Cn0KCi8qIAogKiAgTWFnbml0dWRlIHRvIGRlY2liZWxzCiAqIAogKiAgQ3JlYXRlZCBieSBSaWNhcmQgTWFyeGVyIDxlbWFpbEByaWNhcmRtYXJ4ZXIuY29tPiBvbiAyMDEwLTA1LTIzLgogKiAgQ29weXJpZ2h0IDIwMTAgUmljYXJkIE1hcnhlci4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KICoKICogIEBidWZmZXIgYXJyYXkgb2YgbWFnbml0dWRlcyB0byBjb252ZXJ0IHRvIGRlY2liZWxzCiAqCiAqICBAcmV0dXJucyB0aGUgYXJyYXkgaW4gZGVjaWJlbHMKICoKICovCkRTUC5tYWcyZGIgPSBmdW5jdGlvbihidWZmZXIpIHsKICB2YXIgbWluRGIgPSAtMTIwOwogIHZhciBtaW5NYWcgPSBNYXRoLnBvdygxMC4wLCBtaW5EYiAvIDIwLjApOwoKICB2YXIgbG9nID0gTWF0aC5sb2c7CiAgdmFyIG1heCA9IE1hdGgubWF4OwogCiAgdmFyIHJlc3VsdCA9IEZsb2F0NjRBcnJheShidWZmZXIubGVuZ3RoKTsKICBmb3IgKHZhciBpPTA7IGk8YnVmZmVyLmxlbmd0aDsgaSsrKSB7CiAgICByZXN1bHRbaV0gPSAyMC4wKmxvZyhtYXgoYnVmZmVyW2ldLCBtaW5NYWcpKTsKICB9CgogIHJldHVybiByZXN1bHQ7Cn07CgovKiAKICogIEZyZXF1ZW5jeSByZXNwb25zZQogKiAKICogIENyZWF0ZWQgYnkgUmljYXJkIE1hcnhlciA8ZW1haWxAcmljYXJkbWFyeGVyLmNvbT4gb24gMjAxMC0wNS0yMy4KICogIENvcHlyaWdodCAyMDEwIFJpY2FyZCBNYXJ4ZXIuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiAqCiAqICBDYWxjdWxhdGVzIHRoZSBmcmVxdWVuY3kgcmVzcG9uc2UgYXQgdGhlIGdpdmVuIHBvaW50cy4KICoKICogIEBiIGIgY29lZmZpY2llbnRzIG9mIHRoZSBmaWx0ZXIKICogIEBhIGEgY29lZmZpY2llbnRzIG9mIHRoZSBmaWx0ZXIKICogIEB3IHcgcG9pbnRzIChub3JtYWxseSBiZXR3ZWVuIC1QSSBhbmQgUEkpIHdoZXJlIHRvIGNhbGN1bGF0ZSB0aGUgZnJlcXVlbmN5IHJlc3BvbnNlCiAqCiAqICBAcmV0dXJucyB0aGUgZnJlcXVlbmN5IHJlc3BvbnNlIGluIG1hZ25pdHVkZQogKgogKi8KRFNQLmZyZXF6ID0gZnVuY3Rpb24oYiwgYSwgdykgewogIHZhciBpLCBqOwoKICBpZiAoIXcpIHsKICAgIHcgPSBGbG9hdDY0QXJyYXkoMjAwKTsKICAgIGZvciAoaT0wO2k8dy5sZW5ndGg7IGkrKykgewogICAgICB3W2ldID0gRFNQLlRXT19QSS93Lmxlbmd0aCAqIGkgLSBNYXRoLlBJOwogICAgfQogIH0KCiAgdmFyIHJlc3VsdCA9IEZsb2F0NjRBcnJheSh3Lmxlbmd0aCk7CiAKICB2YXIgc3FydCA9IE1hdGguc3FydDsKICB2YXIgY29zID0gTWF0aC5jb3M7CiAgdmFyIHNpbiA9IE1hdGguc2luOwogCiAgZm9yIChpPTA7IGk8dy5sZW5ndGg7IGkrKykgewogICAgdmFyIG51bWVyYXRvciA9IHtyZWFsOjAuMCwgaW1hZzowLjB9OwogICAgZm9yIChqPTA7IGo8Yi5sZW5ndGg7IGorKykgewogICAgICBudW1lcmF0b3IucmVhbCArPSBiW2pdICogY29zKC1qKndbaV0pOwogICAgICBudW1lcmF0b3IuaW1hZyArPSBiW2pdICogc2luKC1qKndbaV0pOwogICAgfQoKICAgIHZhciBkZW5vbWluYXRvciA9IHtyZWFsOjAuMCwgaW1hZzowLjB9OwogICAgZm9yIChqPTA7IGo8YS5sZW5ndGg7IGorKykgewogICAgICBkZW5vbWluYXRvci5yZWFsICs9IGFbal0gKiBjb3MoLWoqd1tpXSk7CiAgICAgIGRlbm9taW5hdG9yLmltYWcgKz0gYVtqXSAqIHNpbigtaip3W2ldKTsKICAgIH0KIAogICAgcmVzdWx0W2ldID0gIHNxcnQobnVtZXJhdG9yLnJlYWwqbnVtZXJhdG9yLnJlYWwgKyBudW1lcmF0b3IuaW1hZypudW1lcmF0b3IuaW1hZykgLyBzcXJ0KGRlbm9taW5hdG9yLnJlYWwqZGVub21pbmF0b3IucmVhbCArIGRlbm9taW5hdG9yLmltYWcqZGVub21pbmF0b3IuaW1hZyk7CiAgfQoKICByZXR1cm4gcmVzdWx0Owp9OwoKLyogCiAqICBHcmFwaGljYWwgRXF1YWxpemVyCiAqCiAqICBJbXBsZW1lbnRhdGlvbiBvZiBhIGdyYXBoaWMgZXF1YWxpemVyIHdpdGggYSBjb25maWd1cmFibGUgYmFuZHMtcGVyLW9jdGF2ZQogKiAgYW5kIG1pbmltdW0gYW5kIG1heGltdW0gZnJlcXVlbmNpZXMKICogCiAqICBDcmVhdGVkIGJ5IFJpY2FyZCBNYXJ4ZXIgPGVtYWlsQHJpY2FyZG1hcnhlci5jb20+IG9uIDIwMTAtMDUtMjMuCiAqICBDb3B5cmlnaHQgMjAxMCBSaWNhcmQgTWFyeGVyLiBBbGwgcmlnaHRzIHJlc2VydmVkLgogKgogKi8KZnVuY3Rpb24gR3JhcGhpY2FsRXEoc2FtcGxlUmF0ZSkgewogIHRoaXMuRlMgPSBzYW1wbGVSYXRlOwogIHRoaXMubWluRnJlcSA9IDQwLjA7CiAgdGhpcy5tYXhGcmVxID0gMTYwMDAuMDsKCiAgdGhpcy5iYW5kc1Blck9jdGF2ZSA9IDEuMDsKCiAgdGhpcy5maWx0ZXJzID0gW107CiAgdGhpcy5mcmVxenMgPSBbXTsKCiAgdGhpcy5jYWxjdWxhdGVGcmVxenMgPSB0cnVlOwoKICB0aGlzLnJlY2FsY3VsYXRlRmlsdGVycyA9IGZ1bmN0aW9uKCkgewogICAgdmFyIGJhbmRDb3VudCA9IE1hdGgucm91bmQoTWF0aC5sb2codGhpcy5tYXhGcmVxL3RoaXMubWluRnJlcSkgKiB0aGlzLmJhbmRzUGVyT2N0YXZlLyBNYXRoLkxOMik7CgogICAgdGhpcy5maWx0ZXJzID0gW107CiAgICBmb3IgKHZhciBpPTA7IGk8YmFuZENvdW50OyBpKyspIHsKICAgICAgdmFyIGZyZXEgPSB0aGlzLm1pbkZyZXEqKE1hdGgucG93KDIsIGkvdGhpcy5iYW5kc1Blck9jdGF2ZSkpOwogICAgICB2YXIgbmV3RmlsdGVyID0gbmV3IEJpcXVhZChEU1AuUEVBS0lOR19FUSwgdGhpcy5GUyk7CiAgICAgIG5ld0ZpbHRlci5zZXREYkdhaW4oMCk7CiAgICAgIG5ld0ZpbHRlci5zZXRCVygxL3RoaXMuYmFuZHNQZXJPY3RhdmUpOwogICAgICBuZXdGaWx0ZXIuc2V0RjAoZnJlcSk7CiAgICAgIHRoaXMuZmlsdGVyc1tpXSA9IG5ld0ZpbHRlcjsKICAgICAgdGhpcy5yZWNhbGN1bGF0ZUZyZXF6KGkpOwogICAgfQogIH07CgogIHRoaXMuc2V0TWluaW11bUZyZXF1ZW5jeSA9IGZ1bmN0aW9uKGZyZXEpIHsKICAgIHRoaXMubWluRnJlcSA9IGZyZXE7CiAgICB0aGlzLnJlY2FsY3VsYXRlRmlsdGVycygpOwogIH07CgogIHRoaXMuc2V0TWF4aW11bUZyZXF1ZW5jeSA9IGZ1bmN0aW9uKGZyZXEpIHsKICAgIHRoaXMubWF4RnJlcSA9IGZyZXE7CiAgICB0aGlzLnJlY2FsY3VsYXRlRmlsdGVycygpOwogIH07CgogIHRoaXMuc2V0QmFuZHNQZXJPY3RhdmUgPSBmdW5jdGlvbihiYW5kcykgewogICAgdGhpcy5iYW5kc1Blck9jdGF2ZSA9IGJhbmRzOwogICAgdGhpcy5yZWNhbGN1bGF0ZUZpbHRlcnMoKTsKICB9OwoKICB0aGlzLnNldEJhbmRHYWluID0gZnVuY3Rpb24oYmFuZEluZGV4LCBnYWluKSB7CiAgICBpZiAoYmFuZEluZGV4IDwgMCB8fCBiYW5kSW5kZXggPiAodGhpcy5maWx0ZXJzLmxlbmd0aC0xKSkgewogICAgICB0aHJvdyAiVGhlIGJhbmQgaW5kZXggb2YgdGhlIGdyYXBoaWNhbCBlcXVhbGl6ZXIgaXMgb3V0IG9mIGJvdW5kcy4iOwogICAgfQoKICAgIGlmICghZ2FpbikgewogICAgICB0aHJvdyAiQSBnYWluIG11c3QgYmUgcGFzc2VkLiI7CiAgICB9CiAgIAogICAgdGhpcy5maWx0ZXJzW2JhbmRJbmRleF0uc2V0RGJHYWluKGdhaW4pOwogICAgdGhpcy5yZWNhbGN1bGF0ZUZyZXF6KGJhbmRJbmRleCk7CiAgfTsKIAogIHRoaXMucmVjYWxjdWxhdGVGcmVxeiA9IGZ1bmN0aW9uKGJhbmRJbmRleCkgewogICAgaWYgKCF0aGlzLmNhbGN1bGF0ZUZyZXF6cykgewogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKGJhbmRJbmRleCA8IDAgfHwgYmFuZEluZGV4ID4gKHRoaXMuZmlsdGVycy5sZW5ndGgtMSkpIHsKICAgICAgdGhyb3cgIlRoZSBiYW5kIGluZGV4IG9mIHRoZSBncmFwaGljYWwgZXF1YWxpemVyIGlzIG91dCBvZiBib3VuZHMuICIgKyBiYW5kSW5kZXggKyAiIGlzIG91dCBvZiBbIiArIDAgKyAiLCAiICsgdGhpcy5maWx0ZXJzLmxlbmd0aC0xICsgIl0iOwogICAgfQogICAgICAgCiAgICBpZiAoIXRoaXMudykgewogICAgICB0aGlzLncgPSBGbG9hdDY0QXJyYXkoNDAwKTsKICAgICAgZm9yICh2YXIgaT0wOyBpPHRoaXMudy5sZW5ndGg7IGkrKykgewogICAgICAgICB0aGlzLndbaV0gPSBNYXRoLlBJL3RoaXMudy5sZW5ndGggKiBpOwogICAgICB9CiAgICB9CiAgIAogICAgdmFyIGIgPSBbdGhpcy5maWx0ZXJzW2JhbmRJbmRleF0uYjAsIHRoaXMuZmlsdGVyc1tiYW5kSW5kZXhdLmIxLCB0aGlzLmZpbHRlcnNbYmFuZEluZGV4XS5iMl07CiAgICB2YXIgYSA9IFt0aGlzLmZpbHRlcnNbYmFuZEluZGV4XS5hMCwgdGhpcy5maWx0ZXJzW2JhbmRJbmRleF0uYTEsIHRoaXMuZmlsdGVyc1tiYW5kSW5kZXhdLmEyXTsKCiAgICB0aGlzLmZyZXF6c1tiYW5kSW5kZXhdID0gRFNQLm1hZzJkYihEU1AuZnJlcXooYiwgYSwgdGhpcy53KSk7CiAgfTsKCiAgdGhpcy5wcm9jZXNzID0gZnVuY3Rpb24oYnVmZmVyKSB7CiAgICB2YXIgb3V0cHV0ID0gYnVmZmVyOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5maWx0ZXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgIG91dHB1dCA9IHRoaXMuZmlsdGVyc1tpXS5wcm9jZXNzKG91dHB1dCk7CiAgICB9CgogICAgcmV0dXJuIG91dHB1dDsKICB9OwoKICB0aGlzLnByb2Nlc3NTdGVyZW8gPSBmdW5jdGlvbihidWZmZXIpIHsKICAgIHZhciBvdXRwdXQgPSBidWZmZXI7CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmZpbHRlcnMubGVuZ3RoOyBpKyspIHsKICAgICAgb3V0cHV0ID0gdGhpcy5maWx0ZXJzW2ldLnByb2Nlc3NTdGVyZW8ob3V0cHV0KTsKICAgIH0KCiAgICByZXR1cm4gb3V0cHV0OwogIH07Cn0KCi8qKgogKiBNdWx0aURlbGF5IGVmZmVjdCBieSBBbG1lciBUaGllIChodHRwOi8vY29kZS5hbG1lcm9zLmNvbSkuCiAqIENvcHlyaWdodCAyMDEwIEFsbWVyIFRoaWUuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiAqIEV4YW1wbGU6IGh0dHA6Ly9jb2RlLmFsbWVyb3MuY29tL2NvZGUtZXhhbXBsZXMvZGVsYXktZmlyZWZveC1hdWRpby1hcGkvCiAqCiAqIFRoaXMgaXMgYSBkZWxheSB0aGF0IGZlZWRzIGl0J3Mgb3duIGRlbGF5ZWQgc2lnbmFsIGJhY2sgaW50byBpdHMgY2lyY3VsYXIKICogYnVmZmVyLiBBbHNvIGtub3duIGFzIGEgQ29tYkZpbHRlci4KICoKICogQ29tcGF0aWJsZSB3aXRoIGludGVybGVhdmVkIHN0ZXJlbyAob3IgbW9yZSBjaGFubmVsKSBidWZmZXJzIGFuZAogKiBub24taW50ZXJsZWF2ZWQgbW9ubyBidWZmZXJzLgogKgogKiBAcGFyYW0ge051bWJlcn0gbWF4RGVsYXlJblNhbXBsZXNTaXplIE1heGltdW0gcG9zc2libGUgZGVsYXkgaW4gc2FtcGxlcyAoc2l6ZSBvZiBjaXJjdWxhciBidWZmZXIpCiAqIEBwYXJhbSB7TnVtYmVyfSBkZWxheUluU2FtcGxlcyBJbml0aWFsIGRlbGF5IGluIHNhbXBsZXMKICogQHBhcmFtIHtOdW1iZXJ9IG1hc3RlclZvbHVtZSBJbml0aWFsIG1hc3RlciB2b2x1bWUuIEZsb2F0IHZhbHVlOiAwLjAgKHNpbGVuY2UpLCAxLjAgKG5vcm1hbCksID4xLjAgKGFtcGxpZnkpCiAqIEBwYXJhbSB7TnVtYmVyfSBkZWxheVZvbHVtZSBJbml0aWFsIGZlZWRiYWNrIGRlbGF5IHZvbHVtZS4gRmxvYXQgdmFsdWU6IDAuMCAoc2lsZW5jZSksIDEuMCAobm9ybWFsKSwgPjEuMCAoYW1wbGlmeSkKICoKICogQGNvbnN0cnVjdG9yCiAqLwpmdW5jdGlvbiBNdWx0aURlbGF5KG1heERlbGF5SW5TYW1wbGVzU2l6ZSwgZGVsYXlJblNhbXBsZXMsIG1hc3RlclZvbHVtZSwgZGVsYXlWb2x1bWUpIHsKICB0aGlzLmRlbGF5QnVmZmVyU2FtcGxlcyAgID0gbmV3IEZsb2F0NjRBcnJheShtYXhEZWxheUluU2FtcGxlc1NpemUpOyAvLyBUaGUgbWF4aW11bSBzaXplIG9mIGRlbGF5CiAgdGhpcy5kZWxheUlucHV0UG9pbnRlciAgICAgPSBkZWxheUluU2FtcGxlczsKICB0aGlzLmRlbGF5T3V0cHV0UG9pbnRlciAgID0gMDsKIAogIHRoaXMuZGVsYXlJblNhbXBsZXMgICA9IGRlbGF5SW5TYW1wbGVzOwogIHRoaXMubWFzdGVyVm9sdW1lICAgICA9IG1hc3RlclZvbHVtZTsKICB0aGlzLmRlbGF5Vm9sdW1lICAgICA9IGRlbGF5Vm9sdW1lOwp9CgovKioKICogQ2hhbmdlIHRoZSBkZWxheSB0aW1lIGluIHNhbXBsZXMuCiAqCiAqIEBwYXJhbSB7TnVtYmVyfSBkZWxheUluU2FtcGxlcyBEZWxheSBpbiBzYW1wbGVzCiAqLwpNdWx0aURlbGF5LnByb3RvdHlwZS5zZXREZWxheUluU2FtcGxlcyA9IGZ1bmN0aW9uIChkZWxheUluU2FtcGxlcykgewogIHRoaXMuZGVsYXlJblNhbXBsZXMgPSBkZWxheUluU2FtcGxlczsKIAogIHRoaXMuZGVsYXlJbnB1dFBvaW50ZXIgPSB0aGlzLmRlbGF5T3V0cHV0UG9pbnRlciArIGRlbGF5SW5TYW1wbGVzOwoKICBpZiAodGhpcy5kZWxheUlucHV0UG9pbnRlciA+PSB0aGlzLmRlbGF5QnVmZmVyU2FtcGxlcy5sZW5ndGgtMSkgewogICAgdGhpcy5kZWxheUlucHV0UG9pbnRlciA9IHRoaXMuZGVsYXlJbnB1dFBvaW50ZXIgLSB0aGlzLmRlbGF5QnVmZmVyU2FtcGxlcy5sZW5ndGg7IAogIH0KfTsKCi8qKgogKiBDaGFuZ2UgdGhlIG1hc3RlciB2b2x1bWUuCiAqCiAqIEBwYXJhbSB7TnVtYmVyfSBtYXN0ZXJWb2x1bWUgRmxvYXQgdmFsdWU6IDAuMCAoc2lsZW5jZSksIDEuMCAobm9ybWFsKSwgPjEuMCAoYW1wbGlmeSkKICovCk11bHRpRGVsYXkucHJvdG90eXBlLnNldE1hc3RlclZvbHVtZSA9IGZ1bmN0aW9uKG1hc3RlclZvbHVtZSkgewogIHRoaXMubWFzdGVyVm9sdW1lID0gbWFzdGVyVm9sdW1lOwp9OwoKLyoqCiAqIENoYW5nZSB0aGUgZGVsYXkgZmVlZGJhY2sgdm9sdW1lLgogKgogKiBAcGFyYW0ge051bWJlcn0gZGVsYXlWb2x1bWUgRmxvYXQgdmFsdWU6IDAuMCAoc2lsZW5jZSksIDEuMCAobm9ybWFsKSwgPjEuMCAoYW1wbGlmeSkKICovCk11bHRpRGVsYXkucHJvdG90eXBlLnNldERlbGF5Vm9sdW1lID0gZnVuY3Rpb24oZGVsYXlWb2x1bWUpIHsKICB0aGlzLmRlbGF5Vm9sdW1lID0gZGVsYXlWb2x1bWU7Cn07CgovKioKICogUHJvY2VzcyBhIGdpdmVuIGludGVybGVhdmVkIG9yIG1vbm8gbm9uLWludGVybGVhdmVkIGZsb2F0IHZhbHVlIEFycmF5IGFuZCBhZGRzIHRoZSBkZWxheWVkIGF1ZGlvLgogKgogKiBAcGFyYW0ge0FycmF5fSBzYW1wbGVzIEFycmF5IGNvbnRhaW5pbmcgRmxvYXQgdmFsdWVzIG9yIGEgRmxvYXQ2NEFycmF5CiAqCiAqIEByZXR1cm5zIEEgbmV3IEZsb2F0NjRBcnJheSBpbnRlcmxlYXZlZCBvciBtb25vIG5vbi1pbnRlcmxlYXZlZCBhcyB3YXMgZmVkIHRvIHRoaXMgZnVuY3Rpb24uCiAqLwpNdWx0aURlbGF5LnByb3RvdHlwZS5wcm9jZXNzID0gZnVuY3Rpb24oc2FtcGxlcykgewogIC8vIE5CLiBNYWtlIGEgY29weSB0byBwdXQgaW4gdGhlIG91dHB1dCBzYW1wbGVzIHRvIHJldHVybi4KICB2YXIgb3V0cHV0U2FtcGxlcyA9IG5ldyBGbG9hdDY0QXJyYXkoc2FtcGxlcy5sZW5ndGgpOwoKICBmb3IgKHZhciBpPTA7IGk8c2FtcGxlcy5sZW5ndGg7IGkrKykgewogICAgLy8gZGVsYXlCdWZmZXJTYW1wbGVzIGNvdWxkIGNvbnRhaW4gaW5pdGlhbCBOVUxMJ3MsIHJldHVybiBzaWxlbmNlIGluIHRoYXQgY2FzZQogICAgdmFyIGRlbGF5U2FtcGxlID0gKHRoaXMuZGVsYXlCdWZmZXJTYW1wbGVzW3RoaXMuZGVsYXlPdXRwdXRQb2ludGVyXSA9PT0gbnVsbCA/IDAuMCA6IHRoaXMuZGVsYXlCdWZmZXJTYW1wbGVzW3RoaXMuZGVsYXlPdXRwdXRQb2ludGVyXSk7CiAgIAogICAgLy8gTWl4IG5vcm1hbCBhdWRpbyBkYXRhIHdpdGggZGVsYXllZCBhdWRpbwogICAgdmFyIHNhbXBsZSA9IChkZWxheVNhbXBsZSAqIHRoaXMuZGVsYXlWb2x1bWUpICsgc2FtcGxlc1tpXTsKICAgCiAgICAvLyBBZGQgYXVkaW8gZGF0YSB3aXRoIHRoZSBkZWxheSBpbiB0aGUgZGVsYXkgYnVmZmVyCiAgICB0aGlzLmRlbGF5QnVmZmVyU2FtcGxlc1t0aGlzLmRlbGF5SW5wdXRQb2ludGVyXSA9IHNhbXBsZTsKICAgCiAgICAvLyBSZXR1cm4gdGhlIGF1ZGlvIHdpdGggZGVsYXkgbWl4CiAgICBvdXRwdXRTYW1wbGVzW2ldID0gc2FtcGxlICogdGhpcy5tYXN0ZXJWb2x1bWU7CiAgIAogICAgLy8gTWFuYWdlIGNpcmN1bGFpciBkZWxheSBidWZmZXIgcG9pbnRlcnMKICAgIHRoaXMuZGVsYXlJbnB1dFBvaW50ZXIrKzsKICAgIGlmICh0aGlzLmRlbGF5SW5wdXRQb2ludGVyID49IHRoaXMuZGVsYXlCdWZmZXJTYW1wbGVzLmxlbmd0aC0xKSB7CiAgICAgIHRoaXMuZGVsYXlJbnB1dFBvaW50ZXIgPSAwOwogICAgfQogICAgIAogICAgdGhpcy5kZWxheU91dHB1dFBvaW50ZXIrKzsKICAgIGlmICh0aGlzLmRlbGF5T3V0cHV0UG9pbnRlciA+PSB0aGlzLmRlbGF5QnVmZmVyU2FtcGxlcy5sZW5ndGgtMSkgewogICAgICB0aGlzLmRlbGF5T3V0cHV0UG9pbnRlciA9IDA7IAogICAgfSAKICB9CiAKICByZXR1cm4gb3V0cHV0U2FtcGxlczsKfTsKCi8qKgogKiBTaW5nbGVEZWxheSBlZmZlY3QgYnkgQWxtZXIgVGhpZSAoaHR0cDovL2NvZGUuYWxtZXJvcy5jb20pLgogKiBDb3B5cmlnaHQgMjAxMCBBbG1lciBUaGllLiBBbGwgcmlnaHRzIHJlc2VydmVkLgogKiBFeGFtcGxlOiBTZWUgdXNhZ2UgaW4gUmV2ZXJiIGNsYXNzCiAqCiAqIFRoaXMgaXMgYSBkZWxheSB0aGF0IGRvZXMgTk9UIGZlZWRzIGl0J3Mgb3duIGRlbGF5ZWQgc2lnbmFsIGJhY2sgaW50byBpdHMgCiAqIGNpcmN1bGFyIGJ1ZmZlciwgbmVpdGhlciBkb2VzIGl0IHJldHVybiB0aGUgb3JpZ2luYWwgc2lnbmFsLiBBbHNvIGtub3duIGFzCiAqIGFuIEFsbFBhc3NGaWx0ZXIoPykuCiAqCiAqIENvbXBhdGlibGUgd2l0aCBpbnRlcmxlYXZlZCBzdGVyZW8gKG9yIG1vcmUgY2hhbm5lbCkgYnVmZmVycyBhbmQKICogbm9uLWludGVybGVhdmVkIG1vbm8gYnVmZmVycy4KICoKICogQHBhcmFtIHtOdW1iZXJ9IG1heERlbGF5SW5TYW1wbGVzU2l6ZSBNYXhpbXVtIHBvc3NpYmxlIGRlbGF5IGluIHNhbXBsZXMgKHNpemUgb2YgY2lyY3VsYXIgYnVmZmVyKQogKiBAcGFyYW0ge051bWJlcn0gZGVsYXlJblNhbXBsZXMgSW5pdGlhbCBkZWxheSBpbiBzYW1wbGVzCiAqIEBwYXJhbSB7TnVtYmVyfSBkZWxheVZvbHVtZSBJbml0aWFsIGZlZWRiYWNrIGRlbGF5IHZvbHVtZS4gRmxvYXQgdmFsdWU6IDAuMCAoc2lsZW5jZSksIDEuMCAobm9ybWFsKSwgPjEuMCAoYW1wbGlmeSkKICoKICogQGNvbnN0cnVjdG9yCiAqLwoKZnVuY3Rpb24gU2luZ2xlRGVsYXkobWF4RGVsYXlJblNhbXBsZXNTaXplLCBkZWxheUluU2FtcGxlcywgZGVsYXlWb2x1bWUpIHsKICB0aGlzLmRlbGF5QnVmZmVyU2FtcGxlcyA9IG5ldyBGbG9hdDY0QXJyYXkobWF4RGVsYXlJblNhbXBsZXNTaXplKTsgLy8gVGhlIG1heGltdW0gc2l6ZSBvZiBkZWxheQogIHRoaXMuZGVsYXlJbnB1dFBvaW50ZXIgID0gZGVsYXlJblNhbXBsZXM7CiAgdGhpcy5kZWxheU91dHB1dFBvaW50ZXIgPSAwOwogCiAgdGhpcy5kZWxheUluU2FtcGxlcyAgICAgPSBkZWxheUluU2FtcGxlczsKICB0aGlzLmRlbGF5Vm9sdW1lICAgICAgICA9IGRlbGF5Vm9sdW1lOwp9CgovKioKICogQ2hhbmdlIHRoZSBkZWxheSB0aW1lIGluIHNhbXBsZXMuCiAqCiAqIEBwYXJhbSB7TnVtYmVyfSBkZWxheUluU2FtcGxlcyBEZWxheSBpbiBzYW1wbGVzCiAqLwpTaW5nbGVEZWxheS5wcm90b3R5cGUuc2V0RGVsYXlJblNhbXBsZXMgPSBmdW5jdGlvbihkZWxheUluU2FtcGxlcykgewogIHRoaXMuZGVsYXlJblNhbXBsZXMgPSBkZWxheUluU2FtcGxlczsKICB0aGlzLmRlbGF5SW5wdXRQb2ludGVyID0gdGhpcy5kZWxheU91dHB1dFBvaW50ZXIgKyBkZWxheUluU2FtcGxlczsKCiAgaWYgKHRoaXMuZGVsYXlJbnB1dFBvaW50ZXIgPj0gdGhpcy5kZWxheUJ1ZmZlclNhbXBsZXMubGVuZ3RoLTEpIHsKICAgIHRoaXMuZGVsYXlJbnB1dFBvaW50ZXIgPSB0aGlzLmRlbGF5SW5wdXRQb2ludGVyIC0gdGhpcy5kZWxheUJ1ZmZlclNhbXBsZXMubGVuZ3RoOyAKICB9Cn07CgovKioKICogQ2hhbmdlIHRoZSByZXR1cm4gc2lnbmFsIHZvbHVtZS4KICoKICogQHBhcmFtIHtOdW1iZXJ9IGRlbGF5Vm9sdW1lIEZsb2F0IHZhbHVlOiAwLjAgKHNpbGVuY2UpLCAxLjAgKG5vcm1hbCksID4xLjAgKGFtcGxpZnkpCiAqLwpTaW5nbGVEZWxheS5wcm90b3R5cGUuc2V0RGVsYXlWb2x1bWUgPSBmdW5jdGlvbihkZWxheVZvbHVtZSkgewogIHRoaXMuZGVsYXlWb2x1bWUgPSBkZWxheVZvbHVtZTsKfTsKCi8qKgogKiBQcm9jZXNzIGEgZ2l2ZW4gaW50ZXJsZWF2ZWQgb3IgbW9ubyBub24taW50ZXJsZWF2ZWQgZmxvYXQgdmFsdWUgQXJyYXkgYW5kCiAqIHJldHVybnMgdGhlIGRlbGF5ZWQgYXVkaW8uCiAqCiAqIEBwYXJhbSB7QXJyYXl9IHNhbXBsZXMgQXJyYXkgY29udGFpbmluZyBGbG9hdCB2YWx1ZXMgb3IgYSBGbG9hdDY0QXJyYXkKICoKICogQHJldHVybnMgQSBuZXcgRmxvYXQ2NEFycmF5IGludGVybGVhdmVkIG9yIG1vbm8gbm9uLWludGVybGVhdmVkIGFzIHdhcyBmZWQgdG8gdGhpcyBmdW5jdGlvbi4KICovClNpbmdsZURlbGF5LnByb3RvdHlwZS5wcm9jZXNzID0gZnVuY3Rpb24oc2FtcGxlcykgewogIC8vIE5CLiBNYWtlIGEgY29weSB0byBwdXQgaW4gdGhlIG91dHB1dCBzYW1wbGVzIHRvIHJldHVybi4KICB2YXIgb3V0cHV0U2FtcGxlcyA9IG5ldyBGbG9hdDY0QXJyYXkoc2FtcGxlcy5sZW5ndGgpOwoKICBmb3IgKHZhciBpPTA7IGk8c2FtcGxlcy5sZW5ndGg7IGkrKykgewoKICAgIC8vIEFkZCBhdWRpbyBkYXRhIHdpdGggdGhlIGRlbGF5IGluIHRoZSBkZWxheSBidWZmZXIKICAgIHRoaXMuZGVsYXlCdWZmZXJTYW1wbGVzW3RoaXMuZGVsYXlJbnB1dFBvaW50ZXJdID0gc2FtcGxlc1tpXTsKICAgCiAgICAvLyBkZWxheUJ1ZmZlclNhbXBsZXMgY291bGQgY29udGFpbiBpbml0aWFsIE5VTEwncywgcmV0dXJuIHNpbGVuY2UgaW4gdGhhdCBjYXNlCiAgICB2YXIgZGVsYXlTYW1wbGUgPSB0aGlzLmRlbGF5QnVmZmVyU2FtcGxlc1t0aGlzLmRlbGF5T3V0cHV0UG9pbnRlcl07CgogICAgLy8gUmV0dXJuIHRoZSBhdWRpbyB3aXRoIGRlbGF5IG1peAogICAgb3V0cHV0U2FtcGxlc1tpXSA9IGRlbGF5U2FtcGxlICogdGhpcy5kZWxheVZvbHVtZTsKCiAgICAvLyBNYW5hZ2UgY2lyY3VsYWlyIGRlbGF5IGJ1ZmZlciBwb2ludGVycwogICAgdGhpcy5kZWxheUlucHV0UG9pbnRlcisrOwoKICAgIGlmICh0aGlzLmRlbGF5SW5wdXRQb2ludGVyID49IHRoaXMuZGVsYXlCdWZmZXJTYW1wbGVzLmxlbmd0aC0xKSB7CiAgICAgIHRoaXMuZGVsYXlJbnB1dFBvaW50ZXIgPSAwOwogICAgfQogICAgIAogICAgdGhpcy5kZWxheU91dHB1dFBvaW50ZXIrKzsKCiAgICBpZiAodGhpcy5kZWxheU91dHB1dFBvaW50ZXIgPj0gdGhpcy5kZWxheUJ1ZmZlclNhbXBsZXMubGVuZ3RoLTEpIHsKICAgICAgdGhpcy5kZWxheU91dHB1dFBvaW50ZXIgPSAwOyAKICAgIH0gCiAgfQogCiAgcmV0dXJuIG91dHB1dFNhbXBsZXM7Cn07CgovKioKICogUmV2ZXJiIGVmZmVjdCBieSBBbG1lciBUaGllIChodHRwOi8vY29kZS5hbG1lcm9zLmNvbSkuCiAqIENvcHlyaWdodCAyMDEwIEFsbWVyIFRoaWUuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiAqIEV4YW1wbGU6IGh0dHA6Ly9jb2RlLmFsbWVyb3MuY29tL2NvZGUtZXhhbXBsZXMvcmV2ZXJiLWZpcmVmb3gtYXVkaW8tYXBpLwogKgogKiBUaGlzIHJldmVyYiBjb25zaXN0cyBvZiA2IFNpbmdsZURlbGF5cywgNiBNdWx0aURlbGF5cyBhbmQgYW4gSUlSRmlsdGVyMgogKiBmb3IgZWFjaCBvZiB0aGUgdHdvIHN0ZXJlbyBjaGFubmVscy4KICoKICogQ29tcGF0aWJsZSB3aXRoIGludGVybGVhdmVkIHN0ZXJlbyBidWZmZXJzIG9ubHkhCiAqCiAqIEBwYXJhbSB7TnVtYmVyfSBtYXhEZWxheUluU2FtcGxlc1NpemUgTWF4aW11bSBwb3NzaWJsZSBkZWxheSBpbiBzYW1wbGVzIChzaXplIG9mIGNpcmN1bGFyIGJ1ZmZlcnMpCiAqIEBwYXJhbSB7TnVtYmVyfSBkZWxheUluU2FtcGxlcyBJbml0aWFsIGRlbGF5IGluIHNhbXBsZXMgZm9yIGludGVybmFsIChTaW5nbGUvTXVsdGkpZGVsYXlzCiAqIEBwYXJhbSB7TnVtYmVyfSBtYXN0ZXJWb2x1bWUgSW5pdGlhbCBtYXN0ZXIgdm9sdW1lLiBGbG9hdCB2YWx1ZTogMC4wIChzaWxlbmNlKSwgMS4wIChub3JtYWwpLCA+MS4wIChhbXBsaWZ5KQogKiBAcGFyYW0ge051bWJlcn0gbWl4Vm9sdW1lIEluaXRpYWwgcmV2ZXJiIHNpZ25hbCBtaXggdm9sdW1lLiBGbG9hdCB2YWx1ZTogMC4wIChzaWxlbmNlKSwgMS4wIChub3JtYWwpLCA+MS4wIChhbXBsaWZ5KQogKiBAcGFyYW0ge051bWJlcn0gZGVsYXlWb2x1bWUgSW5pdGlhbCBmZWVkYmFjayBkZWxheSB2b2x1bWUgZm9yIGludGVybmFsIChTaW5nbGUvTXVsdGkpZGVsYXlzLiBGbG9hdCB2YWx1ZTogMC4wIChzaWxlbmNlKSwgMS4wIChub3JtYWwpLCA+MS4wIChhbXBsaWZ5KQogKiBAcGFyYW0ge051bWJlcn0gZGFtcEZyZXF1ZW5jeSBJbml0aWFsIGxvdyBwYXNzIGZpbHRlciBmcmVxdWVuY3kuIDAgdG8gNDQxMDAgKGRlcGVuZGluZyBvbiB5b3VyIG1heGltdW0gc2FtcGxpbmcgZnJlcXVlbmN5KQogKgogKiBAY29uc3RydWN0b3IKICovCmZ1bmN0aW9uIFJldmVyYihtYXhEZWxheUluU2FtcGxlc1NpemUsIGRlbGF5SW5TYW1wbGVzLCBtYXN0ZXJWb2x1bWUsIG1peFZvbHVtZSwgZGVsYXlWb2x1bWUsIGRhbXBGcmVxdWVuY3kpIHsKICB0aGlzLmRlbGF5SW5TYW1wbGVzICAgPSBkZWxheUluU2FtcGxlczsKICB0aGlzLm1hc3RlclZvbHVtZSAgICAgPSBtYXN0ZXJWb2x1bWU7CiAgdGhpcy5taXhWb2x1bWUgICAgICAgPSBtaXhWb2x1bWU7CiAgdGhpcy5kZWxheVZvbHVtZSAgICAgPSBkZWxheVZvbHVtZTsKICB0aGlzLmRhbXBGcmVxdWVuY3kgICAgID0gZGFtcEZyZXF1ZW5jeTsKIAogIHRoaXMuTlJfT0ZfTVVMVElERUxBWVMgPSA2OwogIHRoaXMuTlJfT0ZfU0lOR0xFREVMQVlTID0gNjsKIAogIHRoaXMuTE9XUEFTU0wgPSBuZXcgSUlSRmlsdGVyMihEU1AuTE9XUEFTUywgZGFtcEZyZXF1ZW5jeSwgMCwgNDQxMDApOwogIHRoaXMuTE9XUEFTU1IgPSBuZXcgSUlSRmlsdGVyMihEU1AuTE9XUEFTUywgZGFtcEZyZXF1ZW5jeSwgMCwgNDQxMDApOwogCiAgdGhpcy5zaW5nbGVEZWxheXMgPSBbXTsKICAKICB2YXIgaSwgZGVsYXlNdWx0aXBseTsKCiAgZm9yIChpID0gMDsgaSA8IHRoaXMuTlJfT0ZfU0lOR0xFREVMQVlTOyBpKyspIHsKICAgIGRlbGF5TXVsdGlwbHkgPSAxLjAgKyAoaS83LjApOyAvLyAxLjAsIDEuMSwgMS4yLi4uCiAgICB0aGlzLnNpbmdsZURlbGF5c1tpXSA9IG5ldyBTaW5nbGVEZWxheShtYXhEZWxheUluU2FtcGxlc1NpemUsIE1hdGgucm91bmQodGhpcy5kZWxheUluU2FtcGxlcyAqIGRlbGF5TXVsdGlwbHkpLCB0aGlzLmRlbGF5Vm9sdW1lKTsKICB9CiAKICB0aGlzLm11bHRpRGVsYXlzID0gW107CgogIGZvciAoaSA9IDA7IGkgPCB0aGlzLk5SX09GX01VTFRJREVMQVlTOyBpKyspIHsKICAgIGRlbGF5TXVsdGlwbHkgPSAxLjAgKyAoaS8xMC4wKTsgLy8gMS4wLCAxLjEsIDEuMi4uLiAKICAgIHRoaXMubXVsdGlEZWxheXNbaV0gPSBuZXcgTXVsdGlEZWxheShtYXhEZWxheUluU2FtcGxlc1NpemUsIE1hdGgucm91bmQodGhpcy5kZWxheUluU2FtcGxlcyAqIGRlbGF5TXVsdGlwbHkpLCB0aGlzLm1hc3RlclZvbHVtZSwgdGhpcy5kZWxheVZvbHVtZSk7CiAgfQp9CgovKioKICogQ2hhbmdlIHRoZSBkZWxheSB0aW1lIGluIHNhbXBsZXMgYXMgYSBiYXNlIGZvciBhbGwgZGVsYXlzLgogKgogKiBAcGFyYW0ge051bWJlcn0gZGVsYXlJblNhbXBsZXMgRGVsYXkgaW4gc2FtcGxlcwogKi8KUmV2ZXJiLnByb3RvdHlwZS5zZXREZWxheUluU2FtcGxlcyA9IGZ1bmN0aW9uIChkZWxheUluU2FtcGxlcyl7CiAgdGhpcy5kZWxheUluU2FtcGxlcyA9IGRlbGF5SW5TYW1wbGVzOwoKICB2YXIgaSwgZGVsYXlNdWx0aXBseTsKIAogIGZvciAoaSA9IDA7IGkgPCB0aGlzLk5SX09GX1NJTkdMRURFTEFZUzsgaSsrKSB7CiAgICBkZWxheU11bHRpcGx5ID0gMS4wICsgKGkvNy4wKTsgLy8gMS4wLCAxLjEsIDEuMi4uLgogICAgdGhpcy5zaW5nbGVEZWxheXNbaV0uc2V0RGVsYXlJblNhbXBsZXMoIE1hdGgucm91bmQodGhpcy5kZWxheUluU2FtcGxlcyAqIGRlbGF5TXVsdGlwbHkpICk7CiAgfQogICAKICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5OUl9PRl9NVUxUSURFTEFZUzsgaSsrKSB7CiAgICBkZWxheU11bHRpcGx5ID0gMS4wICsgKGkvMTAuMCk7IC8vIDEuMCwgMS4xLCAxLjIuLi4KICAgIHRoaXMubXVsdGlEZWxheXNbaV0uc2V0RGVsYXlJblNhbXBsZXMoIE1hdGgucm91bmQodGhpcy5kZWxheUluU2FtcGxlcyAqIGRlbGF5TXVsdGlwbHkpICk7CiAgfQp9OwoKLyoqCiAqIENoYW5nZSB0aGUgbWFzdGVyIHZvbHVtZS4KICoKICogQHBhcmFtIHtOdW1iZXJ9IG1hc3RlclZvbHVtZSBGbG9hdCB2YWx1ZTogMC4wIChzaWxlbmNlKSwgMS4wIChub3JtYWwpLCA+MS4wIChhbXBsaWZ5KQogKi8KUmV2ZXJiLnByb3RvdHlwZS5zZXRNYXN0ZXJWb2x1bWUgPSBmdW5jdGlvbiAobWFzdGVyVm9sdW1lKXsKICB0aGlzLm1hc3RlclZvbHVtZSA9IG1hc3RlclZvbHVtZTsKfTsKCi8qKgogKiBDaGFuZ2UgdGhlIHJldmVyYiBzaWduYWwgbWl4IGxldmVsLgogKgogKiBAcGFyYW0ge051bWJlcn0gbWl4Vm9sdW1lIEZsb2F0IHZhbHVlOiAwLjAgKHNpbGVuY2UpLCAxLjAgKG5vcm1hbCksID4xLjAgKGFtcGxpZnkpCiAqLwpSZXZlcmIucHJvdG90eXBlLnNldE1peFZvbHVtZSA9IGZ1bmN0aW9uIChtaXhWb2x1bWUpewogIHRoaXMubWl4Vm9sdW1lID0gbWl4Vm9sdW1lOwp9OwoKLyoqCiAqIENoYW5nZSBhbGwgZGVsYXlzIGZlZWRiYWNrIHZvbHVtZS4KICoKICogQHBhcmFtIHtOdW1iZXJ9IGRlbGF5Vm9sdW1lIEZsb2F0IHZhbHVlOiAwLjAgKHNpbGVuY2UpLCAxLjAgKG5vcm1hbCksID4xLjAgKGFtcGxpZnkpCiAqLwpSZXZlcmIucHJvdG90eXBlLnNldERlbGF5Vm9sdW1lID0gZnVuY3Rpb24gKGRlbGF5Vm9sdW1lKXsKICB0aGlzLmRlbGF5Vm9sdW1lID0gZGVsYXlWb2x1bWU7CiAKICB2YXIgaTsKCiAgZm9yIChpID0gMDsgaTx0aGlzLk5SX09GX1NJTkdMRURFTEFZUzsgaSsrKSB7CiAgICB0aGlzLnNpbmdsZURlbGF5c1tpXS5zZXREZWxheVZvbHVtZSh0aGlzLmRlbGF5Vm9sdW1lKTsKICB9IAogCiAgZm9yIChpID0gMDsgaTx0aGlzLk5SX09GX01VTFRJREVMQVlTOyBpKyspIHsKICAgIHRoaXMubXVsdGlEZWxheXNbaV0uc2V0RGVsYXlWb2x1bWUodGhpcy5kZWxheVZvbHVtZSk7CiAgfSAKfTsKCi8qKgogKiBDaGFuZ2UgdGhlIExvdyBQYXNzIGZpbHRlciBmcmVxdWVuY3kuCiAqCiAqIEBwYXJhbSB7TnVtYmVyfSBkYW1wRnJlcXVlbmN5IGxvdyBwYXNzIGZpbHRlciBmcmVxdWVuY3kuIDAgdG8gNDQxMDAgKGRlcGVuZGluZyBvbiB5b3VyIG1heGltdW0gc2FtcGxpbmcgZnJlcXVlbmN5KQogKi8KUmV2ZXJiLnByb3RvdHlwZS5zZXREYW1wRnJlcXVlbmN5ID0gZnVuY3Rpb24gKGRhbXBGcmVxdWVuY3kpewogIHRoaXMuZGFtcEZyZXF1ZW5jeSA9IGRhbXBGcmVxdWVuY3k7CiAKICB0aGlzLkxPV1BBU1NMLnNldChkYW1wRnJlcXVlbmN5LCAwKTsKICB0aGlzLkxPV1BBU1NSLnNldChkYW1wRnJlcXVlbmN5LCAwKTsgCn07CgovKioKICogUHJvY2VzcyBhIGdpdmVuIGludGVybGVhdmVkIGZsb2F0IHZhbHVlIEFycmF5IGFuZCBjb3BpZXMgYW5kIGFkZHMgdGhlIHJldmVyYiBzaWduYWwuCiAqCiAqIEBwYXJhbSB7QXJyYXl9IHNhbXBsZXMgQXJyYXkgY29udGFpbmluZyBGbG9hdCB2YWx1ZXMgb3IgYSBGbG9hdDY0QXJyYXkKICoKICogQHJldHVybnMgQSBuZXcgRmxvYXQ2NEFycmF5IGludGVybGVhdmVkIGJ1ZmZlci4KICovClJldmVyYi5wcm90b3R5cGUucHJvY2VzcyA9IGZ1bmN0aW9uIChpbnRlcmxlYXZlZFNhbXBsZXMpeyAKICAvLyBOQi4gTWFrZSBhIGNvcHkgdG8gcHV0IGluIHRoZSBvdXRwdXQgc2FtcGxlcyB0byByZXR1cm4uCiAgdmFyIG91dHB1dFNhbXBsZXMgPSBuZXcgRmxvYXQ2NEFycmF5KGludGVybGVhdmVkU2FtcGxlcy5sZW5ndGgpOwogCiAgLy8gUGVyZm9ybSBsb3cgcGFzcyBvbiB0aGUgaW5wdXQgc2FtcGxlcyB0byBtaW1pY2sgZGFtcAogIHZhciBsZWZ0UmlnaHRNaXggPSBEU1AuZGVpbnRlcmxlYXZlKGludGVybGVhdmVkU2FtcGxlcyk7CiAgdGhpcy5MT1dQQVNTTC5wcm9jZXNzKCBsZWZ0UmlnaHRNaXhbRFNQLkxFRlRdICk7CiAgdGhpcy5MT1dQQVNTUi5wcm9jZXNzKCBsZWZ0UmlnaHRNaXhbRFNQLlJJR0hUXSApOyAKICB2YXIgZmlsdGVyZWRTYW1wbGVzID0gRFNQLmludGVybGVhdmUobGVmdFJpZ2h0TWl4W0RTUC5MRUZUXSwgbGVmdFJpZ2h0TWl4W0RTUC5SSUdIVF0pOwoKICB2YXIgaTsKCiAgLy8gUHJvY2VzcyBNdWx0aURlbGF5cyBpbiBwYXJhbGxlbAogIGZvciAoaSA9IDA7IGk8dGhpcy5OUl9PRl9NVUxUSURFTEFZUzsgaSsrKSB7CiAgICAvLyBJbnZlcnQgdGhlIHNpZ25hbCBvZiBldmVyeSBldmVuIG11bHRpRGVsYXkKICAgIG91dHB1dFNhbXBsZXMgPSBEU1AubWl4U2FtcGxlQnVmZmVycyhvdXRwdXRTYW1wbGVzLCB0aGlzLm11bHRpRGVsYXlzW2ldLnByb2Nlc3MoZmlsdGVyZWRTYW1wbGVzKSwgMiVpID09PSAwLCB0aGlzLk5SX09GX01VTFRJREVMQVlTKTsKICB9CiAKICAvLyBQcm9jZXNzIFNpbmdsZURlbGF5cyBpbiBzZXJpZXMKICB2YXIgc2luZ2xlRGVsYXlTYW1wbGVzID0gbmV3IEZsb2F0NjRBcnJheShvdXRwdXRTYW1wbGVzLmxlbmd0aCk7CiAgZm9yIChpID0gMDsgaTx0aGlzLk5SX09GX1NJTkdMRURFTEFZUzsgaSsrKSB7CiAgICAvLyBJbnZlcnQgdGhlIHNpZ25hbCBvZiBldmVyeSBldmVuIHNpbmdsZURlbGF5CiAgICBzaW5nbGVEZWxheVNhbXBsZXMgPSBEU1AubWl4U2FtcGxlQnVmZmVycyhzaW5nbGVEZWxheVNhbXBsZXMsIHRoaXMuc2luZ2xlRGVsYXlzW2ldLnByb2Nlc3Mob3V0cHV0U2FtcGxlcyksIDIlaSA9PT0gMCwgMSk7CiAgfQoKICAvLyBBcHBseSB0aGUgdm9sdW1lIG9mIHRoZSByZXZlcmIgc2lnbmFsCiAgZm9yIChpID0gMDsgaTxzaW5nbGVEZWxheVNhbXBsZXMubGVuZ3RoOyBpKyspIHsKICAgIHNpbmdsZURlbGF5U2FtcGxlc1tpXSAqPSB0aGlzLm1peFZvbHVtZTsKICB9CiAKICAvLyBNaXggdGhlIG9yaWdpbmFsIHNpZ25hbCB3aXRoIHRoZSByZXZlcmIgc2lnbmFsCiAgb3V0cHV0U2FtcGxlcyA9IERTUC5taXhTYW1wbGVCdWZmZXJzKHNpbmdsZURlbGF5U2FtcGxlcywgaW50ZXJsZWF2ZWRTYW1wbGVzLCAwLCAxKTsKCiAgLy8gQXBwbHkgdGhlIG1hc3RlciB2b2x1bWUgdG8gdGhlIGNvbXBsZXRlIHNpZ25hbAogIGZvciAoaSA9IDA7IGk8b3V0cHV0U2FtcGxlcy5sZW5ndGg7IGkrKykgewogICAgb3V0cHV0U2FtcGxlc1tpXSAqPSB0aGlzLm1hc3RlclZvbHVtZTsKICB9CiAgIAogIHJldHVybiBvdXRwdXRTYW1wbGVzOwp9OwoKaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnICYmIG1vZHVsZSAmJiBtb2R1bGUuZXhwb3J0cykgewogIG1vZHVsZS5leHBvcnRzID0gewogICAgRFNQOiBEU1AsCiAgICBERlQ6IERGVCwKICAgIEZGVDogRkZULAogICAgUkZGVDogUkZGVCwKICAgIFNhbXBsZXI6IFNhbXBsZXIsCiAgICBPc2NpbGxhdG9yOiBPc2NpbGxhdG9yLAogICAgQURTUjogQURTUiwKICAgIElJUkZpbHRlcjogSUlSRmlsdGVyLAogICAgSUlSRmlsdGVyMjogSUlSRmlsdGVyMiwKICAgIFdpbmRvd0Z1bmN0aW9uOiBXaW5kb3dGdW5jdGlvbiwKICAgIHNpbmg6IHNpbmgsCiAgICBCaXF1YWQ6IEJpcXVhZCwKICAgIEdyYXBoaWNhbEVxOiBHcmFwaGljYWxFcSwKICAgIE11bHRpRGVsYXk6IE11bHRpRGVsYXksCiAgICBTaW5nbGVEZWxheTogU2luZ2xlRGVsYXksCiAgICBSZXZlcmI6IFJldmVyYgogIH07Cn0="
    }
  ],
  "html": "<style type=\"text/css\">\n    * {\n        color: #fff;\n        font-size:12px;\n        font-weight:bold;\n        font-family: monospace;\n    }\n\n    #sound-context {\n        display: none;\n    }\n\n    #output-context {\n        position: absolute;\n        width: 100%;\n        height: 100%;\n        background-color: #000;\n        z-index:-2;\n    }\n    html, body {\n        position: absolute;\n        width: 100%;\n        height: 100%;\n        background-color: #000;\n        z-index:-3;\n    }\n    textarea {\n        position:relative;\n        width: 95% !important;\n        height: 50vh !important;\n        color: #fff !important;\n        background-color: #000;\n        z-index: 0 !important;\n    }\n    input {\n        border: 1px solid #fff !important;\n        color: #fff;\n        background-color: #000;\n        width: 95% !important;\n    }\n    button {\n        z-index: 1 !important;solid;\n        color: #fff;\n        background-color: #000;\n    }\n    .container {\n        text-align: center;\n        position:absolute;\n        top: 0%;\n        width: 100% !important;\n        height: 100% !important;\n        background-color: rgba(0, 0, 0, 0) !important;\n}\n.centered  \n{\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  width: auto;\n  transform: translate(-50%, -50%);\n  border-radius: 10px;\n  border: 2px solid white;\n  background-color: rgba(0, 0, 0, 255) !important;\n}\n</style>\n<script src='./dsp.js'></script>\n<div onclick='connect()' id='connect-page'  class='container'>\n</div>\n<div id='challenge-page' style=\"display:none;\" class='container'>\n<div class='centered'>\n<h1 style=\"color:#ff0;border-bottom:1px solid #fff;\" \">CHALLENGE\n<br>\n<br></h1>\n            <h1 style=\"text-align:center; font-size:14px;\">Answer the challenge CAPTCHA below to participate in the IRC-like websocket service of this site.</h1>\n<br>\n            <div style=\"display:inline-flex; text-align:center !important;\">\n            <img id=\"captcha\" style=\"\">\n            </div>\n<br>\n<br>\n            <div style=\"text-align:center;\"><input id=\"captcha_answer\" autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" style=\"text-align:center; width:100%; !important;\" placeholder=\"Alphanumeric characters...\" value=\"\"></div>\n<br>\n\n            <button style=\"color:#f00; border-color:#fff;\" onclick=\"try{window.websocket.close()}catch(e){console.log(e)}\">Disconnect</button>\n\n            <button style=\"color:#fff; border-color:#0f0;\" onclick=\"send_captcha()\">Send</button>\n<br>\n<br>\n</div>\n</div>\n<div id='terminal-page' style=\"display:none;\" class='container'>\n<div class='centered'>\n            <button style=\"color:#f00; border-color:#fff;\" onclick=\"try{window.websocket.close()}catch(e){console.log(e)}\">Disconnect</button>\n<textarea id='output' disabled></textarea>\n<br>\n\n<div id='input'>\n<input style='width:100% !important;' autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" id='command' placeholder='Type network command...' type='text' onkeyup='if (event.key === \"Enter\") send_command();'></input>\n\n            <button style=\"width:30%;color:#fff; border-color:#0f0;\" onclick=\"send_command()\">Send</button>\n<br><br>\n</div>\n</div>\n</div>\n",
  "client": "document.body.innerHTML = ''; // Clear the body of the iframe from the last compilation.\nwindow.sound_texture = null;\nwindow.buffer_texture = null;\nwindow.fft_size = 1024;\nwindow.sound_texture = null;\nwindow.buffer_texture = null;\nwindow.unmixed = []\nfunction appendConsole(mes) {\n    const output = document.getElementById('output');\n    output.value += mes;\n    output.scrollTop = output.scrollHeight;\n}\n\nfunction connect() {\n    new MicrophoneSample();\n\n    if (window.websocket) try {\n        window.websocket.close()\n    } catch (e) { }\n    window.websocket = new WebSocket((window.location.protocol.endsWith('https:') ? 'wss://' : 'ws://') + window.location.host + '/irc_websocket')\n    window.websocket.onclose = () => {\n        document.getElementById(\"challenge-page\").style.display = 'none';\n        document.getElementById(\"connect-page\").style.display = 'block';\n        document.getElementById(\"terminal-page\").style.display = 'none';\n    };\n\n    window.challenge_callback = (challenge_image) => {\n        document.getElementById('captcha').setAttribute('src', challenge_image)\n        document.getElementById(\"challenge-page\").style.display = 'block';\n        document.getElementById(\"connect-page\").style.display = 'none';\n        document.getElementById(\"terminal-page\").style.display = 'none';\n    }\n    window.websocket.onopen = (function () {\n    });\n    window.websocket.onmessage = (function (event) {\n        var string = event.data.toString()\n        //console.log(string);\n        const data = JSON.parse(string);\n        if (data.challenge) {\n            window.challenge_callback(data.challenge)\n        }\n        else if (data.server || data.error) {\n\n            document.getElementById(\"challenge-page\").style.display = 'none';\n            document.getElementById(\"connect-page\").style.display = 'none';\n            document.getElementById(\"terminal-page\").style.display = 'block';\n            appendConsole((data.server ? data.server : data.error) + '\\n')\n        }\n        else if (data.channel) {\n            appendConsole(\"The current user list of channel \" + data.channel + \" is: \" + data.users.reduce((acc, user, index) => acc + user.name + (index != data.users.length - 1 ? \", \" : \".\\n\"), \"\"));\n            if (window.spectrum) window.clearInterval(window.spectrum);\n            window.spectrum = setInterval(drawSpectrum, 10)\n        }\n        else if (data.nickname) {\n            appendConsole(\"Your new nickname is now: \" + data.nickname + '\\n');\n            window.nickname = data.nickname;\n        }\n        else if (data.sayer) {\n            //console.log(data.sayer, window.nickname)\n            if (data.sayer != window.nickname) {\n                try {\n                    let a = data.says.split(' ')[0]\n                    let b = data.says.split(' ')[1]\n                    a = new Float64Array(Array.from(JSON.parse(a)))\n                    b = new Float64Array(Array.from(JSON.parse(b)))\n                    window.unmixed.push([a, b])\n                } catch (e) {\n                    console.log(e);\n                    appendConsole(data.sayer + \" says: \" + data.says + \"\\n\");\n                }\n            }\n        }\n    });\n}\n\nfunction send_captcha() {\n    var e = document.getElementById(\"captcha_answer\");\n    window.websocket.send(e.value + '\\n');\n    e.value = ''\n}\n\nfunction send_command() {\n    var e = document.getElementById(\"command\");\n    window.websocket.send(e.value + '\\n');\n\n    appendConsole(e.value + '\\n')\n    e.value = ''\n}\n\n\n\nfunction MicrophoneSample() {\n    this.getMicrophoneInput();\n}\n\nMicrophoneSample.prototype.getMicrophoneInput = function () {\n    // TODO(smus): Remove this ugliness.\n    var isLocalhost = window.location.hostname == 'localhost' ||\n        window.location.hostname == '127.0.0.1';\n    if (window.location.protocol != 'https:' && !isLocalhost) {\n        alert('HTTPS is required for microphone access, and this site has no SSL cert yet. Sorry!');\n    }\n    if (navigator.mediaDevices) {\n        navigator.mediaDevices.getUserMedia({ \"audio\": true }).then(this.onStream).catch(this.onStreamError);\n    } else {\n        // browser unable to access media devices\n        // (update your browser)\n    }\n};\n\nMicrophoneSample.prototype.onStreamError = function (e) {\n    console.error('Error getting microphone', e);\n};\nfunction drawSpectrum() {\n    window.time_array = new Uint8Array(window.fft_size);\n    window.time_byte_array = new Uint8Array(window.fft_size);\n    window.freq_array = new Float32Array(window.fft_size);\n    window.audioAnalyser.getByteTimeDomainData(window.time_array);\n    window.audioAnalyser.getByteTimeDomainData(window.time_byte_array);\n    window.audioAnalyser.getFloatFrequencyData(window.freq_array);\n    if(window.time_array.reduce((a,v)=>a+Math.abs(v-128.)/128.,0)/window.time_array.length > .025){\n        console.log(\"packet sent\");\n        window.fft.forward(window.time_array)\n        window.websocket.send(\"/say \" + JSON.stringify(Array.from(window.fft.real)) + \" \" + JSON.stringify(Array.from(window.fft.imag)) + '\\n');\n    }\n    if(window.unmixed.length > 0){\n      [a, b] = window.unmixed.shift()\n      window.network_audio = window.ifft.inverse(a, b).map((v)=>(v-128.)/128.);;\n    } else if( window.network_audio) {\n      window.network_audio = window.network_audio.map((v)=>v/1.1)\n    }\n    \n    if(window.network_audio) {\n      window.messengerWorkletNode.port.postMessage(window.network_audio)\n    }\n}\n\nMicrophoneSample.prototype.onStream = function (stream) {\n\n\n    window.audioContext ? window.audioContext.close() : (() => { })();\n    window.audioContext = new (window.AudioContext ||\n        window.webkitAudioContext ||\n        window.mozAudioContext ||\n        window.oAudioContext ||\n        window.msAudioContext)();\n    window.audioContext.audioWorklet.addModule('MessengerProcessor.js').then(() => {\n\n        window.microphone_input = window.audioContext.createMediaStreamSource(stream);\n        window.audioAnalyser = window.audioContext.createAnalyser();\n        window.audioAnalyser.fft_size = window.fft_size\n        window.audioAnalyser.smoothingTimeConstant = 0.5;\n        window.microphone_input.connect(window.audioAnalyser);\n\n        window.fft = new DFT(window.fft_size, window.audioContext.sampleRate);\n        window.ifft = new FFT(window.fft_size, window.audioContext.sampleRate);\n\n        // Extends AudioWorkletNode to simplify the cross-thread message posting.\n        class MessengerWorkletNode extends AudioWorkletNode {\n            constructor(context) {\n                super(context, 'messenger-processor');\n                this.port.onmessage = this.handleMessage_.bind(this);\n            }\n\n            handleMessage_(event) {\n                console.log(event.data)\n            }\n        }\n\n        window.messengerWorkletNode = new MessengerWorkletNode(window.audioContext);\n        window.messengerWorkletNode.connect(window.audioContext.destination);\n    });\n};\nif (window.spectrum) window.clearInterval(window.spectrum);\n\n\n",
  "pipeline": {
    "contexts": [
      {
        "width": {
          "type": "EXACT",
          "value": "return window.fft_size;",
          "Type": {
            "UNSET": "",
            "SCREEN_SIZE": "SCREEN_SIZE",
            "NEXT_LOWEST_POWER_OF_TWO": "NEXT_LOWEST_POWER_OF_TWO",
            "NEXT_HIGHEST_POWER_OF_TWO": "NEXT_HIGHEST_POWER_OF_TWO",
            "EXACT": "EXACT"
          }
        },
        "height": {
          "type": "EXACT",
          "value": "return 1",
          "Type": {
            "UNSET": "",
            "SCREEN_SIZE": "SCREEN_SIZE",
            "NEXT_LOWEST_POWER_OF_TWO": "NEXT_LOWEST_POWER_OF_TWO",
            "NEXT_HIGHEST_POWER_OF_TWO": "NEXT_HIGHEST_POWER_OF_TWO",
            "EXACT": "EXACT"
          }
        },
        "depth_test": false,
        "name": "sound-context"
      },
      {
        "name": "output-context",
        "width": {
          "type": "SCREEN_SIZE",
          "value": "return 600"
        },
        "height": {
          "type": "SCREEN_SIZE",
          "value": "return 335"
        }
      }
    ],
    "programs": [
      {
        "uniforms": [],
        "fragment": "#extension GL_OES_standard_derivatives : enable\nprecision highp float;\nprecision highp int;\n\n#define UNIFORM_INSERTION_POINT\n\nvarying vec2 vPosition;\n\nvoid main()\n{\n    gl_FragColor =  vec4(vPosition.xy, 0., 1.);\n}",
        "vertex": "precision highp float;\nprecision highp int;\n\n#define UNIFORM_INSERTION_POINT\n\nattribute highp vec4 vertex; \n\nvarying vec2 vPosition;\nvoid main(void) {\n    gl_PointSize = 2.;\n    vPosition = vertex.zw;\n    gl_Position = vec4(vertex.xy, 0., 1.);\n}\n",
        "name": "sound-program"
      },
      {
        "name": "output-program",
        "uniforms": [
          {
            "type": "FLOAT",
            "value": "if(!window.startTime) {\n window.startTime = new Date().getTime()\n window.lastTime = 0.;\n}\n\nconst time = (new Date().getTime()-window.startTime)/1E3\nwindow.deltaTime = time-window.lastTime;\nwindow.lastTime = time;\nreturn time;",
            "Type": {
              "UNSET": "",
              "FLOAT": "FLOAT",
              "INT": "INT",
              "BOOL": "BOOL",
              "VEC_TWO": "VEC_TWO",
              "VEC_THREE": "VEC_THREE",
              "VEC_FOUR": "VEC_FOUR",
              "IVEC_TWO": "IVEC_TWO",
              "IVEC_THREE": "IVEC_THREE",
              "IVEC_FOUR": "IVEC_FOUR",
              "BVEC_TWO": "BVEC_TWO",
              "BVEC_THREE": "BVEC_THREE",
              "BVEC_FOUR": "BVEC_FOUR",
              "MAT_TWO": "MAT_TWO",
              "MAT_THREE": "MAT_THREE",
              "MAT_FOUR": "MAT_FOUR",
              "SAMPLER_TWO_D": "SAMPLER_TWO_D",
              "SAMPLERCUBE": "SAMPLERCUBE"
            },
            "name": "time"
          },
          {
            "type": "FLOAT",
            "value": "return window.deltaTime;",
            "Type": {
              "UNSET": "",
              "FLOAT": "FLOAT",
              "INT": "INT",
              "BOOL": "BOOL",
              "VEC_TWO": "VEC_TWO",
              "VEC_THREE": "VEC_THREE",
              "VEC_FOUR": "VEC_FOUR",
              "IVEC_TWO": "IVEC_TWO",
              "IVEC_THREE": "IVEC_THREE",
              "IVEC_FOUR": "IVEC_FOUR",
              "BVEC_TWO": "BVEC_TWO",
              "BVEC_THREE": "BVEC_THREE",
              "BVEC_FOUR": "BVEC_FOUR",
              "MAT_TWO": "MAT_TWO",
              "MAT_THREE": "MAT_THREE",
              "MAT_FOUR": "MAT_FOUR",
              "SAMPLER_TWO_D": "SAMPLER_TWO_D",
              "SAMPLERCUBE": "SAMPLERCUBE"
            },
            "name": "delta_time"
          },
          {
            "type": "FLOAT",
            "name": "width",
            "value": "return pipeline.getContext('output-context').canvas.width;"
          },
          {
            "type": "FLOAT",
            "name": "height",
            "value": "return pipeline.getContext('output-context').canvas.height;"
          },
          {
            "type": "FLOAT",
            "name": "volume",
            "value": "return !window.time_array ? 0. : window.time_array.reduce((a,v)=>Math.max(Math.abs(v-128.)/128., a), 0);"
          },
          {
            "type": "SAMPLER_TWO_D",
            "name": "sound",
            "value": "const gl = pipeline.getContext('output-context').gl;\nconst image = pipeline.getContext('sound-context').canvas\nif(!window.sound_texture) window.sound_texture = gl.createTexture();\ngl.activeTexture(gl.TEXTURE0);\ngl.bindTexture(gl.TEXTURE_2D, window.sound_texture);\n// Tell WebGL we want to affect texture unit 0\n\n\n// Because images have to be downloaded over the internet\n// they might take a moment until they are ready.\n// Until then put a single pixel in the texture so we can\n// use it immediately. When the image has finished downloading\n// we'll update the texture with the contents of the image.\nconst level = 0;\nconst internalFormat = gl.RGBA;\nconst width = 1;\nconst height = 1;\nconst border = 0;\nconst srcFormat = gl.RGBA;\nconst srcType = gl.UNSIGNED_BYTE;\n\nif(image) gl.texImage2D(gl.TEXTURE_2D, level, internalFormat,\n              srcFormat, srcType, image);\n\n\n   // No, it's not a power of 2. Turn off mips and set\n   // wrapping to clamp to edge\n   gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n   gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n   gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\nreturn 0\n   gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\nreturn 0"
          },
          {
            "type": "SAMPLER_TWO_D",
            "name": "buffer",
            "value": "const gl = pipeline.getContext('output-context').gl;\nconst image = pipeline.getContext('output-context').canvas;\nif(! window.buffer_texture) window.buffer_texture = gl.createTexture();\ngl.activeTexture(gl.TEXTURE2);\ngl.bindTexture(gl.TEXTURE_2D, window.buffer_texture);\n// Tell WebGL we want to affect texture unit 0\n\n\n// Because images have to be downloaded over the internet\n// they might take a moment until they are ready.\n// Until then put a single pixel in the texture so we can\n// use it immediately. When the image has finished downloading\n// we'll update the texture with the contents of the image.\nconst level = 0;\nconst internalFormat = gl.RGBA;\nconst width = 1;\nconst height = 1;\nconst border = 0;\nconst srcFormat = gl.RGBA;\nconst srcType = gl.UNSIGNED_BYTE;\n\nif(image) gl.texImage2D(gl.TEXTURE_2D, level, internalFormat,\n              srcFormat, srcType, image);\n\n\n   // No, it's not a power of 2. Turn off mips and set\n   // wrapping to clamp to edge\n   gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n   gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n   gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\nreturn 2"
          }
        ],
        "fragment": "#extension GL_OES_standard_derivatives : enable\nprecision highp float;\nprecision highp int;\n\n#define UNIFORM_INSERTION_POINT\n\n#define PI 3.14159265359\n#define E 2.7182818284\n#define GR 1.61803398875\n#define MAX_DIM (max(width,height))\n\n#define MATRIX_W (floor(MAX_DIM/75.0))\n#define MATRIX_H (floor(MAX_DIM/75.0))\n#define saw(x) fract( sign( 1.- mod( abs(x), 2.) ) * abs(x) )\n#define flux(x) (vec3(cos(x),cos(4.0*PI/3.0+x),cos(2.0*PI/3.0+x))*.5+.5)\n\nvarying vec2 vPosition;\n#define iResolution (vec2(width,height))\n#define timeScale (time/3.)\n#define fireMovement \t\tvec2(-0.02, -0.5)\n#define distortionMovement\tvec2(-0.2, -0.3)\n#define normalStrength\t\t30.0\n#define distortionStrength\t0.25\n\n\nfloat drop = 0.;\n\n\nvec3 mod289(vec3 x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec2 mod289(vec2 x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec3 permute(vec3 x) {\n    return mod289(((x*34.0)+1.0)*x);\n}\n\nfloat snoise(vec2 v)\n{\n    const vec4 C = vec4(0.211324865405187, // (3.0-sqrt(3.0))/6.0\n                        0.366025403784439, // 0.5*(sqrt(3.0)-1.0)\n                        -0.577350269189626, // -1.0 + 2.0 * C.x\n                        0.024390243902439); // 1.0 / 41.0\n    // First corner\n    vec2 i = floor(v + dot(v, C.yy) );\n    vec2 x0 = v - i + dot(i, C.xx);\n\n    // Other corners\n    vec2 i1;\n    //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0\n    //i1.y = 1.0 - i1.x;\n    i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n    // x0 = x0 - 0.0 + 0.0 * C.xx ;\n    // x1 = x0 - i1 + 1.0 * C.xx ;\n    // x2 = x0 - 1.0 + 2.0 * C.xx ;\n    vec4 x12 = x0.xyxy + C.xxzz;\n    x12.xy -= i1;\n\n    // Permutations\n    i = mod289(i); // Avoid truncation effects in permutation\n    vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))\n                     + i.x + vec3(0.0, i1.x, 1.0 ));\n\n    vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n    m = m*m ;\n    m = m*m ;\n\n    // Gradients: 41 points uniformly over a line, mapped onto a diamond.\n    // The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)\n\n    vec3 x = 2.0 * fract(p * C.www) - 1.0;\n    vec3 h = abs(x) - 0.5;\n    vec3 ox = floor(x + 0.5);\n    vec3 a0 = x - ox;\n\n    // Normalise gradients implicitly by scaling m\n    // Approximation of: m *= inversesqrt( a0*a0 + h*h );\n    m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n\n    // Compute final noise value at P\n    vec3 g;\n    g.x = a0.x * x0.x + h.x * x0.y;\n    g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n    return 130.0 * dot(m, g);\n}\n\nvec4 mod289(vec4 x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n    return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise(vec3 v)\n{\n    const vec2 C = vec2(1.0/6.0, 1.0/3.0) ;\n    const vec4 D = vec4(0.0, 0.5, 1.0, 2.0);\n\n    // First corner\n    vec3 i = floor(v + dot(v, C.yyy) );\n    vec3 x0 = v - i + dot(i, C.xxx) ;\n\n    // Other corners\n    vec3 g = step(x0.yzx, x0.xyz);\n    vec3 l = 1.0 - g;\n    vec3 i1 = min( g.xyz, l.zxy );\n    vec3 i2 = max( g.xyz, l.zxy );\n\n    // x0 = x0 - 0.0 + 0.0 * C.xxx;\n    // x1 = x0 - i1 + 1.0 * C.xxx;\n    // x2 = x0 - i2 + 2.0 * C.xxx;\n    // x3 = x0 - 1.0 + 3.0 * C.xxx;\n    vec3 x1 = x0 - i1 + C.xxx;\n    vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n    vec3 x3 = x0 - D.yyy; // -1.0+3.0*C.x = -0.5 = -D.y\n\n    // Permutations\n    i = mod289(i);\n    vec4 p = permute( permute( permute(\n        i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n                              + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n                     + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n    // Gradients: 7x7 points over a square, mapped onto an octahedron.\n    // The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n    float n_ = 0.142857142857; // 1.0/7.0\n    vec3 ns = n_ * D.wyz - D.xzx;\n\n    vec4 j = p - 49.0 * floor(p * ns.z * ns.z); // mod(p,7*7)\n\n    vec4 x_ = floor(j * ns.z);\n    vec4 y_ = floor(j - 7.0 * x_ ); // mod(j,N)\n\n    vec4 x = x_ *ns.x + ns.yyyy;\n    vec4 y = y_ *ns.x + ns.yyyy;\n    vec4 h = 1.0 - abs(x) - abs(y);\n\n    vec4 b0 = vec4( x.xy, y.xy );\n    vec4 b1 = vec4( x.zw, y.zw );\n\n    //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n    //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n    vec4 s0 = floor(b0)*2.0 + 1.0;\n    vec4 s1 = floor(b1)*2.0 + 1.0;\n    vec4 sh = -step(h, vec4(0.0));\n\n    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n    vec3 p0 = vec3(a0.xy,h.x);\n    vec3 p1 = vec3(a0.zw,h.y);\n    vec3 p2 = vec3(a1.xy,h.z);\n    vec3 p3 = vec3(a1.zw,h.w);\n\n    //Normalise gradients\n    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n    p0 *= norm.x;\n    p1 *= norm.y;\n    p2 *= norm.z;\n    p3 *= norm.w;\n\n    // Mix final noise value\n    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n    m = m * m;\n    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                 dot(p2,x2), dot(p3,x3) ) );\n}\n\nfloat fbm ( in vec2 p ) {\n    float f = 0.0;\n    mat2 m = mat2( 1.6,  1.2, -1.2,  1.6 );\n    vec3 p2 = vec3(p, timeScale*2.);\n    f  = 0.5000*snoise(p2); p2.xy = m*p2.xy;\n    f += 0.2500*snoise(p2); p2.xy = m*p2.xy;\n    f += 0.1250*snoise(p2); p2.xy = m*p2.xy;\n    f += 0.0625*snoise(p2); p2.xy = m*p2.xy;\n    f = 0.5 + 0.5 * f;\n    return f;\n}\n\nconst float kCharBlank = 12.0;\nconst float kCharMinus = 11.0;\nconst float kCharDecimalPoint = 10.0;\nfloat SampleDigit(const in float fDigit, const in vec2 vUV)\n{\t\t\n\tif(vUV.x < 0.0) return 0.0;\n\tif(vUV.y < 0.0) return 0.0;\n\tif(vUV.x >= 1.0) return 0.0;\n\tif(vUV.y >= 1.0) return 0.0;\n\t\n\t// In this version, each digit is made up of a 4x5 array of bits\n\t\n\tfloat fDigitBinary = 0.0;\n\t\n\tif(fDigit < 0.5) // 0\n\t{\n\t\tfDigitBinary = 7.0 + 5.0 * 16.0 + 5.0 * 256.0 + 5.0 * 4096.0 + 7.0 * 65536.0;\n\t}\n\telse if(fDigit < 1.5) // 1\n\t{\n\t\tfDigitBinary = 2.0 + 2.0 * 16.0 + 2.0 * 256.0 + 2.0 * 4096.0 + 2.0 * 65536.0;\n\t}\n\telse if(fDigit < 2.5) // 2\n\t{\n\t\tfDigitBinary = 7.0 + 1.0 * 16.0 + 7.0 * 256.0 + 4.0 * 4096.0 + 7.0 * 65536.0;\n\t}\n\telse if(fDigit < 3.5) // 3\n\t{\n\t\tfDigitBinary = 7.0 + 4.0 * 16.0 + 7.0 * 256.0 + 4.0 * 4096.0 + 7.0 * 65536.0;\n\t}\n\telse if(fDigit < 4.5) // 4\n\t{\n\t\tfDigitBinary = 4.0 + 7.0 * 16.0 + 5.0 * 256.0 + 1.0 * 4096.0 + 1.0 * 65536.0;\n\t}\n\telse if(fDigit < 5.5) // 5\n\t{\n\t\tfDigitBinary = 7.0 + 4.0 * 16.0 + 7.0 * 256.0 + 1.0 * 4096.0 + 7.0 * 65536.0;\n\t}\n\telse if(fDigit < 6.5) // 6\n\t{\n\t\tfDigitBinary = 7.0 + 5.0 * 16.0 + 7.0 * 256.0 + 1.0 * 4096.0 + 7.0 * 65536.0;\n\t}\n\telse if(fDigit < 7.5) // 7\n\t{\n\t\tfDigitBinary = 4.0 + 4.0 * 16.0 + 4.0 * 256.0 + 4.0 * 4096.0 + 7.0 * 65536.0;\n\t}\n\telse if(fDigit < 8.5) // 8\n\t{\n\t\tfDigitBinary = 7.0 + 5.0 * 16.0 + 7.0 * 256.0 + 5.0 * 4096.0 + 7.0 * 65536.0;\n\t}\n\telse if(fDigit < 9.5) // 9\n\t{\n\t\tfDigitBinary = 7.0 + 4.0 * 16.0 + 7.0 * 256.0 + 5.0 * 4096.0 + 7.0 * 65536.0;\n\t}\n\telse if(fDigit < 10.5) // '.'\n\t{\n\t\tfDigitBinary = 2.0 + 0.0 * 16.0 + 0.0 * 256.0 + 0.0 * 4096.0 + 0.0 * 65536.0;\n\t}\n\telse if(fDigit < 11.5) // '-'\n\t{\n\t\tfDigitBinary = 0.0 + 0.0 * 16.0 + 7.0 * 256.0 + 0.0 * 4096.0 + 0.0 * 65536.0;\n\t}\n\t\n\tvec2 vPixel = floor(vUV * vec2(4.0, 5.0));\n\tfloat fIndex = vPixel.x + (vPixel.y * 4.0);\n\t\n\treturn mod(floor(fDigitBinary / pow(2.0, fIndex)), 2.0);\n}\n\nvec3 bumpMap(vec2 uv) { \n    vec2 s = 1. / iResolution.xy;\n    float p =  fbm(uv);\n    float h1 = fbm(uv + s * vec2(1., 0));\n    float v1 = fbm(uv + s * vec2(0, 1.));\n       \n   \tvec2 xy = (p - vec2(h1, v1)) * normalStrength;\n    return vec3(xy + .5, 1.);\n}\n\nfloat getEyes(vec2 uv)\n{\n    vec2 p = uv;\n\n    p.y += 1.0/PI;\n\n    p.x *= GR;\n\n    vec4 a = vec4(-1.0, 1.0, 0, 0)/1.1;\n    vec4 b = vec4(1.0, 1.0, 0, 0)/1.1;\n\n    p.y += -cos(uv.x*(8.0))/PI/E;\n\n    float distA = length(p.xy-a.xy);\n    float distB = length(p.xy-b.xy);\n\n    float fade_lengthA = 1./4.;\n    float fade_lengthB = 1./4.;\n\n    float color = clamp((1.0-distA/fade_lengthA)*distB, 0.0, 1.0)\n        \t\t  +clamp((1.0-distB/fade_lengthB)*distA, 0.0, 1.0);\n    return color;\n}\n\nfloat getTeeth(vec2 uv)\n{\n    vec2 p = uv;\n    p.x *= 2.;\n    p.y *= E*(cos(p.x/E));\n    p.y += GR*cos(p.x);\n    p.y *= GR+sin(time*PI*2.)/E;\n\n    float r = p.x*p.x+p.y*p.y;\n    \n    float xy = cos(p.x*PI*8.+PI)+cos(p.y*3.0+PI);\n\n    return clamp(clamp((GR/(r*r*r*r)-p.y*p.y*GR), 0.0, 1.0)*xy, 0.0, 1.0);\n}\n\nfloat demon(vec2 uv)\n{\n    float eyes = getEyes(uv);\n    float teeth = getTeeth(uv);\n    \n    return pow(clamp(eyes+teeth, 0.0, 1.0), 1./4.);\n}\n\nfloat square(vec2 uv)\n{\n    vec2 uv0 = uv*2.-1.;//rotatePoint(vec3(uv*2.-1., 0.),vec3(0.,0.,1.), time*PI).xy*.5+.5;;\n\n//u = x ( 1 -  y )\n//v = y ( 1 -  x )\n    /*uv = vec2(uv0.x*sqrt(1.-.5*uv0.y*uv0.y),\n          uv0.y*sqrt(1.-.5*uv0.x*uv0.x))*.5+.5;*/\n\n    vec4 s = texture2D(sound, vec2(uv.x, .5));\n    vec2 xy = vec2(uv.x, s.g);\n    return 1.-smoothstep(0., .05, length(xy-uv));\n}\nvoid main()\n{\n    drop = smoothstep(0., 1./3., volume);\n    vec2 uv0 = vec2(vPosition.x, 1.-vPosition.y);\n    vec2 uv = uv0*2.-1.;\n    uv.x *= max(iResolution.x/iResolution.y, 1.);\n    uv.y *= max(iResolution.y/iResolution.x, 1.);\n    vec4 final = vec4(sin(vec3(time*PI*E*GR*2.+uv0.x*PI,\ntime*PI*E*GR*2.+uv0.x*PI,\ntime*PI*E*GR*2.+uv0.x*PI))*.5+\n.5*flux(time*PI*E*GR*2.+uv0.x*PI), 1.0)*square(uv0)*drop;\n    vec4 b = texture2D(buffer,uv0).rgba;\n        gl_FragColor = clamp((final+b-delta_time), vec4(0.), vec4(1.));\n}",
        "vertex": "precision highp float;\nprecision highp int;\n\n#define UNIFORM_INSERTION_POINT\n\nattribute highp vec4 vertex; \n\nvarying vec2 vPosition;\nvoid main(void) {\n    gl_PointSize = 2.;\n    vPosition = vertex.xy;\n    gl_Position = vec4(vertex.xy*2.-1., 0., 1.);\n}\n"
      }
    ],
    "stages": [
      {
        "type": "MESH_POINTS",
        "context": "sound-context",
        "program": "sound-program",
        "vertices": "if(!window.freq_array ) return [[]];\n\nreturn [window.freq_array ? [...window.freq_array].map((v, i)=> {return [i*1./window.fft_size*4.-1., 0.5,v, window.time_array[i]/256.]}).flat(): []]",
        "indices": "if(!window.freq_array ) return [[]];\nconst indices = window.freq_array ? [...window.freq_array].map((v, i)=>i) : []\nreturn indices;",
        "Type": {
          "UNSET": "",
          "SHADER": "SHADER",
          "MESH_POINTS": "MESH_POINTS",
          "MESH_LINES": "MESH_LINES",
          "MESH_LINE_STRIP": "MESH_LINE_STRIP",
          "MESH_LINE_LOOP": "MESH_LINE_LOOP",
          "MESH_TRIANGLES": "MESH_TRIANGLES",
          "MESH_TRIANGLE_FAN": "MESH_TRIANGLE_FAN",
          "MESH_TRIANGLE_STRIP": "MESH_TRIANGLE_STRIP"
        },
        "name": "sound-stage"
      },
      {
        "Type": {
          "UNSET": "",
          "SHADER": "SHADER",
          "MESH_POINTS": "MESH_POINTS",
          "MESH_LINES": "MESH_LINES",
          "MESH_LINE_STRIP": "MESH_LINE_STRIP",
          "MESH_LINE_LOOP": "MESH_LINE_LOOP",
          "MESH_TRIANGLES": "MESH_TRIANGLES",
          "MESH_TRIANGLE_FAN": "MESH_TRIANGLE_FAN",
          "MESH_TRIANGLE_STRIP": "MESH_TRIANGLE_STRIP"
        },
        "name": "output-stage",
        "context": "output-context",
        "program": "output-program",
        "type": "SHADER"
      }
    ]
  },
  "created": "Tue Feb 01 2022 20:12:19 GMT+0000 (Coordinated Universal Time)",
  "views": 19,
  "featured": false,
  "author": "::ffff:73.48.92.54"
}